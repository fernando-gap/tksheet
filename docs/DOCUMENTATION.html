
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        body {
            margin: 0;
            height: 100vh; /* Full viewport height */
            font-family: Arial, sans-serif; /* Consistent font */
        }

        .side-panel {
            position: fixed; /* Fixed position to follow scroll */
            left: 0;
            top: 0;
            width: 20%; /* 20% of total width when visible */
            height: 100%; /* Full height of viewport */
            overflow-y: auto; /* Scrollbar for side panel if content overflows */
            padding: 10px;
            box-sizing: border-box;
            background-color: #fff; /* Light theme background */
            border-right: 1px solid #ccc; /* Slim border */
            font-size: 18px; /* Base font size */
            scrollbar-color: #ccc #fff; /* Firefox: Light theme scrollbar */
            display: none; /* Hidden by default */
        }

        #toggle-toc:checked ~ .side-panel {
            display: block; /* Show side panel when checkbox is checked */
        }

        /* Increase font size on mobile screens */
        @media (max-width: 768px) {
            .side-panel {
                font-size: 20px; /* Larger for mobile */
            }
        }

        /* Style for TOC links and list items in the side panel */
        .side-panel a {
            line-height: 1.5; /* Better spacing */
        }

        .side-panel li {
            margin-bottom: 8px; /* Space below list items */
        }

        /* WebKit/Blink scrollbar styles for side panel (light theme) */
        .side-panel::-webkit-scrollbar-track {
            background: #fff;
        }

        .side-panel::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 4px;
        }

        .main-content {
            margin-left: 0; /* Default when side panel is hidden */
            height: 100vh; /* Full viewport height */
            display: flex;
            flex-direction: column;
            background-color: #fff; /* Light theme background */
        }

        #toggle-toc:checked ~ .main-content {
            margin-left: 20%; /* Shift right when side panel is visible */
        }

        .buttons-container {
            position: fixed;
            top: 10px;
            left: 10px; /* Default position */
            display: flex;
            gap: 10px; /* Space between buttons */
            z-index: 1; /* Above content */
        }

        #toggle-toc:checked ~ .main-content .buttons-container {
            left: calc(20% + 10px); /* Position right of side panel */
        }

        .toggle-button, .theme-button {
            background-color: #f0f0f0;
            padding: 5px 10px;
            cursor: pointer;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .content {
            flex: 1; /* Take remaining height */
            overflow-y: auto; /* Scrollbar for main content */
            padding: 20px;
            padding-top: 70px; /* Space for buttons */
            scrollbar-color: #ccc #fff; /* Firefox: Light theme scrollbar */
        }

        /* WebKit/Blink scrollbar styles for main content (light theme) */
        .content::-webkit-scrollbar-track {
            background: #fff;
        }

        .content::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 4px;
        }

        /* Table styles */
        table {
            border-collapse: collapse;
            width: 100%;
            border: 1px solid #ccc;
        }

        td, th {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }

        /* Dark theme styles */
        #toggle-theme:checked ~ .side-panel,
        #toggle-theme:checked ~ .main-content {
            background-color: #000;
            color: #ccc;
        }

        #toggle-theme:checked ~ .side-panel table,
        #toggle-theme:checked ~ .main-content table {
            border-color: #555;
        }

        #toggle-theme:checked ~ .side-panel td,
        #toggle-theme:checked ~ .side-panel th,
        #toggle-theme:checked ~ .main-content td,
        #toggle-theme:checked ~ .main-content th {
            border-color: #555;
        }

        #toggle-theme:checked ~ .side-panel {
            scrollbar-color: #888 #000;
        }

        #toggle-theme:checked ~ .side-panel::-webkit-scrollbar-track {
            background: #000;
        }

        #toggle-theme:checked ~ .side-panel::-webkit-scrollbar-thumb {
            background: #888;
        }

        #toggle-theme:checked ~ .main-content .content {
            scrollbar-color: #888 #000;
        }

        #toggle-theme:checked ~ .main-content .content::-webkit-scrollbar-track {
            background: #000;
        }

        #toggle-theme:checked ~ .main-content .content::-webkit-scrollbar-thumb {
            background: #888;
        }

        #toggle-theme:checked ~ .main-content .buttons-container .toggle-button,
        #toggle-theme:checked ~ .main-content .buttons-container .theme-button {
            background-color: #333;
            color: #fff;
        }

        #toggle-theme:checked ~ .side-panel a,
        #toggle-theme:checked ~ .main-content .content a {
            color: #90caf9;
        }
    </style>
</head>
<body>
    <input type="checkbox" id="toggle-toc" checked style="display: none;">
    <input type="checkbox" id="toggle-theme" checked style="display: none;">
    <div class="side-panel">
<div class="toc">
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#about-tksheet">About tksheet</a><ul>
<li><a href="#limitations">Limitations</a></li>
</ul>
</li>
<li><a href="#installation-and-requirements">Installation and Requirements</a></li>
<li><a href="#basic-initialization">Basic Initialization</a></li>
<li><a href="#usage-examples">Usage Examples</a></li>
<li><a href="#initialization-options">Initialization Options</a></li>
<li><a href="#sheet-appearance">Sheet Appearance</a><ul>
<li><a href="#sheet-colors">Sheet Colors</a><ul>
<li><a href="#set-options">Set options</a></li>
</ul>
</li>
<li><a href="#scrollbar-appearance">Scrollbar Appearance</a></li>
</ul>
</li>
<li><a href="#alternate-row-colors">Alternate Row Colors</a></li>
<li><a href="#header-and-index">Header and Index</a><ul>
<li><a href="#set-the-header">Set the header</a></li>
<li><a href="#set-the-index">Set the index</a></li>
</ul>
</li>
<li><a href="#text-wrap-and-overflow">Text Wrap and Overflow</a><ul>
<li><a href="#control-text-wrapping">Control text wrapping</a></li>
<li><a href="#control-table-text-overflow">Control table text overflow</a></li>
</ul>
</li>
<li><a href="#table-functionality-and-bindings">Table functionality and bindings</a><ul>
<li><a href="#enable-table-functionality-and-bindings">Enable table functionality and bindings</a></li>
<li><a href="#disable-table-functionality-and-bindings">Disable table functionality and bindings</a></li>
<li><a href="#bind-specific-table-functionality">Bind specific table functionality</a></li>
<li><a href="#event-data">Event Data</a></li>
<li><a href="#validate-user-cell-edits">Validate user cell edits</a></li>
<li><a href="#add-commands-to-the-in-built-right-click-popup-menu">Add commands to the in-built right click popup menu</a></li>
<li><a href="#remove-commands-added-using-popup_menu_add_command-from-the-in-built-right-click-popup-menu">Remove commands added using popup_menu_add_command from the in-built right click popup menu</a></li>
<li><a href="#enable-or-disable-mousewheel-left-click-etc">Enable or disable mousewheel, left click etc</a></li>
<li><a href="#get-the-last-event-data-dict">Get the last event data dict</a></li>
<li><a href="#set-focus-to-the-sheet">Set focus to the Sheet</a></li>
</ul>
</li>
<li><a href="#tkinter-and-tksheet-events">tkinter and tksheet Events</a><ul>
<li><a href="#sheet-bind">Sheet bind</a></li>
<li><a href="#sheet-unbind">Sheet unbind</a></li>
</ul>
</li>
<li><a href="#sheet-languages-and-bindings">Sheet Languages and Bindings</a><ul>
<li><a href="#changing-right-click-menu-labels">Changing right click menu labels</a></li>
<li><a href="#changing-key-bindings">Changing key bindings</a></li>
<li><a href="#key-bindings-for-other-languages">Key bindings for other languages</a></li>
</ul>
</li>
<li><a href="#span-objects">Span Objects</a><ul>
<li><a href="#creating-a-span">Creating a span</a><ul>
<li><a href="#span-creation-syntax">Span creation syntax</a></li>
<li><a href="#span-creation-examples-using-square-brackets">Span creation examples using square brackets</a></li>
<li><a href="#span-creation-examples-using-sheetspan">Span creation examples using sheet.span()</a></li>
</ul>
</li>
<li><a href="#span-properties">Span properties</a><ul>
<li><a href="#get-a-spans-kind">Get a spans kind</a></li>
<li><a href="#get-span-rows-and-columns">Get span rows and columns</a></li>
</ul>
</li>
<li><a href="#span-methods">Span methods</a><ul>
<li><a href="#modify-a-spans-attributes">Modify a spans attributes</a></li>
<li><a href="#using-a-span-to-format-data">Using a span to format data</a></li>
<li><a href="#using-a-span-to-delete-data-format-rules">Using a span to delete data format rules</a></li>
<li><a href="#using-a-span-to-create-highlights">Using a span to create highlights</a></li>
<li><a href="#using-a-span-to-delete-highlights">Using a span to delete highlights</a></li>
<li><a href="#using-a-span-to-create-dropdown-boxes">Using a span to create dropdown boxes</a></li>
<li><a href="#using-a-span-to-delete-dropdown-boxes">Using a span to delete dropdown boxes</a></li>
<li><a href="#using-a-span-to-create-check-boxes">Using a span to create check boxes</a></li>
<li><a href="#using-a-span-to-delete-check-boxes">Using a span to delete check boxes</a></li>
<li><a href="#using-a-span-to-set-cells-to-read-only">Using a span to set cells to read only</a></li>
<li><a href="#using-a-span-to-create-text-alignment-rules">Using a span to create text alignment rules</a></li>
<li><a href="#using-a-span-to-delete-text-alignment-rules">Using a span to delete text alignment rules</a></li>
<li><a href="#using-a-span-to-clear-cells">Using a span to clear cells</a></li>
<li><a href="#using-a-span-to-tag-cells">Using a span to tag cells</a></li>
<li><a href="#using-a-span-to-untag-cells">Using a span to untag cells</a></li>
<li><a href="#set-the-spans-orientation">Set the spans orientation</a></li>
<li><a href="#expand-the-spans-area">Expand the spans area</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#named-spans">Named Spans</a><ul>
<li><a href="#creating-a-named-span">Creating a named span</a></li>
<li><a href="#deleting-a-named-span">Deleting a named span</a></li>
<li><a href="#other-named-span-functions">Other named span functions</a></li>
</ul>
</li>
<li><a href="#getting-sheet-data">Getting Sheet Data</a><ul>
<li><a href="#using-a-span-to-get-sheet-data">Using a span to get sheet data</a></li>
<li><a href="#get-a-single-cells-data">Get a single cells data</a></li>
<li><a href="#generate-sheet-rows-one-at-a-time">Generate sheet rows one at a time</a></li>
<li><a href="#get-table-data-readonly">Get table data, readonly</a></li>
<li><a href="#the-name-of-the-actual-internal-sheet-data-variable">The name of the actual internal sheet data variable</a></li>
<li><a href="#sheet-methods">Sheet methods</a></li>
<li><a href="#get-the-number-of-rows-in-the-sheet">Get the number of rows in the sheet</a></li>
<li><a href="#get-the-number-of-columns-in-the-sheet">Get the number of columns in the sheet</a></li>
<li><a href="#get-a-value-for-a-particular-cell-if-that-cell-was-empty">Get a value for a particular cell if that cell was empty</a></li>
</ul>
</li>
<li><a href="#setting-sheet-data">Setting Sheet Data</a><ul>
<li><a href="#overwriting-the-table">Overwriting the table</a></li>
<li><a href="#reset-all-or-specific-sheet-elements-and-attributes">Reset all or specific sheet elements and attributes</a></li>
<li><a href="#modifying-sheet-data">Modifying sheet data</a></li>
<li><a href="#sheet-set-data-function">Sheet set data function</a></li>
<li><a href="#insert-a-row-into-the-sheet">Insert a row into the sheet</a></li>
<li><a href="#insert-a-column-into-the-sheet">Insert a column into the sheet</a></li>
<li><a href="#insert-multiple-columns-into-the-sheet">Insert multiple columns into the sheet</a></li>
<li><a href="#insert-multiple-rows-into-the-sheet">Insert multiple rows into the sheet</a></li>
<li><a href="#delete-a-row-from-the-sheet">Delete a row from the sheet</a></li>
<li><a href="#delete-multiple-rows-from-the-sheet">Delete multiple rows from the sheet</a></li>
<li><a href="#delete-a-column-from-the-sheet">Delete a column from the sheet</a></li>
<li><a href="#delete-multiple-columns-from-the-sheet">Delete multiple columns from the sheet</a></li>
<li><a href="#move-a-single-row-to-a-new-location">Move a single row to a new location</a></li>
<li><a href="#move-a-single-column-to-a-new-location">Move a single column to a new location</a></li>
<li><a href="#move-any-rows-to-a-new-location">Move any rows to a new location</a></li>
<li><a href="#move-any-columns-to-a-new-location">Move any columns to a new location</a></li>
<li><a href="#move-any-columns-to-new-locations">Move any columns to new locations</a></li>
<li><a href="#move-any-rows-to-new-locations">Move any rows to new locations</a></li>
<li><a href="#make-all-data-rows-the-same-length">Make all data rows the same length</a></li>
</ul>
</li>
<li><a href="#sorting-the-table">Sorting the Table</a><ul>
<li><a href="#natural_sort_key">natural_sort_key</a></li>
<li><a href="#version_sort_key">version_sort_key</a></li>
<li><a href="#fast_sort_key">fast_sort_key</a></li>
<li><a href="#setting-the-default-sorting-key">Setting the default sorting key</a></li>
<li><a href="#notes-about-sorting">Notes about sorting</a></li>
<li><a href="#sorting-cells">Sorting cells</a></li>
<li><a href="#sorting-row-values">Sorting row values</a></li>
<li><a href="#sorting-column-values">Sorting column values</a></li>
<li><a href="#sorting-the-order-of-all-rows-using-a-column">Sorting the order of all rows using a column</a></li>
<li><a href="#sorting-the-order-of-all-columns-using-a-row">Sorting the order of all columns using a row</a></li>
</ul>
</li>
<li><a href="#find-and-replace">Find and Replace</a><ul>
<li><a href="#check-if-the-find-window-is-open">Check if the find window is open</a></li>
<li><a href="#open-or-close-the-find-window">Open or close the find window</a></li>
<li><a href="#find-and-select">Find and select</a></li>
<li><a href="#replace-all-using-mapping">Replace all using mapping</a></li>
</ul>
</li>
<li><a href="#highlighting-cells">Highlighting Cells</a><ul>
<li><a href="#creating-highlights">Creating highlights</a><ul>
<li><a href="#using-spans-to-create-highlights">Using spans to create highlights</a></li>
<li><a href="#other-ways-to-create-highlights">Other ways to create highlights</a></li>
</ul>
</li>
<li><a href="#deleting-highlights">Deleting highlights</a><ul>
<li><a href="#using-spans-to-delete-highlights">Using spans to delete highlights</a></li>
<li><a href="#other-ways-to-delete-highlights">Other ways to delete highlights</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#dropdown-boxes">Dropdown Boxes</a><ul>
<li><a href="#creating-dropdown-boxes">Creating dropdown boxes</a></li>
<li><a href="#deleting-dropdown-boxes">Deleting dropdown boxes</a></li>
<li><a href="#get-chosen-dropdown-boxes-values">Get chosen dropdown boxes values</a></li>
<li><a href="#set-the-values-and-cell-value-of-a-chosen-dropdown-box">Set the values and cell value of a chosen dropdown box</a></li>
<li><a href="#set-or-get-bound-dropdown-functions">Set or get bound dropdown functions</a></li>
<li><a href="#get-a-dictionary-of-all-dropdown-boxes">Get a dictionary of all dropdown boxes</a></li>
<li><a href="#open-a-dropdown-box">Open a dropdown box</a></li>
<li><a href="#close-a-dropdown-box">Close a dropdown box</a></li>
</ul>
</li>
<li><a href="#check-boxes">Check Boxes</a><ul>
<li><a href="#creating-check-boxes">Creating check boxes</a></li>
<li><a href="#deleting-check-boxes">Deleting check boxes</a></li>
<li><a href="#set-or-toggle-a-check-box">Set or toggle a check box</a></li>
<li><a href="#get-a-dictionary-of-all-check-box-dictionaries">Get a dictionary of all check box dictionaries</a></li>
</ul>
</li>
<li><a href="#data-formatting">Data Formatting</a><ul>
<li><a href="#creation-and-deletion-of-data-formatting-rules">Creation and deletion of data formatting rules</a><ul>
<li><a href="#creating-a-data-format-rule">Creating a data format rule</a></li>
<li><a href="#deleting-a-data-format-rule">Deleting a data format rule</a></li>
<li><a href="#delete-all-formatting">Delete all formatting</a></li>
<li><a href="#reapply-formatting-to-entire-sheet">Reapply formatting to entire sheet</a></li>
<li><a href="#check-if-a-cell-is-formatted">Check if a cell is formatted</a></li>
</ul>
</li>
<li><a href="#formatters">Formatters</a><ul>
<li><a href="#int-formatter">Int Formatter</a></li>
<li><a href="#float-formatter">Float Formatter</a></li>
<li><a href="#percentage-formatter">Percentage Formatter</a></li>
<li><a href="#bool-formatter">Bool Formatter</a></li>
<li><a href="#generic-formatter">Generic Formatter</a></li>
</ul>
</li>
<li><a href="#datetime-formatters-and-designing-your-own-custom-formatters">Datetime Formatters and Designing Your Own Custom Formatters</a></li>
</ul>
</li>
<li><a href="#readonly-cells">Readonly Cells</a><ul>
<li><a href="#creating-a-readonly-rule">Creating a readonly rule</a></li>
<li><a href="#deleting-a-readonly-rule">Deleting a readonly rule</a></li>
</ul>
</li>
<li><a href="#text-font-and-alignment">Text Font and Alignment</a><ul>
<li><a href="#font">Font</a></li>
<li><a href="#text-alignment">Text Alignment</a><ul>
<li><a href="#whole-widget-text-alignment">Whole widget text alignment</a></li>
<li><a href="#creating-a-specific-cell-row-or-column-text-alignment-rule">Creating a specific cell row or column text alignment rule</a></li>
<li><a href="#deleting-a-specific-text-alignment-rule">Deleting a specific text alignment rule</a></li>
<li><a href="#get-existing-specific-text-alignments">Get existing specific text alignments</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#getting-cell-properties">Getting Cell Properties</a><ul>
<li><a href="#get-table-cell-properties">Get table cell properties</a></li>
<li><a href="#get-index-cell-properties">Get index cell properties</a></li>
<li><a href="#get-header-cell-properties">Get header cell properties</a></li>
</ul>
</li>
<li><a href="#getting-selected-cells">Getting Selected Cells</a><ul>
<li><a href="#get-the-currently-selected-cell">Get the currently selected cell</a></li>
<li><a href="#get-selected-rows">Get selected rows</a></li>
<li><a href="#get-selected-columns">Get selected columns</a></li>
<li><a href="#get-selected-cells">Get selected cells</a></li>
<li><a href="#generate-selected-cells">Generate selected cells</a></li>
<li><a href="#get-all-selection-boxes">Get all selection boxes</a></li>
<li><a href="#get-all-selection-boxes-and-their-types">Get all selection boxes and their types</a></li>
<li><a href="#check-if-cell-is-selected">Check if cell is selected</a></li>
<li><a href="#check-if-row-is-selected">Check if row is selected</a></li>
<li><a href="#check-if-column-is-selected">Check if column is selected</a></li>
<li><a href="#check-if-any-cells-rows-or-columns-are-selected-there-are-options-for-exclusions">Check if any cells, rows or columns are selected, there are options for exclusions</a></li>
<li><a href="#check-if-user-has-the-entire-table-selected">Check if user has the entire table selected</a></li>
</ul>
</li>
<li><a href="#modifying-selected-cells">Modifying Selected Cells</a></li>
<li><a href="#row-heights-and-column-widths">Row Heights and Column Widths</a><ul>
<li><a href="#auto-resize-column-widths-to-fit-the-window">Auto resize column widths to fit the window</a></li>
<li><a href="#auto-resize-row-heights-to-fit-the-window">Auto resize row heights to fit the window</a></li>
<li><a href="#set-default-column-width-in-pixels">Set default column width in pixels</a></li>
<li><a href="#set-default-row-height-in-pixels-or-lines">Set default row height in pixels or lines</a></li>
<li><a href="#set-default-header-bar-height-in-pixels-or-lines">Set default header bar height in pixels or lines</a></li>
<li><a href="#set-a-specific-cell-size-to-its-text">Set a specific cell size to its text</a></li>
<li><a href="#set-all-row-heights-and-column-widths-to-cell-text-sizes">Set all row heights and column widths to cell text sizes</a></li>
<li><a href="#set-all-column-widths-to-a-specific-width-in-pixels">Set all column widths to a specific width in pixels</a></li>
<li><a href="#set-all-row-heights-to-a-specific-height-in-pixels">Set all row heights to a specific height in pixels</a></li>
<li><a href="#set-or-get-a-specific-column-width">Set or get a specific column width</a></li>
<li><a href="#set-or-get-a-specific-row-height">Set or get a specific row height</a></li>
<li><a href="#get-the-sheets-column-widths">Get the sheets column widths</a></li>
<li><a href="#get-the-sheets-row-heights">Get the sheets row heights</a></li>
<li><a href="#get-a-rows-text-height">Get a rows text height</a></li>
<li><a href="#get-a-columns-text-width">Get a columns text width</a></li>
<li><a href="#set-or-reset-displayed-column-widthslines">Set or reset displayed column widths/lines</a></li>
<li><a href="#set-or-reset-displayed-row-heightslines">Set or reset displayed row heights/lines</a></li>
<li><a href="#set-the-width-of-the-index-to-a-str-or-existing-values">Set the width of the index to a str or existing values</a></li>
<li><a href="#set-the-width-of-the-index-to-a-value-in-pixels">Set the width of the index to a value in pixels</a></li>
<li><a href="#set-the-height-of-the-header-to-a-str-or-existing-values">Set the height of the header to a str or existing values</a></li>
<li><a href="#set-the-height-of-the-header-to-a-value-in-pixels">Set the height of the header to a value in pixels</a></li>
<li><a href="#set-the-height-of-the-header-to-accomodate-a-number-of-lines">Set the height of the header to accomodate a number of lines</a></li>
<li><a href="#delete-displayed-column-lines">Delete displayed column lines</a></li>
<li><a href="#delete-displayed-row-lines">Delete displayed row lines</a></li>
<li><a href="#insert-a-displayed-row-line">Insert a displayed row line</a></li>
<li><a href="#insert-a-displayed-column-line">Insert a displayed column line</a></li>
<li><a href="#insert-multiple-displayed-row-lines">Insert multiple displayed row lines</a></li>
<li><a href="#insert-multiple-displayed-column-lines">Insert multiple displayed column lines</a></li>
<li><a href="#set-the-number-of-displayed-row-lines-and-column-lines">Set the number of displayed row lines and column lines</a></li>
<li><a href="#move-a-displayed-row-line">Move a displayed row line</a></li>
<li><a href="#move-a-displayed-column-line">Move a displayed column line</a></li>
<li><a href="#get-a-list-of-default-column-width-values">Get a list of default column width values</a></li>
<li><a href="#get-a-list-of-default-row-height-values">Get a list of default row height values</a></li>
<li><a href="#verify-a-list-of-row-heights-or-canvas-y-coordinates">Verify a list of row heights or canvas y coordinates</a></li>
<li><a href="#verify-a-list-of-column-widths-or-canvas-x-coordinates">Verify a list of column widths or canvas x coordinates</a></li>
<li><a href="#make-a-row-height-valid">Make a row height valid</a></li>
<li><a href="#make-a-column-width-valid">Make a column width valid</a></li>
<li><a href="#get-visible-rows">Get visible rows</a></li>
<li><a href="#get-visible-columns">Get visible columns</a></li>
</ul>
</li>
<li><a href="#identifying-bound-event-mouse-position">Identifying Bound Event Mouse Position</a><ul>
<li><a href="#sheet-control-actions">Sheet control actions</a></li>
</ul>
</li>
<li><a href="#scroll-positions-and-cell-visibility">Scroll Positions and Cell Visibility</a><ul>
<li><a href="#sync-scroll-positions-between-widgets">Sync scroll positions between widgets</a></li>
<li><a href="#unsync-scroll-positions-between-widgets">Unsync scroll positions between widgets</a></li>
<li><a href="#see-or-scroll-to-a-specific-cell-on-the-sheet">See or scroll to a specific cell on the sheet</a></li>
<li><a href="#check-if-a-cell-has-any-part-of-it-visible">Check if a cell has any part of it visible</a></li>
<li><a href="#check-if-a-cell-is-totally-visible">Check if a cell is totally visible</a></li>
</ul>
</li>
<li><a href="#hiding-columns">Hiding Columns</a><ul>
<li><a href="#display-only-certain-columns">Display only certain columns</a></li>
<li><a href="#get-all-columns-displayed-boolean">Get all columns displayed boolean</a></li>
<li><a href="#hide-specific-columns">Hide specific columns</a></li>
<li><a href="#unhide-specific-columns">Unhide specific columns</a></li>
<li><a href="#displayed-column-index-to-data">Displayed column index to data</a></li>
<li><a href="#get-currently-displayed-columns">Get currently displayed columns</a></li>
</ul>
</li>
<li><a href="#hiding-rows">Hiding Rows</a><ul>
<li><a href="#display-only-certain-rows">Display only certain rows</a></li>
<li><a href="#hide-specific-rows">Hide specific rows</a></li>
<li><a href="#unhide-specific-rows">Unhide specific rows</a></li>
<li><a href="#get-or-set-the-all-rows-displayed-boolean">Get or set the all rows displayed boolean</a></li>
<li><a href="#displayed-row-index-to-data">Displayed row index to data</a></li>
<li><a href="#get-currently-displayed-rows">Get currently displayed rows</a></li>
</ul>
</li>
<li><a href="#hiding-sheet-elements">Hiding Sheet Elements</a><ul>
<li><a href="#hide-parts-of-the-sheet-or-all-of-it">Hide parts of the Sheet or all of it</a></li>
<li><a href="#show-parts-of-the-sheet-or-all-of-it">Show parts of the Sheet or all of it</a></li>
</ul>
</li>
<li><a href="#sheet-height-and-width">Sheet Height and Width</a><ul>
<li><a href="#modify-widget-height-and-width-in-pixels">Modify widget height and width in pixels</a></li>
</ul>
</li>
<li><a href="#cell-text-editor">Cell Text Editor</a><ul>
<li><a href="#open-the-currently-selected-cell-in-the-main-table">Open the currently selected cell in the main table</a></li>
<li><a href="#open-the-currently-selected-cell-but-in-the-header">Open the currently selected cell but in the header</a></li>
<li><a href="#open-the-currently-selected-cell-but-in-the-index">Open the currently selected cell but in the index</a></li>
<li><a href="#set-the-cell-text-editor-value-if-it-is-open">Set the cell text editor value if it is open</a></li>
<li><a href="#close-any-existing-text-editor">Close any existing text editor</a></li>
<li><a href="#get-an-existing-text-editors-value">Get an existing text editors value</a></li>
<li><a href="#hide-all-text-editors">Hide all text editors</a></li>
<li><a href="#get-the-table-tk-text-widget-which-acts-as-the-text-editor">Get the table tk Text widget which acts as the text editor</a></li>
<li><a href="#bind-additional-keys-to-the-text-editor-window">Bind additional keys to the text editor window</a></li>
<li><a href="#unbind-additional-text-editors-bindings-set-using-the-above-function">Unbind additional text editors bindings set using the above function</a></li>
</ul>
</li>
<li><a href="#sheet-options-and-other-functions">Sheet Options and Other Functions</a></li>
<li><a href="#treeview-mode">Treeview Mode</a><ul>
<li><a href="#to-note">TO NOTE:</a></li>
<li><a href="#creating-a-treeview-mode-sheet">Creating a treeview mode sheet</a></li>
<li><a href="#treeview-mode-functions">Treeview mode functions</a><ul>
<li><a href="#insert-an-item">Insert an item</a></li>
<li><a href="#insert-multiple-items">Insert multiple items</a></li>
<li><a href="#build-a-tree-from-data">Build a tree from data</a></li>
<li><a href="#reset-the-treeview">Reset the treeview</a></li>
<li><a href="#get-treeview-iids-that-are-open">Get treeview iids that are open</a></li>
<li><a href="#set-the-open-treeview-iids">Set the open treeview iids</a></li>
<li><a href="#open-treeview-iids">Open treeview iids</a></li>
<li><a href="#close-treeview-iids">Close treeview iids</a></li>
<li><a href="#set-or-get-an-iids-attributes">Set or get an iids attributes</a></li>
<li><a href="#get-an-iids-row-number">Get an iids row number</a></li>
<li><a href="#get-a-row-numbers-item">Get a row numbers item</a></li>
<li><a href="#get-treeview-children">Get treeview children</a></li>
<li><a href="#get-item-descendants">Get item descendants</a></li>
<li><a href="#get-the-currently-selected-treeview-item">Get the currently selected treeview item</a></li>
<li><a href="#delete-treeview-items">Delete treeview items</a></li>
<li><a href="#move-items-to-a-new-parent">Move items to a new parent</a></li>
<li><a href="#move-an-item-to-a-new-parent">Move an item to a new parent</a></li>
<li><a href="#check-an-item-exists">Check an item exists</a></li>
<li><a href="#get-an-items-parent">Get an items parent</a></li>
<li><a href="#get-an-items-index">Get an items index</a></li>
<li><a href="#check-if-an-item-is-currently-displayed">Check if an item is currently displayed</a></li>
<li><a href="#display-an-item">Display an item</a></li>
<li><a href="#scroll-to-an-item">Scroll to an item</a></li>
<li><a href="#get-currently-selected-items">Get currently selected items</a></li>
<li><a href="#set-selected-items">Set selected items</a></li>
<li><a href="#add-selected-items">Add selected items</a></li>
<li><a href="#remove-selections">Remove selections</a></li>
<li><a href="#toggle-selections">Toggle selections</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#progress-bars">Progress Bars</a><ul>
<li><a href="#create-a-progress-bar">Create a progress bar</a></li>
<li><a href="#modify-progress-bars">Modify progress bars</a></li>
<li><a href="#delete-progress-bars">Delete progress bars</a></li>
</ul>
</li>
<li><a href="#tags">Tags</a><ul>
<li><a href="#tag-a-specific-cell">Tag a specific cell</a></li>
<li><a href="#tag-specific-rows">Tag specific rows</a></li>
<li><a href="#tag-specific-columns">Tag specific columns</a></li>
<li><a href="#tag-using-a-span">Tag using a span</a></li>
<li><a href="#untag">Untag</a></li>
<li><a href="#delete-tags">Delete tags</a></li>
<li><a href="#get-cells-rows-or-columns-associated-with-tags">Get cells, rows or columns associated with tags</a></li>
</ul>
</li>
<li><a href="#example-loading-data-from-excel">Example Loading Data from Excel</a></li>
<li><a href="#example-custom-right-click-and-text-editor-validation">Example Custom Right Click and Text Editor Validation</a></li>
<li><a href="#example-displaying-selections">Example Displaying Selections</a></li>
<li><a href="#example-list-box">Example List Box</a></li>
<li><a href="#example-header-dropdown-boxes-and-row-filtering">Example Header Dropdown Boxes and Row Filtering</a></li>
<li><a href="#example-readme-screenshot-code">Example Readme Screenshot Code</a></li>
<li><a href="#example-saving-tksheet-as-a-csv-file">Example Saving tksheet as a csv File</a></li>
<li><a href="#example-using-and-creating-formatters">Example Using and Creating Formatters</a></li>
<li><a href="#contributing">Contributing</a><ul>
<li><a href="#tksheet-goals">tksheet Goals</a></li>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#license">License</a></li>
<li><a href="#contributing-code">Contributing Code</a></li>
<li><a href="#asking-questions">Asking Questions</a></li>
<li><a href="#issues">Issues</a></li>
<li><a href="#enhancements-or-suggestions">Enhancements or Suggestions</a></li>
<li><a href="#contributors-and-special-thanks">Contributors and Special Thanks</a></li>
</ul>
</li>
</ul>
</div>
</div>
    <div class="main-content">
        <div class="buttons-container">
            <label for="toggle-toc" class="toggle-button">Toggle Index</label>
            <label for="toggle-theme" class="theme-button">🌙</label>
        </div>
        <div class="content">
            <h1 id="table-of-contents">Table of Contents</h1>
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#about-tksheet">About tksheet</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#installation-and-requirements">Installation and Requirements</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#basic-initialization">Basic Initialization</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#usage-examples">Usage Examples</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#initialization-options">Initialization Options</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-appearance">Sheet Appearance</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#alternate-row-colors">Alternate Row Colors</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#header-and-index">Header and Index</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#text-wrap-and-overflow">Text Wrap and Overflow</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#table-functionality-and-bindings">Table Functionality and Bindings</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">tkinter and tksheet Events</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-languages-and-bindings">Sheet Languages and Bindings</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#span-objects">Span Objects</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">Named Spans</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#getting-sheet-data">Getting Sheet Data</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#setting-sheet-data">Setting Sheet Data</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#sorting-the-table">Sorting the Table</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#find-and-replace">Find and Replace</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#highlighting-cells">Highlighting Cells</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#dropdown-boxes">Dropdown Boxes</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#check-boxes">Check Boxes</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#data-formatting">Data Formatting</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#readonly-cells">Readonly Cells</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#text-font-and-alignment">Text Font and Alignment</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#getting-cell-properties">Getting Cell Properties</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#getting-selected-cells">Getting Selected Cells</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#modifying-selected-cells">Modifying Selected Cells</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#row-heights-and-column-widths">Row Heights and Column Widths</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#identifying-bound-event-mouse-position">Identifying Bound Event Mouse Position</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#scroll-positions-and-cell-visibility">Scroll Positions and Cell Visibility</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#hiding-columns">Hiding Columns</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#hiding-rows">Hiding Rows</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#hiding-sheet-elements">Hiding Sheet Elements</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-height-and-width">Sheet Height and Width</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#cell-text-editor">Cell Text Editor</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-options-and-other-functions">Sheet Options and Other Functions</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#treeview-mode">Treeview Mode</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#progress-bars">Progress Bars</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#tags">Tags</a></li>
</ul>
<hr />
<ul>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-loading-data-from-excel">Example Loading Data from Excel</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-custom-right-click-and-text-editor-validation">Example Custom Right Click and Text Editor Validation</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-displaying-selections">Example Displaying Selections</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-list-box">Example List Box</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-header-dropdown-boxes-and-row-filtering">Example Header Dropdown Boxes and Row Filtering</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-readme-screenshot-code">Example ReadMe Screenshot Code</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-saving-tksheet-as-a-csv-file">Example Saving tksheet as a csv File</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-using-and-creating-formatters">Example Using and Creating Formatters</a></li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#contributing">Contributing</a></li>
</ul>
<hr />
<h1 id="about-tksheet"><strong>About tksheet</strong></h1>
<ul>
<li><code>tksheet</code> is a Python tkinter table and treeview widget written in pure python.</li>
<li>It is licensed under the <a href="https://github.com/ragardner/tksheet/blob/master/LICENSE.txt">MIT license</a>.</li>
<li>It works by using tkinter canvases and moving lines, text and rectangles around for only the visible portion of the table.</li>
<li>If you are using a version of tksheet that is older than <code>7.0.0</code> then you will need the documentation <a href="https://github.com/ragardner/tksheet/wiki/Version-6">here</a> instead.<ul>
<li>In tksheet versions &gt;= <code>7.0.2</code> the current version will be at the top of the file <code>__init__.py</code>.</li>
</ul>
</li>
</ul>
<h3 id="limitations"><strong>Limitations</strong></h3>
<p>Some examples of things that are not possible with tksheet:
- Due to the limitations of the Tkinter Canvas right-to-left (RTL) languages are not supported.
- Cell merging.
- Changing font for individual cells.
- Mouse drag copy cells.
- Cell highlight borders.
- At the present time the type hinting in tksheet is only meant to serve as a guide and not to be used with type checkers.</p>
<hr />
<h1 id="installation-and-requirements"><strong>Installation and Requirements</strong></h1>
<p><code>tksheet</code> is available through PyPi (Python package index) and can be installed by using Pip through the command line <code>pip install tksheet</code></p>
<pre><code class="language-python">#To install using pip
pip install tksheet

#To update using pip
pip install tksheet --upgrade
</code></pre>
<p>Alternatively you can download the source code and inside the tksheet directory where the <code>pyproject.toml</code> file is located use the command line <code>pip install -e .</code></p>
<ul>
<li>Versions <strong>&lt;</strong> <code>7.0.0</code> require a Python version of <strong><code>3.7</code></strong> or higher.</li>
<li>Versions <strong>&gt;=</strong> <code>7.0.0</code> require a Python version of <strong><code>3.8</code></strong> or higher.</li>
</ul>
<hr />
<h1 id="basic-initialization"><strong>Basic Initialization</strong></h1>
<p>Like other tkinter widgets you need only the <code>Sheet()</code>s parent as an argument to initialize a <code>Sheet()</code> e.g.</p>
<pre><code class="language-python">sheet = Sheet(my_frame_widget)
</code></pre>
<ul>
<li><code>my_frame_widget</code> would be replaced by whatever widget is your <code>Sheet()</code>s parent.</li>
</ul>
<hr />
<p>As an example, this is a tkinter program involving a <code>Sheet()</code> widget</p>
<pre><code class="language-python">from tksheet import Sheet
import tkinter as tk


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight = 1)
        self.grid_rowconfigure(0, weight = 1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight = 1)
        self.frame.grid_rowconfigure(0, weight = 1)
        self.sheet = Sheet(self.frame,
                           data = [[f&quot;Row {r}, Column {c}\nnewline1\nnewline2&quot; for c in range(50)] for r in range(500)])
        self.sheet.enable_bindings()
        self.frame.grid(row = 0, column = 0, sticky = &quot;nswe&quot;)
        self.sheet.grid(row = 0, column = 0, sticky = &quot;nswe&quot;)


app = demo()
app.mainloop()
</code></pre>
<hr />
<h1 id="usage-examples"><strong>Usage Examples</strong></h1>
<p>This is to demonstrate some of tksheets functionality.
- The functions which return the Sheet itself (have <code>-&gt; Sheet</code>) can be chained with other Sheet functions.
- The functions which return a Span (have <code>-&gt; Span</code>) can be chained with other Span functions.</p>
<pre><code class="language-python">from tksheet import Sheet, num2alpha
import tkinter as tk


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight=1)
        self.frame.grid_rowconfigure(0, weight=1)

        # create an instance of Sheet()
        self.sheet = Sheet(
            # set the Sheets parent widget
            self.frame,
            # optional: set the Sheets data at initialization
            data=[[f&quot;Row {r}, Column {c}\nnewline1\nnewline2&quot; for c in range(20)] for r in range(100)],
            theme=&quot;light green&quot;,
            height=520,
            width=1000,
        )
        # enable various bindings
        self.sheet.enable_bindings(&quot;all&quot;, &quot;edit_index&quot;, &quot;edit_header&quot;)

        # set a user edit validation function
        # AND bind all sheet modification events to a function
        # chained as two functions
        # more information at:
        # https://github.com/ragardner/tksheet/wiki/Version-7#validate-user-cell-edits
        self.sheet.edit_validation(self.validate_edits).bind(&quot;&lt;&lt;SheetModified&gt;&gt;&quot;, self.sheet_modified)

        # add some new commands to the in-built right click menu
        # setting data
        self.sheet.popup_menu_add_command(
            &quot;Say Hello&quot;,
            self.say_hello,
            index_menu=False,
            header_menu=False,
            empty_space_menu=False,
        )
        # getting data
        self.sheet.popup_menu_add_command(
            &quot;Print some data&quot;,
            self.print_data,
            empty_space_menu=False,
        )
        # overwrite Sheet data
        self.sheet.popup_menu_add_command(&quot;Reset Sheet data&quot;, self.reset)
        # set the header
        self.sheet.popup_menu_add_command(
            &quot;Set header data&quot;,
            self.set_header,
            table_menu=False,
            index_menu=False,
            empty_space_menu=False,
        )
        # set the index
        self.sheet.popup_menu_add_command(
            &quot;Set index data&quot;,
            self.set_index,
            table_menu=False,
            header_menu=False,
            empty_space_menu=False,
        )

        self.frame.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.grid(row=0, column=0, sticky=&quot;nswe&quot;)

    def validate_edits(self, event):
        # print (event)
        if event.eventname.endswith(&quot;header&quot;):
            return event.value + &quot; edited header&quot;
        elif event.eventname.endswith(&quot;index&quot;):
            return event.value + &quot; edited index&quot;
        else:
            if not event.value:
                return &quot;EMPTY&quot;
            return event.value[:3]

    def say_hello(self):
        current_selection = self.sheet.get_currently_selected()
        if current_selection:
            box = (current_selection.row, current_selection.column)
            # set cell data, end user Undo enabled
            # more information at:
            # https://github.com/ragardner/tksheet/wiki/Version-7#setting-sheet-data
            self.sheet[box].options(undo=True).data = &quot;Hello World!&quot;
            # highlight the cell for 2 seconds
            self.highlight_area(box)

    def print_data(self):
        for box in self.sheet.get_all_selection_boxes():
            # get user selected area sheet data
            # more information at:
            # https://github.com/ragardner/tksheet/wiki/Version-7#getting-sheet-data
            data = self.sheet[box].data
            for row in data:
                print(row)

    def reset(self):
        # overwrites sheet data, more information at:
        # https://github.com/ragardner/tksheet/wiki/Version-7#setting-sheet-data
        self.sheet.set_sheet_data([[f&quot;Row {r}, Column {c}\nnewline1\nnewline2&quot; for c in range(20)] for r in range(100)])
        # reset header and index
        self.sheet.headers([])
        self.sheet.index([])

    def set_header(self):
        self.sheet.headers(
            [f&quot;Header {(letter := num2alpha(i))} - {i + 1}\nHeader {letter} 2nd line!&quot; for i in range(20)]
        )

    def set_index(self):
        self.sheet.set_index_width()
        self.sheet.row_index(
            [f&quot;Index {(letter := num2alpha(i))} - {i + 1}\nIndex {letter} 2nd line!&quot; for i in range(100)]
        )

    def sheet_modified(self, event):
        # uncomment below if you want to take a look at the event object
        # print (&quot;The sheet was modified! Event object:&quot;)
        # for k, v in event.items():
        #     print (k, &quot;:&quot;, v)
        # print (&quot;\n&quot;)

        # otherwise more information at:
        # https://github.com/ragardner/tksheet/wiki/Version-7#event-data

        # highlight the modified cells briefly
        if event.eventname.startswith(&quot;move&quot;):
            for box in self.sheet.get_all_selection_boxes():
                self.highlight_area(box)
        else:
            for box in event.selection_boxes:
                self.highlight_area(box)

    def highlight_area(self, box, time=800):
        # highlighting an area of the sheet
        # more information at:
        # https://github.com/ragardner/tksheet/wiki/Version-7#highlighting-cells
        self.sheet[box].bg = &quot;indianred1&quot;
        self.after(time, lambda: self.clear_highlight(box))

    def clear_highlight(self, box):
        self.sheet[box].dehighlight()


app = demo()
app.mainloop()
</code></pre>
<hr />
<h1 id="initialization-options"><strong>Initialization Options</strong></h1>
<p>These are all the initialization parameters, the only required argument is the sheets <code>parent</code>, every other parameter has default arguments.</p>
<pre><code class="language-python">def __init__(
    parent: tk.Misc,
    name: str = &quot;!sheet&quot;,
    show_table: bool = True,
    show_top_left: bool | None = None,
    show_row_index: bool = True,
    show_header: bool = True,
    show_x_scrollbar: bool = True,
    show_y_scrollbar: bool = True,
    width: int | None = None,
    height: int | None = None,
    headers: None | list[object] = None,
    header: None | list[object] = None,
    row_index: None | list[object] = None,
    index: None | list[object] = None,
    default_header: Literal[&quot;letters&quot;, &quot;numbers&quot;, &quot;both&quot;] | None = &quot;letters&quot;,
    default_row_index: Literal[&quot;letters&quot;, &quot;numbers&quot;, &quot;both&quot;] | None = &quot;numbers&quot;,
    data_reference: None | Sequence[Sequence[object]] = None,
    data: None | Sequence[Sequence[object]] = None,
    # either (start row, end row, &quot;rows&quot;), (start column, end column, &quot;rows&quot;) or
    # (cells start row, cells start column, cells end row, cells end column, &quot;cells&quot;)  # noqa: E501
    startup_select: tuple[int, int, str] | tuple[int, int, int, int, str] = None,
    startup_focus: bool = True,
    total_columns: int | None = None,
    total_rows: int | None = None,
    default_column_width: int = 120,
    default_header_height: str | int = &quot;1&quot;,
    default_row_index_width: int = 70,
    default_row_height: str | int = &quot;1&quot;,
    min_column_width: int = 1,
    max_column_width: float = float(&quot;inf&quot;),
    max_row_height: float = float(&quot;inf&quot;),
    max_header_height: float = float(&quot;inf&quot;),
    max_index_width: float = float(&quot;inf&quot;),
    after_redraw_time_ms: int = 20,
    set_all_heights_and_widths: bool = False,
    zoom: int = 100,
    align: str = &quot;w&quot;,
    header_align: str = &quot;center&quot;,
    row_index_align: str | None = None,
    index_align: str = &quot;center&quot;,
    displayed_columns: list[int] = [],
    all_columns_displayed: bool = True,
    displayed_rows: list[int] = [],
    all_rows_displayed: bool = True,
    to_clipboard_delimiter: str = &quot;\t&quot;,
    to_clipboard_quotechar: str = '&quot;',
    to_clipboard_lineterminator: str = &quot;\n&quot;,
    from_clipboard_delimiters: list[str] | str = [&quot;\t&quot;],
    show_default_header_for_empty: bool = True,
    show_default_index_for_empty: bool = True,
    page_up_down_select_row: bool = True,
    paste_can_expand_x: bool = False,
    paste_can_expand_y: bool = False,
    paste_insert_column_limit: int | None = None,
    paste_insert_row_limit: int | None = None,
    show_dropdown_borders: bool = False,
    arrow_key_down_right_scroll_page: bool = False,
    cell_auto_resize_enabled: bool = True,
    auto_resize_row_index: bool | Literal[&quot;empty&quot;] = &quot;empty&quot;,
    auto_resize_columns: int | None = None,
    auto_resize_rows: int | None = None,
    set_cell_sizes_on_zoom: bool = False,
    font: tuple[str, int, str] = FontTuple(
        &quot;Calibri&quot;,
        13 if USER_OS == &quot;darwin&quot; else 11,
        &quot;normal&quot;,
    ),
    header_font: tuple[str, int, str] = FontTuple(
        &quot;Calibri&quot;,
        13 if USER_OS == &quot;darwin&quot; else 11,
        &quot;normal&quot;,
    ),
    index_font: tuple[str, int, str] = FontTuple(
        &quot;Calibri&quot;,
        13 if USER_OS == &quot;darwin&quot; else 11,
        &quot;normal&quot;,
    ),  # currently has no effect
    popup_menu_font: tuple[str, int, str] = FontTuple(
        &quot;Calibri&quot;,
        13 if USER_OS == &quot;darwin&quot; else 11,
        &quot;normal&quot;,
    ),
    max_undos: int = 30,
    column_drag_and_drop_perform: bool = True,
    row_drag_and_drop_perform: bool = True,
    empty_horizontal: int = 50,
    empty_vertical: int = 50,
    selected_rows_to_end_of_window: bool = False,
    horizontal_grid_to_end_of_window: bool = False,
    vertical_grid_to_end_of_window: bool = False,
    show_vertical_grid: bool = True,
    show_horizontal_grid: bool = True,
    display_selected_fg_over_highlights: bool = False,
    show_selected_cells_border: bool = True,
    edit_cell_tab: Literal[&quot;right&quot;, &quot;down&quot;, &quot;&quot;] = &quot;right&quot;,
    edit_cell_return: Literal[&quot;right&quot;, &quot;down&quot;, &quot;&quot;] = &quot;down&quot;,
    editor_del_key: Literal[&quot;forward&quot;, &quot;backward&quot;, &quot;&quot;] = &quot;forward&quot;,
    treeview: bool = False,
    treeview_indent: str | int = &quot;5&quot;,
    rounded_boxes: bool = True,
    alternate_color: str = &quot;&quot;,
    allow_cell_overflow: bool = False,
    table_wrap: Literal[&quot;&quot;, &quot;w&quot;, &quot;c&quot;] = &quot;c&quot;,  # &quot;&quot; no wrap, &quot;w&quot; word wrap, &quot;c&quot; char wrap
    index_wrap: Literal[&quot;&quot;, &quot;w&quot;, &quot;c&quot;] = &quot;c&quot;,  # &quot;&quot; no wrap, &quot;w&quot; word wrap, &quot;c&quot; char wrap
    header_wrap: Literal[&quot;&quot;, &quot;w&quot;, &quot;c&quot;] = &quot;c&quot;,  # &quot;&quot; no wrap, &quot;w&quot; word wrap, &quot;c&quot; char wrap
    sort_key: Callable = natural_sort_key,
    # colors
    outline_thickness: int = 0,
    outline_color: str = theme_light_blue[&quot;outline_color&quot;],
    theme: str = &quot;light blue&quot;,
    frame_bg: str = theme_light_blue[&quot;table_bg&quot;],
    popup_menu_fg: str = theme_light_blue[&quot;popup_menu_fg&quot;],
    popup_menu_bg: str = theme_light_blue[&quot;popup_menu_bg&quot;],
    popup_menu_highlight_bg: str = theme_light_blue[&quot;popup_menu_highlight_bg&quot;],
    popup_menu_highlight_fg: str = theme_light_blue[&quot;popup_menu_highlight_fg&quot;],
    table_grid_fg: str = theme_light_blue[&quot;table_grid_fg&quot;],
    table_bg: str = theme_light_blue[&quot;table_bg&quot;],
    table_fg: str = theme_light_blue[&quot;table_fg&quot;],
    table_editor_bg: str = theme_light_blue[&quot;table_editor_bg&quot;],
    table_editor_fg: str = theme_light_blue[&quot;table_editor_fg&quot;],
    table_editor_select_bg: str = theme_light_blue[&quot;table_editor_select_bg&quot;],
    table_editor_select_fg: str = theme_light_blue[&quot;table_editor_select_fg&quot;],
    table_selected_box_cells_fg: str = theme_light_blue[&quot;table_selected_box_cells_fg&quot;],
    table_selected_box_rows_fg: str = theme_light_blue[&quot;table_selected_box_rows_fg&quot;],
    table_selected_box_columns_fg: str = theme_light_blue[&quot;table_selected_box_columns_fg&quot;],
    table_selected_cells_border_fg: str = theme_light_blue[&quot;table_selected_cells_border_fg&quot;],
    table_selected_cells_bg: str = theme_light_blue[&quot;table_selected_cells_bg&quot;],
    table_selected_cells_fg: str = theme_light_blue[&quot;table_selected_cells_fg&quot;],
    table_selected_rows_border_fg: str = theme_light_blue[&quot;table_selected_rows_border_fg&quot;],
    table_selected_rows_bg: str = theme_light_blue[&quot;table_selected_rows_bg&quot;],
    table_selected_rows_fg: str = theme_light_blue[&quot;table_selected_rows_fg&quot;],
    table_selected_columns_border_fg: str = theme_light_blue[&quot;table_selected_columns_border_fg&quot;],
    table_selected_columns_bg: str = theme_light_blue[&quot;table_selected_columns_bg&quot;],
    table_selected_columns_fg: str = theme_light_blue[&quot;table_selected_columns_fg&quot;],
    resizing_line_fg: str = theme_light_blue[&quot;resizing_line_fg&quot;],
    drag_and_drop_bg: str = theme_light_blue[&quot;drag_and_drop_bg&quot;],
    index_bg: str = theme_light_blue[&quot;index_bg&quot;],
    index_border_fg: str = theme_light_blue[&quot;index_border_fg&quot;],
    index_grid_fg: str = theme_light_blue[&quot;index_grid_fg&quot;],
    index_fg: str = theme_light_blue[&quot;index_fg&quot;],
    index_editor_bg: str = theme_light_blue[&quot;index_editor_bg&quot;],
    index_editor_fg: str = theme_light_blue[&quot;index_editor_fg&quot;],
    index_editor_select_bg: str = theme_light_blue[&quot;index_editor_select_bg&quot;],
    index_editor_select_fg: str = theme_light_blue[&quot;index_editor_select_fg&quot;],
    index_selected_cells_bg: str = theme_light_blue[&quot;index_selected_cells_bg&quot;],
    index_selected_cells_fg: str = theme_light_blue[&quot;index_selected_cells_fg&quot;],
    index_selected_rows_bg: str = theme_light_blue[&quot;index_selected_rows_bg&quot;],
    index_selected_rows_fg: str = theme_light_blue[&quot;index_selected_rows_fg&quot;],
    index_hidden_rows_expander_bg: str = theme_light_blue[&quot;index_hidden_rows_expander_bg&quot;],
    header_bg: str = theme_light_blue[&quot;header_bg&quot;],
    header_border_fg: str = theme_light_blue[&quot;header_border_fg&quot;],
    header_grid_fg: str = theme_light_blue[&quot;header_grid_fg&quot;],
    header_fg: str = theme_light_blue[&quot;header_fg&quot;],
    header_editor_bg: str = theme_light_blue[&quot;header_editor_bg&quot;],
    header_editor_fg: str = theme_light_blue[&quot;header_editor_fg&quot;],
    header_editor_select_bg: str = theme_light_blue[&quot;header_editor_select_bg&quot;],
    header_editor_select_fg: str = theme_light_blue[&quot;header_editor_select_fg&quot;],
    header_selected_cells_bg: str = theme_light_blue[&quot;header_selected_cells_bg&quot;],
    header_selected_cells_fg: str = theme_light_blue[&quot;header_selected_cells_fg&quot;],
    header_selected_columns_bg: str = theme_light_blue[&quot;header_selected_columns_bg&quot;],
    header_selected_columns_fg: str = theme_light_blue[&quot;header_selected_columns_fg&quot;],
    header_hidden_columns_expander_bg: str = theme_light_blue[&quot;header_hidden_columns_expander_bg&quot;],
    top_left_bg: str = theme_light_blue[&quot;top_left_bg&quot;],
    top_left_fg: str = theme_light_blue[&quot;top_left_fg&quot;],
    top_left_fg_highlight: str = theme_light_blue[&quot;top_left_fg_highlight&quot;],
    vertical_scroll_background: str = theme_light_blue[&quot;vertical_scroll_background&quot;],
    horizontal_scroll_background: str = theme_light_blue[&quot;horizontal_scroll_background&quot;],
    vertical_scroll_troughcolor: str = theme_light_blue[&quot;vertical_scroll_troughcolor&quot;],
    horizontal_scroll_troughcolor: str = theme_light_blue[&quot;horizontal_scroll_troughcolor&quot;],
    vertical_scroll_lightcolor: str = theme_light_blue[&quot;vertical_scroll_lightcolor&quot;],
    horizontal_scroll_lightcolor: str = theme_light_blue[&quot;horizontal_scroll_lightcolor&quot;],
    vertical_scroll_darkcolor: str = theme_light_blue[&quot;vertical_scroll_darkcolor&quot;],
    horizontal_scroll_darkcolor: str = theme_light_blue[&quot;horizontal_scroll_darkcolor&quot;],
    vertical_scroll_relief: str = theme_light_blue[&quot;vertical_scroll_relief&quot;],
    horizontal_scroll_relief: str = theme_light_blue[&quot;horizontal_scroll_relief&quot;],
    vertical_scroll_troughrelief: str = theme_light_blue[&quot;vertical_scroll_troughrelief&quot;],
    horizontal_scroll_troughrelief: str = theme_light_blue[&quot;horizontal_scroll_troughrelief&quot;],
    vertical_scroll_bordercolor: str = theme_light_blue[&quot;vertical_scroll_bordercolor&quot;],
    horizontal_scroll_bordercolor: str = theme_light_blue[&quot;horizontal_scroll_bordercolor&quot;],
    vertical_scroll_borderwidth: int = 1,
    horizontal_scroll_borderwidth: int = 1,
    vertical_scroll_gripcount: int = 0,
    horizontal_scroll_gripcount: int = 0,
    vertical_scroll_active_bg: str = theme_light_blue[&quot;vertical_scroll_active_bg&quot;],
    horizontal_scroll_active_bg: str = theme_light_blue[&quot;horizontal_scroll_active_bg&quot;],
    vertical_scroll_not_active_bg: str = theme_light_blue[&quot;vertical_scroll_not_active_bg&quot;],
    horizontal_scroll_not_active_bg: str = theme_light_blue[&quot;horizontal_scroll_not_active_bg&quot;],
    vertical_scroll_pressed_bg: str = theme_light_blue[&quot;vertical_scroll_pressed_bg&quot;],
    horizontal_scroll_pressed_bg: str = theme_light_blue[&quot;horizontal_scroll_pressed_bg&quot;],
    vertical_scroll_active_fg: str = theme_light_blue[&quot;vertical_scroll_active_fg&quot;],
    horizontal_scroll_active_fg: str = theme_light_blue[&quot;horizontal_scroll_active_fg&quot;],
    vertical_scroll_not_active_fg: str = theme_light_blue[&quot;vertical_scroll_not_active_fg&quot;],
    horizontal_scroll_not_active_fg: str = theme_light_blue[&quot;horizontal_scroll_not_active_fg&quot;],
    vertical_scroll_pressed_fg: str = theme_light_blue[&quot;vertical_scroll_pressed_fg&quot;],
    horizontal_scroll_pressed_fg: str = theme_light_blue[&quot;horizontal_scroll_pressed_fg&quot;],
    scrollbar_theme_inheritance: str = &quot;default&quot;,
    scrollbar_show_arrows: bool = True,
    # changing the arrowsize (width) of the scrollbars
    # is not working with 'default' theme
    # use 'clam' theme instead if you want to change the width
    vertical_scroll_arrowsize: str | int = &quot;&quot;,
    horizontal_scroll_arrowsize: str | int = &quot;&quot;,
) -&gt; None
</code></pre>
<ul>
<li><code>name</code> setting a name for the sheet is useful when you have multiple sheets and you need to determine which one an event came from.</li>
<li><code>auto_resize_columns</code> (<code>int</code>, <code>None</code>) if set as an <code>int</code> the columns will automatically resize to fit the width of the window, the <code>int</code> value being the minimum of each column in pixels.</li>
<li><code>auto_resize_rows</code> (<code>int</code>, <code>None</code>) if set as an <code>int</code> the rows will automatically resize to fit the height of the window, the <code>int</code> value being the minimum height of each row in pixels.</li>
<li><code>startup_select</code> selects cells, rows or columns at initialization by using a <code>tuple</code> e.g. <code>(0, 0, "cells")</code> for cell A0 or <code>(0, 5, "rows")</code> for rows 0 to 5.</li>
<li><code>data_reference</code> and <code>data</code> are essentially the same.</li>
<li><code>row_index</code> and <code>index</code> are the same, <code>index</code> takes priority, same as with <code>headers</code> and <code>header</code>.</li>
<li><code>startup_select</code> either <code>(start row, end row, "rows")</code>, <code>(start column, end column, "rows")</code> or <code>(start row, start column, end row, end column, "cells")</code>. The start/end row/column variables need to be <code>int</code>s.</li>
<li><code>auto_resize_row_index</code> either <code>True</code>, <code>False</code> or <code>"empty"</code>.<ul>
<li><code>"empty"</code> it will only automatically resize if the row index is empty.</li>
<li><code>True</code> it will always automatically resize.</li>
<li><code>False</code> it will never automatically resize.</li>
</ul>
</li>
<li>If <code>show_selected_cells_border</code> is <code>False</code> then the colors for <code>table_selected_box_cells_fg</code>/<code>table_selected_box_rows_fg</code>/<code>table_selected_box_columns_fg</code> will be used for the currently selected cells background.</li>
<li>Only set <code>show_top_left</code> to <code>True</code> if you want to always show the top left rectangle of the sheet. Leave as <code>None</code> to only show it when both the index and header are showing.</li>
<li>For help with <code>treeview</code> mode see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#treeview-mode">here</a>.</li>
</ul>
<p>You can change most of these settings after initialization using the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-options-and-other-functions"><code>set_options()</code> function</a>.
- <code>scrollbar_theme_inheritance</code> and <code>scrollbar_show_arrows</code> will only work on <code>Sheet()</code> initialization, not with <code>set_options()</code></p>
<hr />
<h1 id="sheet-appearance"><strong>Sheet Appearance</strong></h1>
<h3 id="sheet-colors"><strong>Sheet Colors</strong></h3>
<p>To change the colors of individual cells, rows or columns use the functions listed under <a href="https://github.com/ragardner/tksheet/wiki/Version-7#highlighting-cells">highlighting cells</a>.</p>
<p>For the colors of specific parts of the table such as gridlines and backgrounds use the function <code>set_options()</code>, keyword arguments specific to sheet colors are listed below. All the other <code>set_options()</code> arguments can be found <a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-options-and-other-functions">here</a>.</p>
<p>Use a tkinter color or a hex string e.g.</p>
<pre><code class="language-python">my_sheet_widget.set_options(table_bg=&quot;black&quot;)
my_sheet_widget.set_options(table_bg=&quot;#000000&quot;)
my_sheet_widget.set_options(horizontal_scroll_pressed_bg=&quot;red&quot;)
</code></pre>
<h4 id="set-options"><strong>Set options</strong></h4>
<pre><code class="language-python">set_options(
top_left_bg
top_left_fg
top_left_fg_highlight

table_bg
table_grid_fg
table_fg
table_selected_box_cells_fg
table_selected_box_rows_fg
table_selected_box_columns_fg
table_selected_cells_border_fg
table_selected_cells_bg
table_selected_cells_fg
table_selected_rows_border_fg
table_selected_rows_bg
table_selected_rows_fg
table_selected_columns_border_fg
table_selected_columns_bg
table_selected_columns_fg

header_bg
header_border_fg
header_grid_fg
header_fg
header_selected_cells_bg
header_selected_cells_fg
header_selected_columns_bg
header_selected_columns_fg

index_bg
index_border_fg
index_grid_fg
index_fg
index_selected_cells_bg
index_selected_cells_fg
index_selected_rows_bg
index_selected_rows_fg

resizing_line_fg
drag_and_drop_bg
outline_thickness
outline_color
frame_bg
popup_menu_font
popup_menu_fg
popup_menu_bg
popup_menu_highlight_bg
popup_menu_highlight_fg

# scroll bars
vertical_scroll_background
horizontal_scroll_background
vertical_scroll_troughcolor
horizontal_scroll_troughcolor
vertical_scroll_lightcolor
horizontal_scroll_lightcolor
vertical_scroll_darkcolor
horizontal_scroll_darkcolor
vertical_scroll_bordercolor
horizontal_scroll_bordercolor
vertical_scroll_active_bg
horizontal_scroll_active_bg
vertical_scroll_not_active_bg
horizontal_scroll_not_active_bg
vertical_scroll_pressed_bg
horizontal_scroll_pressed_bg
vertical_scroll_active_fg
horizontal_scroll_active_fg
vertical_scroll_not_active_fg
horizontal_scroll_not_active_fg
vertical_scroll_pressed_fg
horizontal_scroll_pressed_fg
)
</code></pre>
<p>Otherwise you can change the theme using the below function.</p>
<pre><code class="language-python">change_theme(theme: str = &quot;light blue&quot;, redraw: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li><code>theme</code> (<code>str</code>) options (themes) are currently <code>"light blue"</code>, <code>"light green"</code>, <code>"dark"</code>, <code>"black"</code>, <code>"dark blue"</code> and <code>"dark green"</code>.</li>
</ul>
<h3 id="scrollbar-appearance"><strong>Scrollbar Appearance</strong></h3>
<p><strong>Scrollbar colors:</strong></p>
<p>The above <a href="https://github.com/ragardner/tksheet/wiki/Version-7#set-options">function and keyword arguments</a> can be used to change the colors of the scroll bars.</p>
<p><strong>Scrollbar relief, size, arrows, etc.</strong></p>
<p>Some scroll bar style options can only be changed on <code>Sheet()</code> initialization, others can be changed whenever using <code>set_options()</code>.
- Options that can only be set in the <code>= Sheet(...)</code> initialization:
    - <code>scrollbar_theme_inheritance: str = "default"</code>
        - This is which tkinter theme to inherit the new style from, changing the width of the scroll bar might not work with the <code>"default"</code> theme. If this is the case try using <code>"clam"</code> instead.
    - <code>scrollbar_show_arrows: bool</code>
        - When <code>False</code> the scroll bars arrow buttons on either end will be hidden, this may effect the width of the scroll bar.
- Options that can be set using <code>set_options()</code> also:
    - <code>vertical_scroll_borderwidth: int</code>
    - <code>horizontal_scroll_borderwidth: int</code>
    - <code>vertical_scroll_gripcount: int</code>
    - <code>horizontal_scroll_gripcount: int</code>
    - <code>vertical_scroll_arrowsize: str | int</code>
    - <code>horizontal_scroll_arrowsize: str | int</code></p>
<hr />
<h1 id="alternate-row-colors"><strong>Alternate Row Colors</strong></h1>
<p>For basic alternate row colors in the main table either:
- Use the <code>Sheet()</code> initialization keyword argument <code>alternate_color</code> (<code>str</code>) or
- Use the <code>set_options()</code> function with the keyword argument <code>alternate_color</code></p>
<p>Examples:</p>
<pre><code class="language-python">set_options(alternate_color=&quot;#E2EAF4&quot;)
</code></pre>
<pre><code class="language-python">my_sheet = Sheet(parent, alternate_color=&quot;gray80&quot;)
</code></pre>
<p>Note that any cell, row or column highlights will display over alternate row colors.</p>
<hr />
<h1 id="header-and-index"><strong>Header and Index</strong></h1>
<h4 id="set-the-header"><strong>Set the header</strong></h4>
<pre><code class="language-python">set_header_data(value: object, c: int | None | Iterator = None, redraw: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li><code>value</code> (<code>iterable</code>, <code>int</code>, <code>Any</code>) if <code>c</code> is left as <code>None</code> then it attempts to set the whole header as the <code>value</code> (converting a generator to a list). If <code>value</code> is <code>int</code> it sets the header to display the row with that position.</li>
<li><code>c</code> (<code>iterable</code>, <code>int</code>, <code>None</code>) if both <code>value</code> and <code>c</code> are iterables it assumes <code>c</code> is an iterable of positions and <code>value</code> is an iterable of values and attempts to set each value to each position. If <code>c</code> is <code>int</code> it attempts to set the value at that position.</li>
</ul>
<pre><code class="language-python">headers(
    newheaders: object = None,
    index: None | int = None,
    reset_col_positions: bool = False,
    show_headers_if_not_sheet: bool = True,
    redraw: bool = True,
) -&gt; object
</code></pre>
<ul>
<li>Using an integer <code>int</code> for argument <code>newheaders</code> makes the sheet use that row as a header e.g. <code>headers(0)</code> means the first row will be used as a header (the first row will not be hidden in the sheet though), this is sort of equivalent to freezing the row.</li>
<li>Leaving <code>newheaders</code> as <code>None</code> and using the <code>index</code> argument returns the existing header value in that index.</li>
<li>Leaving all arguments as default e.g. <code>headers()</code> returns existing headers.</li>
</ul>
<hr />
<h4 id="set-the-index"><strong>Set the index</strong></h4>
<pre><code class="language-python">set_index_data(value: object, r: int | None | Iterator = None, redraw: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li><code>value</code> (<code>iterable</code>, <code>int</code>, <code>Any</code>) if <code>r</code> is left as <code>None</code> then it attempts to set the whole index as the <code>value</code> (converting a generator to a list). If <code>value</code> is <code>int</code> it sets the index to display the row with that position.</li>
<li><code>r</code> (<code>iterable</code>, <code>int</code>, <code>None</code>) if both <code>value</code> and <code>r</code> are iterables it assumes <code>r</code> is an iterable of positions and <code>value</code> is an iterable of values and attempts to set each value to each position. If <code>r</code> is <code>int</code> it attempts to set the value at that position.</li>
</ul>
<pre><code class="language-python">row_index(
    newindex: object = None,
    index: None | int = None,
    reset_row_positions: bool = False,
    show_index_if_not_sheet: bool = True,
    redraw: bool = True,
) -&gt; object
</code></pre>
<ul>
<li>Using an integer <code>int</code> for argument <code>newindex</code> makes the sheet use that column as an index e.g. <code>row_index(0)</code> means the first column will be used as an index (the first column will not be hidden in the sheet though), this is sort of equivalent to freezing the column.</li>
<li>Leaving <code>newindex</code> as <code>None</code> and using the <code>index</code> argument returns the existing row index value in that index.</li>
<li>Leaving all arguments as default e.g. <code>row_index()</code> returns the existing row index.</li>
</ul>
<hr />
<h1 id="text-wrap-and-overflow"><strong>Text Wrap and Overflow</strong></h1>
<h4 id="control-text-wrapping"><strong>Control text wrapping</strong></h4>
<p>You can set table, header and index text wrapping either at <code>Sheet()</code> initialization or using <code>set_options()</code>.</p>
<p>Make use of the following parameters:
- <code>table_wrap</code>
- <code>index_wrap</code>
- <code>header_wrap</code></p>
<p>With one of the following arguments:
- <code>""</code> - For no text wrapping.
- <code>"c"</code> - For character wrapping.
- <code>"w"</code> - For word wrapping.</p>
<p><strong>Examples:</strong></p>
<pre><code class="language-python"># for word wrap at initialization
my_sheet = Sheet(parent, table_wrap=&quot;w&quot;)

# for character wrap using set_options()
my_sheet.set_options(table_wrap=&quot;c&quot;)
</code></pre>
<h4 id="control-table-text-overflow"><strong>Control table text overflow</strong></h4>
<p>This setting only works for cells that are not center (north) aligned. Cell text can be set to overflow adjacent empty cells in the table like so:</p>
<p><strong>Examples:</strong></p>
<pre><code class="language-python"># for word wrap at initialization
my_sheet = Sheet(parent, allow_cell_overflow=True)

# for character wrap using set_options()
my_sheet.set_options(allow_cell_overflow=True)
</code></pre>
<ul>
<li>Set it to <code>False</code> to disable it.</li>
<li>It is only available as a global setting for the table, not on a cell by cell basis.</li>
</ul>
<hr />
<h1 id="table-functionality-and-bindings"><strong>Table functionality and bindings</strong></h1>
<h4 id="enable-table-functionality-and-bindings"><strong>Enable table functionality and bindings</strong></h4>
<pre><code class="language-python">enable_bindings(*bindings)
</code></pre>
<ul>
<li><code>bindings</code> (<code>str</code>) options are (rc stands for right click):<ul>
<li><code>"all"</code> # enables all bindings with <code>single_select</code> mode, except the bindings that have to be specifically enabled by name.</li>
<li><code>"single_select"</code> # normal selection mode</li>
<li><code>"toggle_select"</code> # has issues but to enable a selection mode where cell/row/column selection is toggled</li>
<li><code>"drag_select"</code> # to allow mouse click and drag selection of cells/rows/columns</li>
<li><code>"select_all"</code> # drag_select also enables select_all</li>
<li><code>"column_drag_and_drop"</code> / <code>"move_columns"</code> # to allow drag and drop of columns</li>
<li><code>"row_drag_and_drop"</code> / <code>"move_rows"</code> # to allow drag and drop of rows</li>
<li><code>"column_select"</code> # to allow column selection</li>
<li><code>"row_select"</code> # to allow row selection</li>
<li><code>"column_width_resize"</code> # for resizing columns</li>
<li><code>"double_click_column_resize"</code> # for resizing columns to row text width</li>
<li><code>"row_width_resize"</code> # to resize the index width</li>
<li><code>"column_height_resize"</code> # to resize the header height</li>
<li><code>"arrowkeys"</code> # all arrowkeys including page up and down</li>
<li><code>"up"</code> # individual arrow key</li>
<li><code>"down"</code> # individual arrow key</li>
<li><code>"left"</code> # individual arrow key</li>
<li><code>"right"</code> # individual arrow key</li>
<li><code>"prior"</code> # page up</li>
<li><code>"next"</code> # page down</li>
<li><code>"row_height_resize"</code> # to resize rows</li>
<li><code>"double_click_row_resize"</code> # for resizing rows to row text height</li>
<li><code>"right_click_popup_menu"</code> / <code>"rc_popup_menu"</code> / <code>"rc_menu"</code> # for the in-built table context menu</li>
<li><code>"rc_select"</code> # for selecting cells using right click</li>
<li><code>"rc_insert_column"</code> # for a menu option to add columns</li>
<li><code>"rc_delete_column"</code> # for a menu option to delete columns</li>
<li><code>"rc_insert_row"</code> # for a menu option to add rows</li>
<li><code>"rc_delete_row"</code> # for a menu option to delete rows</li>
<li><code>"sort_cells"</code></li>
<li><code>"sort_row"</code></li>
<li><code>"sort_column"</code> / <code>"sort_col"</code></li>
<li><code>"sort_rows"</code></li>
<li><code>"sort_columns"</code> / <code>"sort_cols"</code></li>
<li><code>"copy"</code> # for copying to clipboard</li>
<li><code>"cut"</code> # for cutting to clipboard</li>
<li><code>"paste"</code> # for pasting into the table</li>
<li><code>"delete"</code> # for clearing cells with the delete key</li>
<li><code>"undo"</code> # for undo and redo</li>
<li><code>"edit_cell"</code> # allow table cell editing</li>
<li><code>"find"</code> # for a pop-up find window (does not find in index or header)</li>
<li><code>"replace"</code> # additional functionality for the find window, replace and replace all</li>
<li>*<code>"ctrl_click_select"</code> / <code>"ctrl_select"</code> # for selecting multiple non-adjacent cells/rows/columns</li>
<li>*<code>"edit_header"</code> # allow header cell editing</li>
<li>*<code>"edit_index"</code> # allow index cell editing</li>
</ul>
</li>
</ul>
<p>*has to be specifically enabled - See Notes.</p>
<p>Notes:
- You can change the Sheets key bindings for functionality such as copy, paste, up, down etc. Instructions can be found <a href="https://github.com/ragardner/tksheet/wiki/Version-7#changing-key-bindings">here</a>.
- <strong>Note</strong> that the following functionalities are not enabled using <code>"all"</code> and have to be specifically enabled:
    - <code>"ctrl_click_select"</code> / <code>"ctrl_select"</code>
    - <code>"edit_header"</code>
    - <code>"edit_index"</code>
- To allow table expansion when pasting data which doesn't fit in the table use either:
   - <code>paste_can_expand_x=True</code>, <code>paste_can_expand_y=True</code> in sheet initialization arguments or the same keyword arguments with the function <code>set_options()</code>.</p>
<p>Example:
- <code>sheet.enable_bindings()</code> to enable everything except <code>"ctrl_select"</code>, <code>"edit_index"</code>, <code>"edit_header"</code>.</p>
<hr />
<h4 id="disable-table-functionality-and-bindings"><strong>Disable table functionality and bindings</strong></h4>
<pre><code class="language-python">disable_bindings(*bindings)
</code></pre>
<p>Notes:
- Uses the same arguments as <code>enable_bindings()</code>.</p>
<hr />
<h4 id="bind-specific-table-functionality"><strong>Bind specific table functionality</strong></h4>
<p>This function allows you to bind <strong>very</strong> specific table functionality to your own functions.
- If you want less specificity in event names you can also bind all sheet modifying events to a single function, <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">see here</a>.
- If you want to validate/modify user cell edits <a href="https://github.com/ragardner/tksheet/wiki/Version-7#validate-user-cell-edits">see here</a>.</p>
<pre><code class="language-python">extra_bindings(
    bindings: str | list | tuple,
    func: Callable | None = None,
) -&gt; Sheet
</code></pre>
<p>Notes:
- There are several ways to use this function:
    - <code>bindings</code> as a <code>str</code> and <code>func</code> as either <code>None</code> or a function. Using <code>None</code> as an argument for <code>func</code> will effectively unbind the function.
        - <code>extra_bindings("edit_cell", func=my_function)</code>
    - <code>bindings</code> as an <code>iterable</code> of <code>str</code>s and <code>func</code> as either <code>None</code> or a function. Using <code>None</code> as an argument for <code>func</code> will effectively unbind the function.
        - <code>extra_bindings(["all_select_events", "copy", "cut"], func=my_function)</code>
    - <code>bindings</code> as an <code>iterable</code> of <code>list</code>s or <code>tuple</code>s with length of two, e.g.
        - <code>extra_bindings([(binding, function), (binding, function), ...])</code> In this example you could also use <code>None</code> in the place of <code>function</code> to unbind the binding.
        - In this case the arg <code>func</code> is totally ignored.
- For <code>"end_..."</code> events the bound function is run before the value is set.
- <strong>To unbind</strong> a function either set <code>func</code> argument to <code>None</code> or leave it as default e.g. <code>extra_bindings("begin_copy")</code> to unbind <code>"begin_copy"</code>.
- Even though undo/redo edits or adds or deletes rows/columns the bound functions for those actions will not be called. Undo/redo must be specifically bound in order for a function to be called.</p>
<p>Parameters:
<code>bindings</code> (<code>str</code>) options:
- Undo/Redo:
    - <code>"begin_undo", "begin_ctrl_z"</code>
    - <code>"ctrl_z", "end_undo", "end_ctrl_z", "undo"</code>
- Editing:
    - <code>"begin_copy", "begin_ctrl_c"</code>
    - <code>"ctrl_c", "end_copy", "end_ctrl_c", "copy"</code>
    - <code>"begin_cut", "begin_ctrl_x"</code>
    - <code>"ctrl_x", "end_cut", "end_ctrl_x", "cut"</code>
    - <code>"begin_paste", "begin_ctrl_v"</code>
    - <code>"ctrl_v", "end_paste", "end_ctrl_v", "paste"</code>
    - <code>"begin_delete_key", "begin_delete"</code>
    - <code>"delete_key", "end_delete", "end_delete_key", "delete"</code>
    - <code>"begin_edit_cell", "begin_edit_table"</code>
    - <code>"end_edit_cell", "edit_cell", "edit_table"</code>
    - <code>"begin_edit_header"</code>
    - <code>"end_edit_header", "edit_header"</code>
    - <code>"begin_edit_index"</code>
    - <code>"end_edit_index", "edit_index"</code>
    - <code>"replace_all"</code>
- Moving:
    - <code>"begin_row_index_drag_drop", "begin_move_rows"</code>
    - <code>"row_index_drag_drop", "move_rows", "end_move_rows", "end_row_index_drag_drop"</code>
    - <code>"begin_column_header_drag_drop", "begin_move_columns"</code>
    - <code>"column_header_drag_drop", "move_columns", "end_move_columns", "end_column_header_drag_drop"</code>
    - <code>"begin_sort_cells"</code>
    - <code>"sort_cells", "end_sort_cells"</code>
    - <code>"begin_sort_rows"</code>
    - <code>"sort_rows", "end_sort_rows"</code>
    - <code>"begin_sort_columns"</code>
    - <code>"sort_columns", "end_sort_columns"</code>
- Deleting:
    - <code>"begin_rc_delete_row", "begin_delete_rows"</code>
    - <code>"rc_delete_row", "end_rc_delete_row", "end_delete_rows", "delete_rows"</code>
    - <code>"begin_rc_delete_column", "begin_delete_columns"</code>
    - <code>"rc_delete_column", "end_rc_delete_column","end_delete_columns", "delete_columns"</code>
- Adding:
    - <code>"begin_rc_insert_column", "begin_insert_column", "begin_insert_columns", "begin_add_column","begin_rc_add_column", "begin_add_columns"</code>
    - <code>"rc_insert_column", "end_rc_insert_column", "end_insert_column", "end_insert_columns", "rc_add_column", "end_rc_add_column", "end_add_column", "end_add_columns", "add_columns"</code>
    - <code>"begin_rc_insert_row", "begin_insert_row", "begin_insert_rows", "begin_rc_add_row", "begin_add_row", "begin_add_rows"</code>
    - <code>"rc_insert_row", "end_rc_insert_row", "end_insert_row", "end_insert_rows", "rc_add_row", "end_rc_add_row", "end_add_row", "end_add_rows", "add_rows"</code>
- Resizing rows/columns:
    - <code>"row_height_resize"</code>
    - <code>"column_width_resize"</code>
- Selection:
    - <code>"cell_select"</code>
    - <code>"all_select"</code>
    - <code>"row_select"</code>
    - <code>"column_select"</code>
    - <code>"drag_select_cells"</code>
    - <code>"drag_select_rows"</code>
    - <code>"drag_select_columns"</code>
    - <code>"shift_cell_select"</code>
    - <code>"shift_row_select"</code>
    - <code>"shift_column_select"</code>
    - <code>"ctrl_cell_select"</code>
    - <code>"ctrl_row_select"</code>
    - <code>"ctrl_column_select"</code>
    - <code>"deselect"</code>
- Event collections:
    - <code>"all_select_events", "select", "selectevents", "select_events"</code>
    - <code>"all_modified_events", "sheetmodified", "sheet_modified" "modified_events", "modified"</code>
    - <code>"bind_all"</code>
    - <code>"unbind_all"</code></p>
<p>Further Notes:
- <code>func</code> argument is the function you want to send the binding event to.
- Using one of the following <code>"all_modified_events"</code>, <code>"sheetmodified"</code>, <code>"sheet_modified"</code>, <code>"modified_events"</code>, <code>"modified"</code> will make any insert, delete or cell edit including pastes and undos send an event to your function.
- For events <code>"begin_move_columns"</code>/<code>"begin_move_rows"</code> the point where columns/rows will be moved to will be accessible by the key named <code>"value"</code>.
- For <code>"begin_edit..."</code> events the bound function must return a value to open the cell editor with, example <a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-custom-right-click-and-text-editor-validation">here</a>.</p>
<h4 id="event-data"><strong>Event Data</strong></h4>
<p>Using <code>extra_bindings()</code> the function you bind needs to have at least one argument which will receive a <code>dict</code>. The values of which can be accessed by dot notation e.g. <code>event.eventname</code> or <code>event.cells.table</code>:</p>
<pre><code class="language-python">for (row, column), old_value in event.cells.table.items():
    print (f&quot;R{row}&quot;, f&quot;C{column}&quot;, &quot;Old Value:&quot;, old_value)
</code></pre>
<p>It has the following layout and keys:</p>
<pre><code class="language-python">{
    &quot;eventname&quot;: &quot;&quot;,
    &quot;sheetname&quot;: &quot;&quot;,
    &quot;cells&quot;: {
        &quot;table&quot;: {},
        &quot;header&quot;: {},
        &quot;index&quot;: {},
    },
    &quot;moved&quot;: {
        &quot;rows&quot;: {},
        &quot;columns&quot;: {},
    },
    &quot;added&quot;: {
        &quot;rows&quot;: {},
        &quot;columns&quot;: {},
    },
    &quot;deleted&quot;: {
        &quot;rows&quot;: {},
        &quot;columns&quot;: {},
        &quot;header&quot;: {},
        &quot;index&quot;: {},
        &quot;column_widths&quot;: {},
        &quot;row_heights&quot;: {},
        &quot;options&quot;: {},
        &quot;displayed_columns&quot;: None,
        &quot;displayed_rows&quot;: None,
    },
    &quot;named_spans&quot;: {},
    &quot;selection_boxes&quot;: {},
    &quot;selected&quot;: tuple(),
    &quot;being_selected&quot;: tuple(),
    &quot;data&quot;: [],
    &quot;key&quot;: &quot;&quot;,
    &quot;value&quot;: None,
    &quot;loc&quot;: tuple(),
    &quot;row&quot;: None,
    &quot;column&quot;: None,
    &quot;resized&quot;: {
        &quot;rows&quot;: {},
        &quot;columns&quot;: {},
    },
    &quot;widget&quot;: None,
}
</code></pre>
<p>Keys:
- A function bound using <code>extra_bindings()</code> will receive event data with one of the following <strong><code>["eventname"]</code></strong> keys:
    - <code>"begin_ctrl_c"</code>
    - <code>"end_ctrl_c"</code>
    - <code>"begin_ctrl_x"</code>
    - <code>"end_ctrl_x"</code>
    - <code>"begin_ctrl_v"</code>
    - <code>"end_ctrl_v"</code>
    - <code>"begin_delete"</code>
    - <code>"end_delete"</code>
    - <code>"begin_undo"</code>
    - <code>"end_undo"</code>
    - <code>"begin_add_columns"</code>
    - <code>"end_add_columns"</code>
    - <code>"begin_add_rows"</code>
    - <code>"end_add_rows"</code>
    - <code>"begin_delete_columns"</code>
    - <code>"end_delete_columns"</code>
    - <code>"begin_delete_rows"</code>
    - <code>"end_delete_rows"</code>
    - <code>"begin_edit_table"</code>
    - <code>"end_edit_table"</code>
    - <code>"begin_edit_index"</code>
    - <code>"end_edit_index"</code>
    - <code>"begin_edit_header"</code>
    - <code>"end_edit_header"</code>
    - <code>"select"</code>
    - <code>"resize"</code>
    - <em><code>"begin_move_rows"</code>
    - </em><code>"end_move_rows"</code>
    - <em><code>"begin_move_columns"</code>
    - </em><code>"end_move_columns"</code></p>
<ul>
<li>
<p>*is also used as the event name for sorting rows/columns events.</p>
</li>
<li>
<p><code>EventDataDict</code>s will otherwise have one of the following event names:</p>
<ul>
<li><code>"edit_table"</code> when a user has cut, paste, delete or made any cell edits including using dropdown boxes etc. in the table.</li>
<li><code>"edit_index"</code> when a user has edited a index cell.</li>
<li><code>"edit_header"</code> when a user has edited a header cell.</li>
<li><code>"add_columns"</code> when a user has inserted columns.</li>
<li><code>"add_rows"</code> when a user has inserted rows.</li>
<li><code>"delete_columns"</code> when a user has deleted columns.</li>
<li><code>"delete_rows"</code> when a user has deleted rows.</li>
<li><code>"move_columns"</code> when a user has dragged and dropped OR sorted columns.</li>
<li><code>"move_rows"</code> when a user has dragged and dropped OR sorted rows.</li>
<li><code>"select"</code></li>
<li><code>"resize"</code></li>
</ul>
</li>
<li>
<p>These event names would be used for <code>"&lt;&lt;SheetModified&gt;&gt;"</code> bound events for example.</p>
</li>
<li>
<p>For events <code>"begin_move_columns"</code>/<code>"begin_move_rows"</code> the point where columns/rows will be moved to will be under the <code>event_data</code> key <code>"value"</code>.</p>
</li>
<li>Key <strong><code>["sheetname"]</code></strong> is the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#initialization-options">name given to the sheet widget on initialization</a>, useful if you have multiple sheets to determine which one emitted the event.</li>
<li>Key <strong><code>["cells"]["table"]</code></strong> if any table cells have been modified by cut, paste, delete, cell editors, dropdown boxes, check boxes, undo or redo this will be a <code>dict</code> with <code>tuple</code> keys of <code>(data row index: int, data column index: int)</code> and the values will be the cell values at that location <strong>prior</strong> to the change. The <code>dict</code> will be empty if no such changes have taken place.</li>
<li>Key <strong><code>["cells"]["header"]</code></strong> if any header cells have been modified by cell editors, dropdown boxes, check boxes, undo or redo this will be a <code>dict</code> with keys of <code>int: data column index</code> and the values will be the cell values at that location <strong>prior</strong> to the change. The <code>dict</code> will be empty if no such changes have taken place.</li>
<li>Key <strong><code>["cells"]["index"]</code></strong> if any index cells have been modified by cell editors, dropdown boxes, check boxes, undo or redo this will be a <code>dict</code> with keys of <code>int: data row index</code> and the values will be the cell values at that location <strong>prior</strong> to the change. The <code>dict</code> will be empty if no such changes have taken place.</li>
<li>Key <strong><code>["moved"]["rows"]</code></strong> if any rows have been moved by dragging and dropping or undoing/redoing of dragging and dropping rows this will be a <code>dict</code> with the following keys:<ul>
<li><code>{"data": {old data index: new data index, ...}, "displayed": {old displayed index: new displayed index, ...}}</code><ul>
<li><code>"data"</code> will be a <code>dict</code> where the keys are the old data indexes of the rows and the values are the data indexes they have moved to.</li>
<li><code>"displayed"</code> will be a <code>dict</code> where the keys are the old displayed indexes of the rows and the values are the displayed indexes they have moved to.</li>
<li>If no rows have been moved the <code>dict</code> under <code>["moved"]["rows"]</code> will be empty.</li>
<li>Note that if there are hidden rows the values for <code>"data"</code> will include all currently displayed row indexes and their new locations. If required and available, the values under <code>"displayed"</code> include only the directly moved rows, convert to data indexes using <code>Sheet.data_r()</code>.</li>
</ul>
</li>
<li>For events <code>"begin_move_rows"</code> the point where rows will be moved to will be under the <code>event_data</code> key <code>"value"</code>.</li>
</ul>
</li>
<li>Key <strong><code>["moved"]["columns"]</code></strong> if any columns have been moved by dragging and dropping or undoing/redoing of dragging and dropping columns this will be a <code>dict</code> with the following keys:<ul>
<li><code>{"data": {old data index: new data index, ...}, "displayed": {old displayed index: new displayed index, ...}}</code><ul>
<li><code>"data"</code> will be a <code>dict</code> where the keys are the old data indexes of the columns and the values are the data indexes they have moved to.</li>
<li><code>"displayed"</code> will be a <code>dict</code> where the keys are the old displayed indexes of the columns and the values are the displayed indexes they have moved to.</li>
<li>If no columns have been moved the <code>dict</code> under <code>["moved"]["columns"]</code> will be empty.</li>
<li>Note that if there are hidden columns the values for <code>"data"</code> will include all currently displayed column indexes and their new locations. If required and available, the values under <code>"displayed"</code> include only the directly moved columns, convert to data indexes using <code>Sheet.data_c()</code>.</li>
</ul>
</li>
<li>For events <code>"begin_move_columns"</code> the point where columns will be moved to will be under the <code>event_data</code> key <code>"value"</code>.</li>
</ul>
</li>
<li>Key <strong><code>["added"]["rows"]</code></strong> if any rows have been added by the inbuilt popup menu insert rows or by a paste which expands the sheet then this will be a <code>dict</code> with the following keys:<ul>
<li><code>{"data_index": int, "displayed_index": int, "num": int, "displayed": []}</code><ul>
<li><code>"data_index"</code> is an <code>int</code> representing the row where the rows were added in the data.</li>
<li><code>"displayed_index"</code> is an <code>int</code> representing the displayed table index where the rows were added (which will be different from the data index if there are hidden rows).</li>
<li><code>"displayed"</code> is a copied list of the <code>Sheet()</code>s displayed rows immediately prior to the change.</li>
<li>If no rows have been added the <code>dict</code> will be empty.</li>
</ul>
</li>
</ul>
</li>
<li>Key <strong><code>["added"]["columns"]</code></strong> if any columns have been added by the inbuilt popup menu insert columns or by a paste which expands the sheet then this will be a <code>dict</code> with the following keys:<ul>
<li><code>{"data_index": int, "displayed_index": int, "num": int, "displayed": []}</code><ul>
<li><code>"data_index"</code> is an <code>int</code> representing the column where the columns were added in the data.</li>
<li><code>"displayed_index"</code> is an <code>int</code> representing the displayed table index where the columns were added (which will be different from the data index if there are hidden columns).</li>
<li><code>"displayed"</code> is a copied list of the <code>Sheet()</code>s displayed columns immediately prior to the change.</li>
<li>If no columns have been added the <code>dict</code> will be empty.</li>
</ul>
</li>
</ul>
</li>
<li>Key <strong><code>["deleted"]["columns"]</code></strong> if any columns have been deleted by the inbuilt popup menu delete columns or by undoing a paste which added columns then this will be a <code>dict</code>. This <code>dict</code> will look like the following:<ul>
<li><code>{[column data index]: {[row data index]: cell value, [row data index]: cell value}, [column data index]: {...} ...}</code></li>
<li>If no columns have been deleted then the <code>dict</code> value for <code>["deleted"]["columns"]</code> will be empty.</li>
</ul>
</li>
<li>Key <strong><code>["deleted"]["rows"]</code></strong> if any rows have been deleted by the inbuilt popup menu delete rows or by undoing a paste which added rows then this will be a <code>dict</code>. This <code>dict</code> will look like the following:<ul>
<li><code>{[row data index]: {[column data index]: cell value, [column data index]: cell value}, [row data index]: {...} ...}</code></li>
<li>If no rows have been deleted then the <code>dict</code> value for <code>["deleted"]["rows"]</code> will be empty.</li>
</ul>
</li>
<li>Key <strong><code>["deleted"]["header"]</code></strong> if any header values have been deleted by the inbuilt popup menu delete columns or by undoing a paste which added columns and header values then this will be a <code>dict</code>. This <code>dict</code> will look like the following:<ul>
<li><code>{[column data index]: header cell value, [column data index]: header cell value, ...}</code></li>
<li>If no columns have been deleted by the mentioned methods then the <code>dict</code> value for <code>["deleted"]["header"]</code> will be empty.</li>
</ul>
</li>
<li>Key <strong><code>["deleted"]["index"]</code></strong> if any index values have been deleted by the inbuilt popup menu delete rows or by undoing a paste which added rows and index values then this will be a <code>dict</code>. This <code>dict</code> will look like the following:<ul>
<li><code>{[row data index]: index cell value, [row data index]: index cell value, ...}</code></li>
<li>If no index values have been deleted by the mentioned methods then the <code>dict</code> value for <code>["deleted"]["index"]</code> will be empty.</li>
</ul>
</li>
<li>Key <strong><code>["deleted"]["column_widths"]</code></strong> if any columns have been deleted by the inbuilt popup menu delete columns or by undoing a paste which added columns then this will be a <code>dict</code>. This <code>dict</code> will look like the following:<ul>
<li><code>{[column data index]: column width, [column data index]: column width, ...}</code></li>
<li>If no columns have been deleted then the <code>dict</code> value for <code>["deleted"]["column_widths"]</code> will be empty.</li>
</ul>
</li>
<li>Key <strong><code>["deleted"]["row_heights"]</code></strong> if any rows have been deleted by the inbuilt popup menu delete rows or by undoing a paste which added rows then this will be a <code>dict</code>. This <code>dict</code> will look like the following:<ul>
<li><code>{[row data index]: row height, [row data index]: row height, ...}</code></li>
<li>If no rows have been deleted then the <code>dict</code> value for <code>["deleted"]["row_heights"]</code> will be empty.</li>
</ul>
</li>
<li>Key <strong><code>["deleted"]["displayed_columns"]</code></strong>  if any columns have been deleted by the inbuilt popup menu delete columns or by undoing a paste which added columns then this will be a <code>list</code>. This <code>list</code> stores the displayed columns (the columns that are showing when others are hidden) immediately prior to the change.</li>
<li>Key <strong><code>["deleted"]["displayed_rows"]</code></strong>  if any rows have been deleted by the inbuilt popup menu delete rows or by undoing a paste which added rows then this will be a <code>list</code>. This <code>list</code> stores the displayed rows (the rows that are showing when others are hidden) immediately prior to the change.</li>
<li>Key <strong><code>["named_spans"]</code></strong> This <code>dict</code> serves as storage for the <code>Sheet()</code>s named spans. Each value in the <code>dict</code> is a pickled <code>span</code> object.</li>
<li>Key <strong><code>["options"]</code></strong> This serves as storage for the <code>Sheet()</code>s options such as highlights, formatting, alignments, dropdown boxes, check boxes etc. It is a <code>dict</code> where the values are the sheets internal cell/row/column options <code>dicts</code>.</li>
<li>Key <strong><code>["selection_boxes"]</code></strong> the value of this is all selection boxes on the sheet in the form of a <code>dict</code> as shown below:<ul>
<li>For every event except <code>"select"</code> events the selection boxes are those immediately prior to the modification, for <code>"select"</code> events they are the current selection boxes.</li>
<li>The layout is always: <code>"selection_boxes": {(start row, start column, up to but not including row, up to but not including column): selection box type}</code>.<ul>
<li>The row/column indexes are <code>int</code>s and the selection box type is a <code>str</code> either <code>"cells"</code>, <code>"rows"</code> or <code>"columns"</code>.</li>
</ul>
</li>
<li>The <code>dict</code> will be empty if there is nothing selected.</li>
</ul>
</li>
<li>Key <strong><code>["selected"]</code></strong> the value of this when there is something selected on the sheet is a <code>namedtuple</code>. The values of which can be found <a href="https://github.com/ragardner/tksheet/wiki/Version-7#get-the-currently-selected-cell">here</a>.<ul>
<li>When nothing is selected or the event is not relevant to the currently selected box, such as a resize event it will be an empty <code>tuple</code>.</li>
</ul>
</li>
<li>Key <strong><code>["being_selected"]</code></strong> if any selection box is in the process of being drawn by holding down mouse button 1 and dragging then this will be a tuple with the following layout:<ul>
<li><code>(start row, start column, up to but not including row, up to but not including column, selection box type)</code>.<ul>
<li>The selection box type is a <code>str</code> either <code>"cells"</code>, <code>"rows"</code> or <code>"columns"</code>.</li>
</ul>
</li>
<li>If no box is in the process of being created then this will be a an empty <code>tuple</code>.</li>
<li><a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-displaying-selections">See here</a> for an example.</li>
</ul>
</li>
<li>Key <strong><code>["data"]</code></strong> - <code>dict[tuple[int, int], Any]</code> - changed from only being used by paste, now stores a <code>dict</code> of cell coordinates and values that make up a table edit event of more than one cell.</li>
<li>Key <strong><code>["key"]</code></strong> - <code>str</code> - is primarily used for cell edit events where a key press has occurred. For <code>"begin_edit..."</code> events the value is the actual key which was pressed (or <code>"??"</code> for using the mouse to open a cell). It also might be one of the following for end edit events:<ul>
<li><code>"Return"</code> - enter key.</li>
<li><code>"FocusOut"</code> - the editor or box lost focus, perhaps by mouse clicking elsewhere.</li>
<li><code>"Tab"</code> - tab key.</li>
</ul>
</li>
<li>Key <strong><code>["value"]</code></strong> is used primarily by cell editing events. For <code>"begin_edit..."</code> events it's the value displayed in he text editor when it opens. For <code>"end_edit..."</code> events it's the value in the text editor when it was closed, for example by hitting <code>Return</code>. It also used by <code>"begin_move_columns"</code>/<code>"begin_move_rows"</code> - the point where columns/rows will be moved to will be under the <code>event_data</code> key <code>"value"</code>.</li>
<li>Key <strong><code>["loc"]</code></strong> is for cell editing events to show the displayed (not data) coordinates of the event. It will be <strong>either:</strong><ul>
<li>A tuple of <code>(int displayed row index, int displayed column index)</code> in the case of editing table cells.</li>
<li>A single <code>int</code> in the case of editing index/header cells.</li>
</ul>
</li>
<li>Key <strong><code>["row"]</code></strong> is for cell editing events to show the displayed (not data) row number <code>int</code> of the event. If the event was not a cell editing event or a header cell was edited the value will be <code>None</code>.</li>
<li>Key <strong><code>["column"]</code></strong> is for cell editing events to show the displayed (not data) column number <code>int</code> of the event. If the event was not a cell editing event or an index cell was edited the value will be <code>None</code>.</li>
<li>Key <strong><code>["resized"]["rows"]</code></strong> is for row height resizing events, it will be a <code>dict</code> with the following layout:<ul>
<li><code>{int displayed row index: {"old_size": old_height, "new_size": new_height}}</code>.</li>
<li>If no rows have been resized then the value for <code>["resized"]["rows"]</code> will be an empty <code>dict</code>.</li>
</ul>
</li>
<li>Key <strong><code>["resized"]["columns"]</code></strong> is for column width resizing events, it will be a <code>dict</code> with the following layout:<ul>
<li><code>{int displayed column index: {"old_size": old_width, "new_size": new_width}}</code>.</li>
<li>If no columns have been resized then the value for <code>["resized"]["columns"]</code> will be an empty <code>dict</code>.</li>
</ul>
</li>
<li>Key <strong><code>["widget"]</code></strong> will contain the widget which emitted the event, either the <code>MainTable()</code>, <code>ColumnHeaders()</code> or <code>RowIndex()</code> which are all <code>tk.Canvas</code> widgets.</li>
</ul>
<hr />
<h4 id="validate-user-cell-edits"><strong>Validate user cell edits</strong></h4>
<p>With these functions you can validate or modify most user sheet edits, includes cut, paste, delete (including column/row clear), dropdown boxes and cell edits.</p>
<p><strong>Edit validation</strong></p>
<p>This function will be called for every cell edit in an action.</p>
<pre><code class="language-python">edit_validation(func: Callable | None = None) -&gt; Sheet
</code></pre>
<p>Parameters:
- <code>func</code> (<code>Callable</code>, <code>None</code>) must either be a function which will receive a tksheet event dict which looks like <a href="https://github.com/ragardner/tksheet/wiki/Version-7#event-data">this</a> or <code>None</code> which unbinds the function.</p>
<p>Notes:
- If your bound function returns <code>None</code> then that specific cell edit will not be performed.
- For examples of this function see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#usage-examples">here</a> and <a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-custom-right-click-and-text-editor-validation">here</a>.</p>
<p><strong>Bulk edit validation</strong></p>
<p>This function will be called at the end of an action and delay any edits until after validation.</p>
<pre><code class="language-python">bulk_table_edit_validation(func: Callable | None = None) -&gt; Sheet
</code></pre>
<p>Parameters:
- <code>func</code> (<code>Callable</code>, <code>None</code>) must either be a function which will receive a tksheet event dict which looks like <a href="https://github.com/ragardner/tksheet/wiki/Version-7#event-data">this</a> or <code>None</code> which unbinds the function.</p>
<p>Notes:
- See the below example for more information on usage.</p>
<p>Example:</p>
<pre><code class="language-python">from tksheet import Sheet
import tkinter as tk

from typing import Any


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight=1)
        self.frame.grid_rowconfigure(0, weight=1)
        self.sheet = Sheet(
            self.frame,
            data=[[f&quot;Row {r}, Column {c}&quot; for c in range(3)] for r in range(3)],
        )
        self.sheet.enable_bindings()
        self.sheet.bulk_table_edit_validation(self.validate)
        self.frame.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.grid(row=0, column=0, sticky=&quot;nswe&quot;)

    def validate(self, event: dict) -&gt; Any:
        &quot;&quot;&quot;
        Whatever keys and values are left in event[&quot;data&quot;]
        when the function returns are the edits that will be made

        An example below shows preventing edits if the proposed edit
        contains a space

        But you can also modify the values, or add more key, value
        pairs to event[&quot;data&quot;]
        &quot;&quot;&quot;
        not_valid = set()
        for (r, c), value in event.data.items():
            if &quot; &quot; in value:
                not_valid.add((r, c))
        event.data = {k: v for k, v in event.data.items() if k not in not_valid}


app = demo()
app.mainloop()
</code></pre>
<hr />
<h4 id="add-commands-to-the-in-built-right-click-popup-menu"><strong>Add commands to the in-built right click popup menu</strong></h4>
<pre><code class="language-python">popup_menu_add_command(
    label: str,
    func: Callable,
    table_menu: bool = True,
    index_menu: bool = True,
    header_menu: bool = True,
    empty_space_menu: bool = True,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="remove-commands-added-using-popup_menu_add_command-from-the-in-built-right-click-popup-menu"><strong>Remove commands added using popup_menu_add_command from the in-built right click popup menu</strong></h4>
<pre><code class="language-python">popup_menu_del_command(label: str | None = None) -&gt; Sheet
</code></pre>
<ul>
<li>If <code>label</code> is <code>None</code> then it removes all.</li>
</ul>
<hr />
<h4 id="enable-or-disable-mousewheel-left-click-etc"><strong>Enable or disable mousewheel, left click etc</strong></h4>
<pre><code class="language-python">basic_bindings(enable: bool = False) -&gt; Sheet
</code></pre>
<hr />
<p>These functions are links to the Sheets own functionality. Functions such as <code>cut()</code> rely on whatever is currently selected on the Sheet.</p>
<pre><code class="language-python">cut(event: object = None) -&gt; Sheet
copy(event: object = None) -&gt; Sheet
paste(event: object = None) -&gt; Sheet
delete(event: object = None) -&gt; Sheet
undo(event: object = None) -&gt; Sheet
redo(event: object = None) -&gt; Sheet
zoom_in() -&gt; Sheet
zoom_out() -&gt; Sheet
</code></pre>
<hr />
<h4 id="get-the-last-event-data-dict"><strong>Get the last event data dict</strong></h4>
<pre><code class="language-python">@property
def event() -&gt; EventDataDict
</code></pre>
<ul>
<li>e.g. <code>last_event_data = sheet.event</code></li>
<li>Will be empty <code>EventDataDict</code> if there is no last event.</li>
</ul>
<hr />
<h4 id="set-focus-to-the-sheet"><strong>Set focus to the Sheet</strong></h4>
<pre><code class="language-python">focus_set(
    canvas: Literal[
        &quot;table&quot;,
        &quot;header&quot;,
        &quot;row_index&quot;,
        &quot;index&quot;,
        &quot;topleft&quot;,
        &quot;top_left&quot;,
    ] = &quot;table&quot;,
) -&gt; Sheet
</code></pre>
<hr />
<h1 id="tkinter-and-tksheet-events"><strong>tkinter and tksheet Events</strong></h1>
<h3 id="sheet-bind"><strong>Sheet bind</strong></h3>
<ul>
<li>With the <code>Sheet.bind()</code> function you can bind things in the usual way you would in tkinter and they will bind to all the <code>tksheet</code> canvases.</li>
<li>There are also the following special <code>tksheet</code> events you can bind:</li>
</ul>
<table>
<thead>
<tr>
<th>Binding</th>
<th>Usable with <code>Sheet.event_generate()</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>"&lt;&lt;SheetModified&gt;&gt;"</code></td>
<td>-</td>
</tr>
<tr>
<td><code>"&lt;&lt;SheetRedrawn&gt;&gt;"</code></td>
<td>-</td>
</tr>
<tr>
<td><code>"&lt;&lt;SheetSelect&gt;&gt;"</code></td>
<td>-</td>
</tr>
<tr>
<td><code>"&lt;&lt;Copy&gt;&gt;"</code></td>
<td>X</td>
</tr>
<tr>
<td><code>"&lt;&lt;Cut&gt;&gt;"</code></td>
<td>X</td>
</tr>
<tr>
<td><code>"&lt;&lt;Paste&gt;&gt;"</code></td>
<td>X</td>
</tr>
<tr>
<td><code>"&lt;&lt;Delete&gt;&gt;"</code></td>
<td>X</td>
</tr>
<tr>
<td><code>"&lt;&lt;Undo&gt;&gt;"</code></td>
<td>X</td>
</tr>
<tr>
<td><code>"&lt;&lt;Redo&gt;&gt;"</code></td>
<td>X</td>
</tr>
<tr>
<td><code>"&lt;&lt;SelectAll&gt;&gt;"</code></td>
<td>X</td>
</tr>
</tbody>
</table>
<pre><code class="language-python">bind(
    event: str,
    func: Callable,
    add: str | None = None,
)
</code></pre>
<p>Parameters:
- <code>add</code> may or may not work for various bindings depending on whether they are already in use by <code>tksheet</code>.
- <strong>Note</strong> that while a bound event after a paste/undo/redo might have the event name <code>"edit_table"</code> it also might have added/deleted rows/columns, refer to the docs on the event data <code>dict</code> for more information.
- <code>event</code> the emitted events are:
    - <code>"&lt;&lt;SheetModified&gt;&gt;"</code> emitted whenever the sheet was modified by the end user by editing cells or adding or deleting rows/columns. The function you bind to this event must be able to receive a <code>dict</code> argument which will be the same as <a href="https://github.com/ragardner/tksheet/wiki/Version-7#event-data">the event data dict</a> but with less specific event names. The possible event names are listed below:
        - <code>"edit_table"</code> when a user has cut, paste, delete or made any cell edits including using dropdown boxes etc. in the table.
        - <code>"edit_index"</code> when a user has edited a index cell.
        - <code>"edit_header"</code> when a user has edited a header cell.
        - <code>"add_columns"</code> when a user has inserted columns.
        - <code>"add_rows"</code> when a user has inserted rows.
        - <code>"delete_columns"</code> when a user has deleted columns.
        - <code>"delete_rows"</code> when a user has deleted rows.
        - <code>"move_columns"</code> when a user has dragged and dropped columns.
        - <code>"move_rows"</code> when a user has dragged and dropped rows.
        - <code>"sort_rows"</code> when rows have been re-ordered by sorting.
        - <code>"sort_columns"</code> when columns have been re-ordered by sorting.
    - <code>"&lt;&lt;SheetRedrawn&gt;&gt;"</code> emitted whenever the sheet GUI was refreshed (redrawn). The data for this event will be different than the usual event data, it is:
        - <code>{"sheetname": name of your sheet, "header": bool True if the header was redrawn, "row_index": bool True if the index was redrawn, "table": bool True if the the table was redrawn}</code>
    - <code>"&lt;&lt;SheetSelect&gt;&gt;"</code> encompasses all select events and emits the same event as <code>"&lt;&lt;SheetModified&gt;&gt;"</code> but with the event name: <code>"select"</code>.
    - <code>"&lt;&lt;Copy&gt;&gt;"</code> emitted when a Sheet copy e.g. <code>&lt;Control-c&gt;</code> was performed and will have the <code>eventname</code> <code>"copy"</code>.
    - <code>"&lt;&lt;Cut&gt;&gt;"</code>
    - <code>"&lt;&lt;Paste&gt;&gt;"</code>
    - <code>"&lt;&lt;Delete&gt;&gt;"</code> emitted when a Sheet delete key function was performed.
    - <code>"&lt;&lt;SelectAll&gt;&gt;"</code>
    - <code>"&lt;&lt;Undo&gt;&gt;"</code>
    - <code>"&lt;&lt;Redo&gt;&gt;"</code></p>
<p>Example:</p>
<pre><code class="language-python"># self.sheet_was_modified is your function
self.sheet.bind(&quot;&lt;&lt;SheetModified&gt;&gt;&quot;, self.sheet_was_modified)
</code></pre>
<p>Example for <code>event_generate()</code>:</p>
<pre><code class="language-python">self.sheet.event_generate(&quot;&lt;&lt;Copy&gt;&gt;&quot;)
</code></pre>
<ul>
<li>Tells the sheet to run its copy function.</li>
</ul>
<hr />
<h3 id="sheet-unbind"><strong>Sheet unbind</strong></h3>
<p>With this function you can unbind things you have bound using the <code>bind()</code> function.</p>
<pre><code class="language-python">unbind(binding: str) -&gt; Sheet
</code></pre>
<hr />
<h1 id="sheet-languages-and-bindings"><strong>Sheet Languages and Bindings</strong></h1>
<p>In this section are instructions to change some of tksheets in-built language and bindings:
- The in-built right click menu.
- The in-built functionality keybindings, such as copy, paste etc.</p>
<p>Please note that due to the limitations of the Tkinter Canvas tksheet doesn’t support right-to-left (RTL) languages.</p>
<h4 id="changing-right-click-menu-labels"><strong>Changing right click menu labels</strong></h4>
<p>You can change the labels for tksheets in-built right click popup menu by using the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-options-and-other-functions"><code>set_options()</code> function</a> with any of the following keyword arguments:</p>
<pre><code class="language-python">edit_header_label
edit_header_accelerator
edit_index_label
edit_index_accelerator
edit_cell_label
edit_cell_accelerator
cut_label
cut_accelerator
cut_contents_label
cut_contents_accelerator
copy_label
copy_accelerator
copy_contents_label
copy_contents_accelerator
paste_label
paste_accelerator
delete_label
delete_accelerator
clear_contents_label
clear_contents_accelerator
delete_columns_label
delete_columns_accelerator
insert_columns_left_label
insert_columns_left_accelerator
insert_column_label
insert_column_accelerator
insert_columns_right_label
insert_columns_right_accelerator
delete_rows_label
delete_rows_accelerator
insert_rows_above_label
insert_rows_above_accelerator
insert_rows_below_label
insert_rows_below_accelerator
insert_row_label
insert_row_accelerator
select_all_label
select_all_accelerator
undo_label
undo_accelerator

sort_cells_label
sort_cells_x_label
sort_row_label
sort_column_label
sort_rows_label
sort_columns_label
sort_cells_reverse_label
sort_cells_x_reverse_label
sort_row_reverse_label
sort_column_reverse_label
sort_rows_reverse_label
sort_columns_reverse_label
sort_cells_accelerator
sort_cells_x_accelerator
sort_row_accelerator
sort_column_accelerator
sort_rows_accelerator
sort_columns_accelerator
sort_cells_reverse_accelerator
sort_cells_x_reverse_accelerator
sort_row_reverse_accelerator
sort_column_reverse_accelerator
sort_rows_reverse_accelerator
sort_columns_reverse_accelerator
</code></pre>
<p>Example:</p>
<pre><code class="language-python"># changing the copy label to the spanish for Copy
sheet.set_options(copy_label=&quot;Copiar&quot;)
</code></pre>
<h4 id="changing-key-bindings"><strong>Changing key bindings</strong></h4>
<p>You can change the bindings for tksheets in-built functionality such as cut, copy, paste by using the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-options-and-other-functions"><code>set_options()</code> function</a> with any the following keyword arguments:</p>
<pre><code class="language-python">copy_bindings
cut_bindings
paste_bindings
undo_bindings
redo_bindings
delete_bindings
select_all_bindings
select_columns_bindings
select_rows_bindings
row_start_bindings
table_start_bindings
tab_bindings
up_bindings
right_bindings
down_bindings
left_bindings
shift_up_bindings
shift_right_bindings
shift_down_bindings
shift_left_bindings
prior_bindings
next_bindings
find_bindings
find_next_bindings
find_previous_bindings
escape_bindings
toggle_replace_bindings
</code></pre>
<p>The argument must be a <code>list</code> of <strong>tkinter</strong> binding <code>str</code>s. In the below example the binding for copy is changed to <code>"&lt;Control-e&gt;"</code> and <code>"&lt;Control-E&gt;"</code>.</p>
<pre><code class="language-python"># changing the binding for copy
sheet.set_options(copy_bindings=[&quot;&lt;Control-e&gt;&quot;, &quot;&lt;Control-E&gt;&quot;])
</code></pre>
<p>The default values for these bindings can be found in the tksheet file <code>sheet_options.py</code>.</p>
<h4 id="key-bindings-for-other-languages"><strong>Key bindings for other languages</strong></h4>
<p>There is limited support in tkinter for keybindings in languages other than english, for example tkinters <code>.bind()</code> function doesn't cooperate with cyrillic characters.</p>
<p>There are ways around this however, see below for a limited example of how this might be achieved:</p>
<pre><code class="language-python">from __future__ import annotations

import tkinter as tk

from tksheet import Sheet


class demo(tk.Tk):
    def __init__(self) -&gt; None:
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.sheet = Sheet(
            parent=self,
            data=[[f&quot;{r} {c}&quot; for c in range(5)] for r in range(5)],
        )
        self.sheet.enable_bindings()
        self.sheet.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.bind_all(&quot;&lt;Key&gt;&quot;, self.any_key)

    def any_key(self, event: tk.Event) -&gt; None:
        &quot;&quot;&quot;
        Establish that the Control key is held down
        &quot;&quot;&quot;
        ctrl = (event.state &amp; 4 &gt; 0)
        if not ctrl:
            return
        &quot;&quot;&quot;
        From here you can use event.keycode and event.keysym to determine
        which key has been pressed along with Control
        &quot;&quot;&quot;
        print(event.keycode)
        print(event.keysym)
        &quot;&quot;&quot;
        If the keys are the ones you want to have bound to Sheet functionality
        You can then call the Sheets functionality using event_generate()
        For example:
        &quot;&quot;&quot;
        # if the key is correct then:
        self.sheet.event_generate(&quot;&lt;&lt;Copy&gt;&gt;&quot;)


app = demo()
app.mainloop()
</code></pre>
<hr />
<h1 id="span-objects"><strong>Span Objects</strong></h1>
<p>In <code>tksheet</code> versions &gt; <code>7</code> there are functions which utilise an object named <code>Span</code>. These objects are a subclass of <code>dict</code> but with various additions and dot notation attribute access.</p>
<p>Spans basically represent an <strong>contiguous</strong> area of the sheet. They can be <strong>one</strong> of three <strong>kinds</strong>:
- <code>"cell"</code>
- <code>"row"</code>
- <code>"column"</code></p>
<p>They can be used with some of the sheets functions such as data getting/setting and creation of things on the sheet such as dropdown boxes.</p>
<p>Spans store:
- A reference to the <code>Sheet()</code> they were created with.
- Variables which represent a particular range of cells and properties for accessing these ranges.
- Variables which represent options for those cells.
- Methods which can modify the above variables.
- Methods which can act upon the table using the above variables such as <code>highlight</code>, <code>format</code>, etc.</p>
<p>Whether cells, rows or columns are affected will depend on the spans <a href="https://github.com/ragardner/tksheet/wiki/Version-7#get-a-spans-kind"><code>kind</code></a>.</p>
<h3 id="creating-a-span"><strong>Creating a span</strong></h3>
<p>You can create a span by:</p>
<ul>
<li>Using the <code>span()</code> function e.g. <code>sheet.span("A1")</code> represents the cell <code>A1</code></li>
</ul>
<p><strong>or</strong></p>
<ul>
<li>Using square brackets on a Sheet object e.g. <code>sheet["A1"]</code> represents the cell <code>A1</code></li>
</ul>
<p>Both methods return the created span object.</p>
<pre><code class="language-python">span(
    *key: CreateSpanTypes,
    type_: str = &quot;&quot;,
    name: str = &quot;&quot;,
    table: bool = True,
    index: bool = False,
    header: bool = False,
    tdisp: bool = False,
    idisp: bool = True,
    hdisp: bool = True,
    transposed: bool = False,
    ndim: int = 0,
    convert: object = None,
    undo: bool = True,
    emit_event: bool = False,
    widget: object = None,
    expand: None | str = None,
    formatter_options: dict | None = None,
    **kwargs,
) -&gt; Span
&quot;&quot;&quot;
Create a span / get an existing span by name
Returns the created span
&quot;&quot;&quot;
</code></pre>
<p>Parameters:
- <code>key</code> you do not have to provide an argument for <code>key</code>, if no argument is provided then the span will be a full sheet span. Otherwise <code>key</code> can be the following types which are type hinted as <code>CreateSpanTypes</code>:
    - <code>None</code>
    - <code>str</code> e.g. <code>sheet.span("A1:F1")</code>
    - <code>int</code> e.g. <code>sheet.span(0)</code>
    - <code>slice</code> e.g. <code>sheet.span(slice(0, 4))</code>
    - <code>Sequence[int | None, int | None]</code> representing a cell of <code>row, column</code> e.g. <code>sheet.span(0, 0)</code>
    - <code>Sequence[Sequence[int | None, int | None], Sequence[int | None, int | None]]</code> representing <code>sheet.span(start row, start column, up to but not including row, up to but not including column)</code> e.g. <code>sheet.span(0, 0, 2, 2)</code>
    - <code>Span</code> e.g <code>sheet.span(another_span)</code>
- <code>type_</code> (<code>str</code>) must be either an empty string <code>""</code> or one of the following: <code>"format"</code>, <code>"highlight"</code>, <code>"dropdown"</code>, <code>"checkbox"</code>, <code>"readonly"</code>, <code>"align"</code>.
- <code>name</code> (<code>str</code>) used for named spans or for identification. If no name is provided then a name is generated for the span which is based on an internal integer ticker and then converted to a string in the same way column names are.
- <code>table</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the main table as well as the header/index if those are <code>True</code>.
- <code>index</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the index as well as the table/header if those are <code>True</code>.
- <code>header</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the header as well as the table/index if those are <code>True</code>.
- <code>tdisp</code> (<code>bool</code>) is used by data getting functions that utilize spans and when <code>True</code> the function retrieves screen displayed data for the table, not underlying cell data.
- <code>idisp</code> (<code>bool</code>) is used by data getting functions that utilize spans and when <code>True</code> the function retrieves screen displayed data for the index, not underlying cell data.
- <code>hdisp</code> (<code>bool</code>) is used by data getting functions that utilize spans and when <code>True</code> the function retrieves screen displayed data for the header, not underlying cell data.
- <code>transposed</code> (<code>bool</code>) is used by data getting and setting functions that utilize spans. When <code>True</code>:
    - Returned sublists from data getting functions will represent columns rather than rows.
    - Data setting functions will assume that a single sequence is a column rather than row and that a list of lists is a list of columns rather than a list of rows.
- <code>ndim</code> (<code>int</code>) is used by data getting functions that utilize spans, it must be either <code>0</code> or <code>1</code> or <code>2</code>.
    - <code>0</code> is the default setting which will make the return value vary based on what it is. For example if the gathered data is only a single cell it will return a value instead of a list of lists with a single list containing a single value. A single row will be a single list.
    - <code>1</code> will force the return of a single list as opposed to a list of lists.
    - <code>2</code> will force the return of a list of lists.
- <code>convert</code> (<code>None</code>, <code>Callable</code>) can be used to modify the data using a function before returning it. The data sent to the <code>convert</code> function will be as it was before normally returning (after <code>ndim</code> has potentially modified it).
- <code>undo</code> (<code>bool</code>) is used by data modifying functions that utilize spans. When <code>True</code> and if undo is enabled for the sheet then the end user will be able to undo/redo the modification.
- <code>emit_event</code> when <code>True</code> and when using data setting functions that utilize spans causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information on binding this event.
- <code>widget</code> (<code>object</code>) is the reference to the original sheet which created the span. This can be changed to a different sheet if required e.g. <code>my_span.widget = new_sheet</code>.
- <code>expand</code> (<code>None</code>, <code>str</code>) must be either <code>None</code> or:
    - <code>"table"</code>/<code>"both"</code> expand the span both down and right from the span start to the ends of the table.
    - <code>"right"</code> expand the span right to the end of the table <code>x</code> axis.
    - <code>"down"</code> expand the span downwards to the bottom of the table <code>y</code> axis.
- <code>formatter_options</code> (<code>dict</code>, <code>None</code>) must be either <code>None</code> or <code>dict</code>. If providing a <code>dict</code> it must be the same structure as used in format functions, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#data-formatting">here</a> for more information. Used to turn the span into a format type span which:
    - When using <code>get_data()</code> will format the returned data.
    - When using <code>set_data()</code> will format the data being set but <strong>NOT</strong> create a new formatting rule on the sheet.
- <code>**kwargs</code> you can provide additional keyword arguments to the function for example those used in <code>span.highlight()</code> or <code>span.dropdown()</code> which are used when applying a named span to a table.</p>
<p>Notes:
- To create a named span see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">here</a>.</p>
<h4 id="span-creation-syntax"><strong>Span creation syntax</strong></h4>
<p><strong>When creating a span using the below methods:</strong>
- <code>str</code>s use excel syntax and the indexing rule of up to <strong>AND</strong> including.
- <code>int</code>s use python syntax and the indexing rule of up to but <strong>NOT</strong> including.</p>
<p>For example python index <code>0</code> as in <code>[0]</code> is the first whereas excel index <code>1</code> as in <code>"A1"</code> is the first.</p>
<p>If you need to convert python indexes into column letters you can use the function <code>num2alpha</code> importable from <code>tksheet</code>:</p>
<pre><code class="language-python">from tksheet import (
    Sheet,
    num2alpha as n2a,
)

# column index five as a letter
n2a(5)
</code></pre>
<h4 id="span-creation-examples-using-square-brackets"><strong>Span creation examples using square brackets</strong></h4>
<pre><code class="language-python">&quot;&quot;&quot;
EXAMPLES USING SQUARE BRACKETS
&quot;&quot;&quot;

span = sheet[0] # first row
span = sheet[&quot;1&quot;] # first row

span = sheet[0:2] # first two rows
span = sheet[&quot;1:2&quot;] # first two rows

span = sheet[:] # entire sheet
span = sheet[&quot;:&quot;] # entire sheet

span = sheet[:2] # first two rows
span = sheet[&quot;:2&quot;] # first two rows

&quot;&quot;&quot; THESE TWO HAVE DIFFERENT OUTCOMES &quot;&quot;&quot;
span = sheet[2:] # all rows after and not inlcuding python index 1
span = sheet[&quot;2:&quot;] # all rows after and not including python index 0

span = sheet[&quot;A&quot;] # first column
span = sheet[&quot;A:C&quot;] # first three columns

&quot;&quot;&quot; SOME CELL AREA EXAMPLES &quot;&quot;&quot;
span = sheet[0, 0] # cell A1
span = sheet[(0, 0)] # cell A1
span = sheet[&quot;A1:C1&quot;] # cells A1, B1, C1
span = sheet[0, 0, 1, 3] # cells A1, B1, C1
span = sheet[(0, 0, 1, 3)] # cells A1, B1, C1
span = sheet[(0, 0), (1, 3)] # cells A1, B1, C1
span = sheet[((0, 0), (1, 3))] # cells A1, B1, C1

span = sheet[&quot;A1:2&quot;]
span = sheet[0, 0, 2, None]
&quot;&quot;&quot;
[&quot;A1:2&quot;]
All the cells starting from (0, 0)
expanding down to include row 1
but not including cells beyond row
1 and expanding out to include all
columns

    A   B   C   D
1   x   x   x   x
2   x   x   x   x
3
4
...
&quot;&quot;&quot;

span = sheet[&quot;A1:B&quot;]
span = sheet[0, 0, None, 2]
&quot;&quot;&quot;
[&quot;A1:B&quot;]
All the cells starting from (0, 0)
expanding out to include column 1
but not including cells beyond column
1 and expanding down to include all
rows

    A   B   C   D
1   x   x
2   x   x
3   x   x
4   x   x
...
&quot;&quot;&quot;

&quot;&quot;&quot; GETTING AN EXISTING NAMED SPAN &quot;&quot;&quot;
# you can retrieve an existing named span quickly by surrounding its name in &lt;&gt; e.g.
named_span_retrieval = sheet[&quot;&lt;the name of the span goes here&gt;&quot;]
</code></pre>
<h4 id="span-creation-examples-using-sheetspan"><strong>Span creation examples using sheet.span()</strong></h4>
<pre><code class="language-python">&quot;&quot;&quot;
EXAMPLES USING span()
&quot;&quot;&quot;

&quot;&quot;&quot;
USING NO ARGUMENTS
&quot;&quot;&quot;
sheet.span() # entire sheet, in this case not including header or index

&quot;&quot;&quot;
USING ONE ARGUMENT

str or int or slice()
&quot;&quot;&quot;

# with one argument you can use the same string syntax used for square bracket span creation
sheet.span(&quot;A1&quot;)
sheet.span(0) # row at python index 0, all columns
sheet.span(slice(0, 2)) # rows at python indexes 0 and 1, all columns
sheet.span(&quot;:&quot;) # entire sheet

&quot;&quot;&quot;
USING TWO ARGUMENTS
int | None, int | None

or

(int | None, int | None), (int | None, int | None)
&quot;&quot;&quot;
sheet.span(0, 0) # row 0, column 0 - the first cell
sheet.span(0, None) # row 0, all columns
sheet.span(None, 0) # column 0, all rows

sheet.span((0, 0), (1, 1)) # row 0, column 0 - the first cell
sheet.span((0, 0), (None, 2)) # rows 0 - end, columns 0 and 1

&quot;&quot;&quot;
USING FOUR ARGUMENTS
int | None, int | None, int | None, int | None
&quot;&quot;&quot;

sheet.span(0, 0, 1, 1) # row 0, column 0 - the first cell
sheet.span(0, 0, None, 2) # rows 0 - end, columns 0 and 1
</code></pre>
<h3 id="span-properties"><strong>Span properties</strong></h3>
<p>Spans have a few <code>@property</code> functions:
- <code>span.kind</code>
- <code>span.rows</code>
- <code>span.columns</code>
- <code>span.coords</code></p>
<h4 id="get-a-spans-kind"><strong>Get a spans kind</strong></h4>
<pre><code class="language-python">span.kind
</code></pre>
<ul>
<li>Returns either <code>"cell"</code>, <code>"row"</code> or <code>"column"</code>.</li>
</ul>
<pre><code class="language-python">span = sheet.span(&quot;A1:C4&quot;)
print (span.kind)
# prints &quot;cell&quot;

span = sheet.span(&quot;:&quot;)
print (span.kind)
# prints &quot;cell&quot;

span = sheet.span(&quot;1:3&quot;)
print (span.kind)
# prints &quot;row&quot;

span = sheet.span(&quot;A:C&quot;)
print (span.kind)
# prints &quot;column&quot;

# after importing num2alpha from tksheet
print (sheet[num2alpha(0)].kind)
# prints &quot;column&quot;
</code></pre>
<h4 id="get-span-rows-and-columns"><strong>Get span rows and columns</strong></h4>
<pre><code class="language-python">span.rows
span.columns
</code></pre>
<p>Returns a <code>SpanRange</code> object. The below examples are for <code>span.rows</code> but you can use <code>span.columns</code> for the spans columns exactly the same way.</p>
<pre><code class="language-python"># use as an iterator
span = sheet.span(&quot;A1:C4&quot;)
for row in span.rows:
    pass
# use as a reversed iterator
for row in reversed(span.rows):
    pass

# check row membership
span = sheet.span(&quot;A1:C4&quot;)
print (2 in span.rows)
# prints True

# check span.rows equality, also can do not equal
span = self.sheet[&quot;A1:C4&quot;]
span2 = self.sheet[&quot;1:4&quot;]
print (span.rows == span2.rows)
# prints True

# check len
span = self.sheet[&quot;A1:C4&quot;]
print (len(span.rows))
# prints 4
</code></pre>
<h3 id="span-methods"><strong>Span methods</strong></h3>
<p>Spans have the following methods, all of which return the span object itself so you can chain the functions e.g. <code>span.options(undo=True).clear().bg = "indianred1"</code></p>
<h4 id="modify-a-spans-attributes"><strong>Modify a spans attributes</strong></h4>
<pre><code class="language-python">span.options(
    type_: str | None = None,
    name: str | None = None,
    table: bool | None = None,
    index: bool | None = None,
    header: bool | None = None,
    tdisp: bool | None = None,
    idisp: bool | None  = None,
    hdisp: bool | None  = None,
    transposed: bool | None = None,
    ndim: int | None = None,
    convert: Callable | None = None,
    undo: bool | None = None,
    emit_event: bool | None = None,
    widget: object = None,
    expand: str | None = None,
    formatter_options: dict | None = None,
    **kwargs,
) -&gt; Span
</code></pre>
<p><strong>Note:</strong> that if <code>None</code> is used for any of the following parameters then that <code>Span</code>s attribute will be unchanged.
- <code>type_</code> (<code>str</code>, <code>None</code>) if not <code>None</code> then must be either an empty string <code>""</code> or one of the following: <code>"format"</code>, <code>"highlight"</code>, <code>"dropdown"</code>, <code>"checkbox"</code>, <code>"readonly"</code>, <code>"align"</code>.
- <code>name</code> (<code>str</code>, <code>None</code>) is used for named spans or for identification.
- <code>table</code> (<code>bool</code>, <code>None</code>) when <code>True</code> will make all functions used with the span target the main table as well as the header/index if those are <code>True</code>.
- <code>index</code> (<code>bool</code>, <code>None</code>) when <code>True</code> will make all functions used with the span target the index as well as the table/header if those are <code>True</code>.
- <code>header</code> (<code>bool</code>, <code>None</code>) when <code>True</code> will make all functions used with the span target the header as well as the table/index if those are <code>True</code>.
- <code>tdisp</code> (<code>bool</code>, <code>None</code>) is used by data getting functions that utilize spans and when <code>True</code> the function retrieves screen displayed data for the table, not underlying cell data.
- <code>idisp</code> (<code>bool</code>, <code>None</code>) is used by data getting functions that utilize spans and when <code>True</code> the function retrieves screen displayed data for the index, not underlying cell data.
- <code>hdisp</code> (<code>bool</code>, <code>None</code>) is used by data getting functions that utilize spans and when <code>True</code> the function retrieves screen displayed data for the header, not underlying cell data.
- <code>transposed</code> (<code>bool</code>, <code>None</code>) is used by data getting and setting functions that utilize spans. When <code>True</code>:
    - Returned sublists from data getting functions will represent columns rather than rows.
    - Data setting functions will assume that a single sequence is a column rather than row and that a list of lists is a list of columns rather than a list of rows.
- <code>ndim</code> (<code>int</code>, <code>None</code>) is used by data getting functions that utilize spans, it must be either <code>0</code> or <code>1</code> or <code>2</code>.
    - <code>0</code> is the default setting which will make the return value vary based on what it is. For example if the gathered data is only a single cell it will return a value instead of a list of lists with a single list containing a single value. A single row will be a single list.
    - <code>1</code> will force the return of a single list as opposed to a list of lists.
    - <code>2</code> will force the return of a list of lists.
- <code>convert</code> (<code>Callable</code>, <code>None</code>) can be used to modify the data using a function before returning it. The data sent to the <code>convert</code> function will be as it was before normally returning (after <code>ndim</code> has potentially modified it).
- <code>undo</code> (<code>bool</code>, <code>None</code>) is used by data modifying functions that utilize spans. When <code>True</code> and if undo is enabled for the sheet then the end user will be able to undo/redo the modification.
- <code>emit_event</code> (<code>bool</code>, <code>None</code>) is used by data modifying functions that utilize spans. When <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.
- <code>widget</code> (<code>object</code>) is the reference to the original sheet which created the span. This can be changed to a different sheet if required e.g. <code>my_span.widget = new_sheet</code>.
- <code>expand</code> (<code>str</code>, <code>None</code>) must be either <code>None</code> or:
    - <code>"table"</code>/<code>"both"</code> expand the span both down and right from the span start to the ends of the table.
    - <code>"right"</code> expand the span right to the end of the table <code>x</code> axis.
    - <code>"down"</code> expand the span downwards to the bottom of the table <code>y</code> axis.
- <code>formatter_options</code> (<code>dict</code>, <code>None</code>) must be either <code>None</code> or <code>dict</code>. If providing a <code>dict</code> it must be the same structure as used in format functions, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#data-formatting">here</a> for more information. Used to turn the span into a format type span which:
    - When using <code>get_data()</code> will format the returned data.
    - When using <code>set_data()</code> will format the data being set but <strong>NOT</strong> create a new formatting rule on the sheet.
- <code>**kwargs</code> you can provide additional keyword arguments to the function for example those used in <code>span.highlight()</code> or <code>span.dropdown()</code> which are used when applying a named span to a table.
- This function returns the span instance itself (<code>self</code>).</p>
<pre><code class="language-python"># entire sheet
span = sheet[&quot;A1&quot;].options(expand=&quot;both&quot;)

# column A
span = sheet[&quot;A1&quot;].options(expand=&quot;down&quot;)

# row 0
span = sheet[&quot;A1&quot;].options(
    expand=&quot;right&quot;,
    ndim=1, # to return a single list when getting data
)
</code></pre>
<p>All of a spans modifiable attributes are listed here:
- <code>from_r</code> (<code>int</code>) represents which row the span starts at, must be a positive <code>int</code>.
- <code>from_c</code> (<code>int</code>) represents which column the span starts at, must be a positive <code>int</code>.
- <code>upto_r</code> (<code>int</code>, <code>None</code>) represents which row the span ends at, must be a positive <code>int</code> or <code>None</code>. <code>None</code> means always up to and including the last row.
- <code>upto_c</code> (<code>int</code>, <code>None</code>) represents which column the span ends at, must be a positive <code>int</code> or <code>None</code>. <code>None</code> means always up to and including the last column.
- <code>type_</code> (<code>str</code>) must be either an empty string <code>""</code> or one of the following: <code>"format"</code>, <code>"highlight"</code>, <code>"dropdown"</code>, <code>"checkbox"</code>, <code>"readonly"</code>, <code>"align"</code>.
- <code>name</code> (<code>str</code>) used for named spans or for identification. If no name is provided then a name is generated for the span which is based on an internal integer ticker and then converted to a string in the same way column names are.
- <code>table</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the main table as well as the header/index if those are <code>True</code>.
- <code>index</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the index as well as the table/header if those are <code>True</code>.
- <code>header</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the header as well as the table/index if those are <code>True</code>.
- <code>tdisp</code> (<code>bool</code>) is used by data getting functions that utilize spans and when <code>True</code> the function retrieves screen displayed data for the table, not underlying cell data.
- <code>idisp</code> (<code>bool</code>) is used by data getting functions that utilize spans and when <code>True</code> the function retrieves screen displayed data for the index, not underlying cell data.
- <code>hdisp</code> (<code>bool</code>) is used by data getting functions that utilize spans and when <code>True</code> the function retrieves screen displayed data for the header, not underlying cell data.
- <code>transposed</code> (<code>bool</code>) is used by data getting and setting functions that utilize spans. When <code>True</code>:
    - Returned sublists from data getting functions will represent columns rather than rows.
    - Data setting functions will assume that a single sequence is a column rather than row and that a list of lists is a list of columns rather than a list of rows.
- <code>ndim</code> (<code>int</code>) is used by data getting functions that utilize spans, it must be either <code>0</code> or <code>1</code> or <code>2</code>.
    - <code>0</code> is the default setting which will make the return value vary based on what it is. For example if the gathered data is only a single cell it will return a value instead of a list of lists with a single list containing a single value. A single row will be a single list.
    - <code>1</code> will force the return of a single list as opposed to a list of lists.
    - <code>2</code> will force the return of a list of lists.
- <code>convert</code> (<code>None</code>, <code>Callable</code>) can be used to modify the data using a function before returning it. The data sent to the <code>convert</code> function will be as it was before normally returning (after <code>ndim</code> has potentially modified it).
- <code>undo</code> (<code>bool</code>) is used by data modifying functions that utilize spans. When <code>True</code> and if undo is enabled for the sheet then the end user will be able to undo/redo the modification.
- <code>emit_event</code> (<code>bool</code>) is used by data modifying functions that utilize spans. When <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.
- <code>widget</code> (<code>object</code>) is the reference to the original sheet which created the span. This can be changed to a different sheet if required e.g. <code>my_span.widget = new_sheet</code>.
- <code>kwargs</code> a <code>dict</code> containing keyword arguments relevant for functions such as <code>span.highlight()</code> or <code>span.dropdown()</code> which are used when applying a named span to a table.</p>
<p>If necessary you can also modify these attributes the same way you would an objects. e.g.</p>
<pre><code class="language-python"># span now takes in all columns, including A
span = self.sheet(&quot;A&quot;)
span.upto_c = None

# span now adds to sheets undo stack when using data modifying functions that use spans
span = self.sheet(&quot;A&quot;)
span.undo = True
</code></pre>
<h4 id="using-a-span-to-format-data"><strong>Using a span to format data</strong></h4>
<p>Formats table data, see the help on <a href="https://github.com/ragardner/tksheet/wiki/Version-7#data-formatting">formatting</a> for more information. Note that using this function also creates a format rule for the affected table cells.</p>
<pre><code class="language-python">span.format(
    formatter_options: dict = {},
    formatter_class: object = None,
    redraw: bool = True,
    **kwargs,
) -&gt; Span
</code></pre>
<p>Example:</p>
<pre><code class="language-python"># using square brackets
sheet[:].format(int_formatter())

# or instead using sheet.span()
sheet.span(&quot;:&quot;).format(int_formatter())
</code></pre>
<p>These examples show the formatting of the entire sheet (not including header and index) as <code>int</code> and creates a format rule for all currently existing cells. <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">Named spans</a> are required to create a rule for all future existing cells as well, for example those created by the end user inserting rows or columns.</p>
<h4 id="using-a-span-to-delete-data-format-rules"><strong>Using a span to delete data format rules</strong></h4>
<p>Delete any currently existing format rules for parts of the table that are covered by the span. Should not be used where there are data formatting rules created by named spans, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">Named spans</a> for more information.</p>
<pre><code class="language-python">span.del_format() -&gt; Span
</code></pre>
<p>Example:</p>
<pre><code class="language-python">span1 = sheet[2:4]
span1.format(float_formatter())
span1.del_format()
</code></pre>
<h4 id="using-a-span-to-create-highlights"><strong>Using a span to create highlights</strong></h4>
<pre><code class="language-python">span.highlight(
    bg: bool | None | str = False,
    fg: bool | None | str = False,
    end: bool | None = None,
    overwrite: bool = False,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<p>There are two ways to create highlights using a span:</p>
<p>Method 1 example using <code>.highlight()</code>:</p>
<pre><code class="language-python"># highlights column A background red, text color black
sheet[&quot;A&quot;].highlight(bg=&quot;red&quot;, fg=&quot;black&quot;)

# the same but after having saved a span
my_span = sheet[&quot;A&quot;]
my_span.highlight(bg=&quot;red&quot;, fg=&quot;black&quot;)
</code></pre>
<p>Method 2 example using <code>.bg</code>/<code>.fg</code>:</p>
<pre><code class="language-python"># highlights column A background red, text color black
sheet[&quot;A&quot;].bg = &quot;red&quot;
sheet[&quot;A&quot;].fg = &quot;black&quot;

# the same but after having saved a span
my_span = sheet[&quot;A&quot;]
my_span.bg = &quot;red&quot;
my_span.fg = &quot;black&quot;
</code></pre>
<h4 id="using-a-span-to-delete-highlights"><strong>Using a span to delete highlights</strong></h4>
<p>Delete any currently existing highlights for parts of the sheet that are covered by the span. Should not be used where there are highlights created by named spans, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">Named spans</a> for more information.</p>
<pre><code class="language-python">span.dehighlight() -&gt; Span
</code></pre>
<p>Example:</p>
<pre><code class="language-python">span1 = sheet[2:4].highlight(bg=&quot;red&quot;, fg=&quot;black&quot;)
span1.dehighlight()
</code></pre>
<h4 id="using-a-span-to-create-dropdown-boxes"><strong>Using a span to create dropdown boxes</strong></h4>
<p>Creates dropdown boxes for parts of the sheet that are covered by the span. For more information see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#dropdown-boxes">here</a>.</p>
<pre><code class="language-python">span.dropdown(
    values: list = [],
    set_value: object = None,
    state: Literal[&quot;normal&quot;, &quot;readonly&quot;, &quot;disabled&quot;] = &quot;normal&quot;,
    redraw: bool = True,
    selection_function: Callable | None = None,
    modified_function: Callable | None = None,
    search_function: Callable = dropdown_search_function,
    validate_input: bool = True,
    text: None | str = None,
) -&gt; Span
</code></pre>
<p>Example:</p>
<pre><code class="language-python">sheet[&quot;D&quot;].dropdown(
    values=[&quot;on&quot;, &quot;off&quot;],
    set_value=&quot;off&quot;,
)
</code></pre>
<h4 id="using-a-span-to-delete-dropdown-boxes"><strong>Using a span to delete dropdown boxes</strong></h4>
<p>Delete dropdown boxes for parts of the sheet that are covered by the span. Should not be used where there are dropdown box rules created by named spans, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">Named spans</a> for more information.</p>
<pre><code class="language-python">span.del_dropdown() -&gt; Span
</code></pre>
<p>Example:</p>
<pre><code class="language-python">dropdown_span = sheet[&quot;D&quot;].dropdown(values=[&quot;on&quot;, &quot;off&quot;],
                                    set_value=&quot;off&quot;)
dropdown_span.del_dropdown()
</code></pre>
<h4 id="using-a-span-to-create-check-boxes"><strong>Using a span to create check boxes</strong></h4>
<p>Create check boxes for parts of the sheet that are covered by the span.</p>
<pre><code class="language-python">span.checkbox(
    edit_data: bool = True,
    checked: bool | None = None,
    state: Literal[&quot;normal&quot;, &quot;disabled&quot;] = &quot;normal&quot;,
    redraw: bool = True,
    check_function: Callable | None = None,
    text: str = &quot;&quot;,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>edit_data</code> when <code>True</code> edits the underlying cell data to either <code>checked</code> if <code>checked</code> is a <code>bool</code> or tries to convert the existing cell data to a <code>bool</code>.
- <code>checked</code> is the initial creation value to set the box to, if <code>None</code> then and <code>edit_data</code> is <code>True</code> then it will try to convert the underlying cell data to a <code>bool</code>.
- <code>state</code> can be <code>"normal"</code> or <code>"disabled"</code>. If <code>"disabled"</code> then color will be same as table grid lines, else it will be the cells text color.
- <code>check_function</code> can be used to trigger a function when the user clicks a checkbox.
- <code>text</code> displays text next to the checkbox in the cell, but will not be used as data, data will either be <code>True</code> or <code>False</code>.</p>
<p>Notes:
- To get the current checkbox value either:
    - Get the cell data, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#getting-sheet-data">here</a>.
    - Use the parameter <code>check_function</code> with a function of your own creation to be called when the checkbox is set by the user.</p>
<p>Example:</p>
<pre><code class="language-python">sheet[&quot;D&quot;].checkbox(
    checked=True,
    text=&quot;Switch&quot;,
)
</code></pre>
<h4 id="using-a-span-to-delete-check-boxes"><strong>Using a span to delete check boxes</strong></h4>
<p>Delete check boxes for parts of the sheet that are covered by the span. Should not be used where there are check box rules created by named spans, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">Named spans</a> for more information.</p>
<pre><code class="language-python">span.del_checkbox() -&gt; Span
</code></pre>
<p>Example:</p>
<pre><code class="language-python">checkbox_span = sheet[&quot;D&quot;].checkbox(checked=True,
                                    text=&quot;Switch&quot;)
checkbox_span.del_checkbox()
</code></pre>
<h4 id="using-a-span-to-set-cells-to-read-only"><strong>Using a span to set cells to read only</strong></h4>
<p>Create a readonly rule for parts of the table that are covered by the span.</p>
<pre><code class="language-python">span.readonly(readonly: bool = True) -&gt; Span
</code></pre>
<ul>
<li>Using <code>span.readonly(False)</code> deletes any existing readonly rules for the span. Should not be used where there are readonly rules created by named spans, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">Named spans</a> for more information.</li>
</ul>
<h4 id="using-a-span-to-create-text-alignment-rules"><strong>Using a span to create text alignment rules</strong></h4>
<p>Create a text alignment rule for parts of the sheet that are covered by the span.</p>
<pre><code class="language-python">span.align(
    align: str | None,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<ul>
<li><code>align</code> (<code>str</code>, <code>None</code>) must be either:<ul>
<li><code>None</code> - clears the alignment rule</li>
<li><code>"c"</code>, <code>"center"</code>, <code>"centre"</code></li>
<li><code>"w"</code>, <code>"west"</code>, <code>"left"</code></li>
<li><code>"e"</code>, <code>"east"</code>, <code>"right"</code></li>
</ul>
</li>
</ul>
<p>Example:</p>
<pre><code class="language-python">sheet[&quot;D&quot;].align(&quot;right&quot;)
</code></pre>
<p>There are two ways to create alignment rules using a span:</p>
<p>Method 1 example using <code>.align()</code>:</p>
<pre><code class="language-python"># column D right text alignment
sheet[&quot;D&quot;].align(&quot;right&quot;)

# the same but after having saved a span
my_span = sheet[&quot;D&quot;]
my_span.align(&quot;right&quot;)
</code></pre>
<p>Method 2 example using <code>.align =</code>:</p>
<pre><code class="language-python"># column D right text alignment
sheet[&quot;D&quot;].align = &quot;right&quot;

# the same but after having saved a span
my_span = sheet[&quot;D&quot;]
my_span.align = &quot;right&quot;
</code></pre>
<h4 id="using-a-span-to-delete-text-alignment-rules"><strong>Using a span to delete text alignment rules</strong></h4>
<p>Delete text alignment rules for parts of the sheet that are covered by the span. Should not be used where there are alignment rules created by named spans, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">Named spans</a> for more information.</p>
<pre><code class="language-python">span.del_align() -&gt; Span
</code></pre>
<p>Example:</p>
<pre><code class="language-python">align_span = sheet[&quot;D&quot;].align(&quot;right&quot;)
align_span.del_align()
</code></pre>
<h4 id="using-a-span-to-clear-cells"><strong>Using a span to clear cells</strong></h4>
<p>Clear cell data from all cells that are covered by the span.</p>
<pre><code class="language-python">span.clear(
    undo: bool | None = None,
    emit_event: bool | None = None,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>undo</code> (<code>bool</code>, <code>None</code>) When <code>True</code> if undo is enabled for the end user they will be able to undo the clear change.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<p>Example:</p>
<pre><code class="language-python"># clears column D
sheet[&quot;D&quot;].clear()
</code></pre>
<h4 id="using-a-span-to-tag-cells"><strong>Using a span to tag cells</strong></h4>
<p>Tag cells, rows or columns depending on the spans kind, more information on tags <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tags">here</a>.</p>
<pre><code class="language-python">tag(*tags) -&gt; Span
</code></pre>
<p>Notes:
- If <code>span.kind</code> is <code>"cell"</code> then cells will be tagged, if it's a row span then rows will be and so for columns.</p>
<p>Example:</p>
<pre><code class="language-python"># tags rows 2, 3, 4 with &quot;hello world&quot;
sheet[2:5].tag(&quot;hello world&quot;)
</code></pre>
<h4 id="using-a-span-to-untag-cells"><strong>Using a span to untag cells</strong></h4>
<p>Remove <strong>all</strong> tags from cells, rows or columns depending on the spans kind, more information on tags <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tags">here</a>.</p>
<pre><code class="language-python">untag() -&gt; Span
</code></pre>
<p>Notes:
- If <code>span.kind</code> is <code>"cell"</code> then cells will be untagged, if it's a row span then rows will be and so for columns.</p>
<p>Example:</p>
<pre><code class="language-python"># tags rows 2, 3, 4 with &quot;hello&quot; and &quot;bye&quot;
sheet[2:5].tag(&quot;hello&quot;, &quot;bye&quot;)

# removes both &quot;hello&quot; and &quot;bye&quot; tags from rows 2, 3, 4
sheet[2:5].untag()
</code></pre>
<h4 id="set-the-spans-orientation"><strong>Set the spans orientation</strong></h4>
<p>The attribute <code>span.transposed</code> (<code>bool</code>) is used by data getting and setting functions that utilize spans. When <code>True</code>:
    - Returned sublists from data getting functions will represent columns rather than rows.
    - Data setting functions will assume that a single sequence is a column rather than row and that a list of lists is a list of columns rather than a list of rows.</p>
<p>You can toggle the transpotition of the span by using:</p>
<pre><code class="language-python">span.transpose() -&gt; Span
</code></pre>
<p>If the attribute is already <code>True</code> this makes it <code>False</code> and vice versa.</p>
<pre><code class="language-python">span = sheet[&quot;A:D&quot;].transpose()
# this span is now transposed
print (span.transposed)
# prints True

span.transpose()
# this span is no longer transposed
print (span.transposed)
# prints False
</code></pre>
<h4 id="expand-the-spans-area"><strong>Expand the spans area</strong></h4>
<p>Expand the spans area either all the way to the right (x axis) or all the way down (y axis) or both.</p>
<pre><code class="language-python">span.expand(direction: str = &quot;both&quot;) -&gt; Span
</code></pre>
<ul>
<li><code>direction</code> (<code>None</code>, <code>str</code>) must be either <code>None</code> or:<ul>
<li><code>"table"</code>/<code>"both"</code> expand the span both down and right from the span start to the ends of the table.</li>
<li><code>"right"</code> expand the span right to the end of the table x axis.</li>
<li><code>"down"</code> expand the span downwards to the bottom of the table y axis.</li>
</ul>
</li>
</ul>
<hr />
<h1 id="named-spans"><strong>Named Spans</strong></h1>
<p>Named spans are like spans but with a type, some keyword arguments saved in <code>span.kwargs</code> and then created by using a <code>Sheet()</code> function. Like spans, named spans are also <strong>contiguous</strong> areas of the sheet.</p>
<p>Named spans can be used to:
- Create options (rules) for the sheet which will expand/contract when new cells are added/removed. For example if a user were to insert rows in the middle of some already highlighted rows:
    - With ordinary row highlights the newly inserted rows would <strong>NOT</strong> be highlighted.
    - With named span row highlights the newly inserted rows would also be highlighted.
- Quickly delete an existing option from the table whereas an ordinary span would not keep track of where the options have been moved.</p>
<p><strong>Note</strong> that generally when a user moves rows/columns around the dimensions of the named span essentially move with either end of the span:
- The new start of the span will be wherever the start row/column moves.
- The new end of the span will be wherever the end row/column moves.
The exceptions to this rule are when a span is expanded or has been created with <code>None</code>s or the start of <code>0</code> and no end or end of <code>None</code>.</p>
<p>For the end user, when a span is just a single row/column (and is not expanded/unlimited) it cannot be expanded but it can be deleted if the row/column is deleted.</p>
<h4 id="creating-a-named-span"><strong>Creating a named span</strong></h4>
<p>For a span to become a named span it needs:
- One of the following <code>type_</code>s: <code>"format"</code>, <code>"highlight"</code>, <code>"dropdown"</code>, <code>"checkbox"</code>, <code>"readonly"</code>, <code>"align"</code>.
- Relevant keyword arguments e.g. if the <code>type_</code> is <code>"highlight"</code> then arguments for <code>sheet.highlight()</code> found <a href="https://github.com/ragardner/tksheet/wiki/Version-7#highlighting-cells">here</a>.</p>
<p>After a span has the above items the following function has to be used to make it a named span and create the options on the sheet:</p>
<pre><code class="language-python">named_span(span: Span)
&quot;&quot;&quot;
Adds a named span to the sheet
Returns the span
&quot;&quot;&quot;
</code></pre>
<ul>
<li><code>span</code> must be an existing span with:<ul>
<li>a <code>name</code> (a <code>name</code> is automatically generated upon span creation if one is not provided).</li>
<li>a <code>type_</code> as described above.</li>
<li>keyword arguments as described above.</li>
</ul>
</li>
</ul>
<p>Examples of creating named spans:</p>
<pre><code class="language-python"># Will highlight rows 3 up to and including 5
span1 = self.sheet.span(
    &quot;3:5&quot;,
    type_=&quot;highlight&quot;,
    bg=&quot;green&quot;,
    fg=&quot;black&quot;,
)
self.sheet.named_span(span1)

#  Will always keep the entire sheet formatted as `int` no matter how many rows/columns are inserted
span2 = self.sheet.span(
    &quot;:&quot;,
    # you don't have to provide a `type_` when using the `formatter_kwargs` argument
    formatter_options=int_formatter(),
)
self.sheet.named_span(span2)
</code></pre>
<h4 id="deleting-a-named-span"><strong>Deleting a named span</strong></h4>
<pre><code class="language-python">del_named_span(name: str)
</code></pre>
<p>Example, creating and deleting a span:</p>
<pre><code class="language-python"># span covers the entire sheet
self.sheet.named_span(
    self.sheet.span(
        name=&quot;my highlight span&quot;,
        type_=&quot;highlight&quot;,
        bg=&quot;dark green&quot;,
        fg=&quot;#FFFFFF&quot;,
    )
)
self.sheet.del_named_span(&quot;my highlight span&quot;)

# ValueError is raised if name does not exist
self.sheet.del_named_span(&quot;this name doesnt exist&quot;)
# ValueError: Span 'this name doesnt exist' does not exist.
</code></pre>
<h4 id="other-named-span-functions"><strong>Other named span functions</strong></h4>
<p>Sets the <code>Sheet</code>s internal dict of named spans:</p>
<pre><code class="language-python">set_named_spans(named_spans: None | dict = None) -&gt; Sheet
</code></pre>
<ul>
<li>Using <code>None</code> deletes all existing named spans</li>
</ul>
<p>Get an existing named span:</p>
<pre><code class="language-python">get_named_span(name: str) -&gt; dict
</code></pre>
<p>Get all existing named spans:</p>
<pre><code class="language-python">get_named_spans() -&gt; dict
</code></pre>
<hr />
<h1 id="getting-sheet-data"><strong>Getting Sheet Data</strong></h1>
<h4 id="using-a-span-to-get-sheet-data"><strong>Using a span to get sheet data</strong></h4>
<p>A <code>Span</code> object (more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#span-objects">here</a>) is returned when using square brackets on a <code>Sheet</code> like so:</p>
<pre><code class="language-python">span = self.sheet[&quot;A1&quot;]
</code></pre>
<p>You can also use <code>sheet.span()</code>:</p>
<pre><code class="language-python">span = self.sheet.span(&quot;A1&quot;)
</code></pre>
<p>The above spans represent the cell <code>A1</code> - row 0, column 0.</p>
<p>A reserved span attribute named <code>data</code> can then be used to retrieve the data for cell <code>A1</code>, example below:</p>
<pre><code class="language-python">span = self.sheet[&quot;A1&quot;]
cell_a1_data = span.data
</code></pre>
<p>The data that is retrieved entirely depends on the area the span represents. You can also use <code>span.value</code> to the same effect.</p>
<p>There are certain other span attributes which have an impact on the data returned, explained below:
- <code>table</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the main table as well as the header/index if those are <code>True</code>.
- <code>index</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the index as well as the table/header if those are <code>True</code>.
- <code>header</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the header as well as the table/index if those are <code>True</code>.
- <code>tdisp</code> (<code>bool</code>) when <code>True</code> the function retrieves screen displayed data for the table, not underlying cell data.
- <code>idisp</code> (<code>bool</code>) when <code>True</code> the function retrieves screen displayed data for the index, not underlying cell data.
- <code>hdisp</code> (<code>bool</code>) when <code>True</code> the function retrieves screen displayed data for the header, not underlying cell data.
- <code>transposed</code> (<code>bool</code>) is used by data getting and setting functions that utilize spans. When <code>True</code>:
    - Returned sublists from <strong>data getting</strong> functions will represent columns rather than rows.
    - Data setting functions will assume that a single sequence is a column rather than row and that a list of lists is a list of columns rather than a list of rows.
- <code>ndim</code> (<code>int</code>) is used by data getting functions that utilize spans, it must be either <code>0</code> or <code>1</code> or <code>2</code>.
    - <code>0</code> is the default setting which will make the return value vary based on what it is. For example if the gathered data is only a single cell it will return a value instead of a list of lists with a single list containing a single value. A single row will be a single list.
    - <code>1</code> will force the return of a single list as opposed to a list of lists.
    - <code>2</code> will force the return of a list of lists.
- <code>convert</code> (<code>None</code>, <code>Callable</code>) can be used to modify the data using a function before returning it. The data sent to the <code>convert</code> function will be as it was before normally returning (after <code>ndim</code> has potentially modified it).
- <code>widget</code> (<code>object</code>) is the reference to the original sheet which created the span (this is the widget that data is retrieved from). This can be changed to a different sheet if required e.g. <code>my_span.widget = new_sheet</code>.</p>
<p>Some more complex examples of data retrieval:</p>
<pre><code class="language-python">&quot;single cell&quot;
cell_a1_data = self.sheet[&quot;A1&quot;].data

&quot;entire sheet including headers and index&quot;
entire_sheet_data = self.sheet[&quot;A1&quot;].expand().options(header=True, index=True).data

&quot;header data, no table or index data&quot;
# a list of displayed header cells
header_data = self.sheet[&quot;A:C&quot;].options(table=False, header=True).data

# a header value
header_data = self.sheet[&quot;A&quot;].options(table=False, hdisp=False, header=True).data

&quot;index data, no table or header data&quot;
# a list of displayed index cells
index_data = self.sheet[:3].options(table=False, index=True).data

# or using sheet.span() a list of displayed index cells
index_data = self.sheet.span(slice(None, 3), table=False, index=True).data

# a row index value
index_data = self.sheet[3].options(table=False, idisp=False, index=True).data

&quot;sheet data as columns instead of rows, with actual header data&quot;
sheet_data = self.sheet[:].transpose().options(hdisp=False, header=True).data

# or instead using sheet.span() with only kwargs
sheet_data = self.sheet.span(transposed=True, hdisp=False, header=True).data
</code></pre>
<p>There is also a <code>Sheet()</code> function for data retrieval (it is used internally by the above data getting methods):</p>
<pre><code class="language-python">sheet.get_data(
    *key: CreateSpanTypes,
) -&gt; object
</code></pre>
<p>Examples:</p>
<pre><code class="language-python">data = self.sheet.get_data(&quot;A1&quot;)
data = self.sheet.get_data(0, 0, 3, 3)
data = self.sheet.get_data(
    self.sheet.span(&quot;:D&quot;, transposed=True)
)
</code></pre>
<h4 id="get-a-single-cells-data"><strong>Get a single cells data</strong></h4>
<p>This is a higher performance method to get a single cells data which may be useful for example when performing a very large number of single cell data retrievals in a loop.</p>
<pre><code class="language-python">get_cell_data(r: int, c: int, get_displayed: bool = False) -&gt; object
</code></pre>
<ul>
<li><code>get_displayed</code> (<code>bool</code>) when <code>True</code> retrieves the value that is displayed to the user in the sheet, not the underlying data.</li>
</ul>
<hr />
<h4 id="generate-sheet-rows-one-at-a-time"><strong>Generate sheet rows one at a time</strong></h4>
<p>This function is useful if you need a lot of sheet data, and produces one row at a time (may save memory use in certain scenarios). It does not use spans.</p>
<pre><code class="language-python">yield_sheet_rows(
    get_displayed: bool = False,
    get_header: bool = False,
    get_index: bool = False,
    get_index_displayed: bool = True,
    get_header_displayed: bool = True,
    only_rows: int | Iterator[int] | None = None,
    only_columns: int | Iterator[int] | None = None,
) -&gt; Iterator[list[object]]
</code></pre>
<p>Parameters:
- <code>get_displayed</code> (<code>bool</code>) if <code>True</code> it will return cell values as they are displayed on the screen. If <code>False</code> it will return any underlying data, for example if the cell is formatted.
- <code>get_header</code> (<code>bool</code>) if <code>True</code> it will return the header of the sheet even if there is not one.
- <code>get_index</code> (<code>bool</code>) if <code>True</code> it will return the index of the sheet even if there is not one.
- <code>get_index_displayed</code> (<code>bool</code>) if <code>True</code> it will return whatever index values are displayed on the screen, for example if there is a dropdown box with <code>text</code> set.
- <code>get_header_displayed</code> (<code>bool</code>) if <code>True</code> it will return whatever header values are displayed on the screen, for example if there is a dropdown box with <code>text</code> set.
- <code>only_rows</code> (<code>None</code>, <code>iterable</code>) with this argument you can supply an iterable of <code>int</code> row indexes in any order to be the only rows that are returned.
- <code>only_columns</code> (<code>None</code>, <code>iterable</code>) with this argument you can supply an iterable of <code>int</code> column indexes in any order to be the only columns that are returned.</p>
<hr />
<h4 id="get-table-data-readonly"><strong>Get table data, readonly</strong></h4>
<pre><code class="language-python">@property
data()
</code></pre>
<ul>
<li>e.g. <code>self.sheet.data</code></li>
<li>Doesn't include header or index data.</li>
</ul>
<hr />
<h4 id="the-name-of-the-actual-internal-sheet-data-variable"><strong>The name of the actual internal sheet data variable</strong></h4>
<pre><code class="language-python">.MT.data
</code></pre>
<ul>
<li>You can use this to directly modify or retrieve the main table's data e.g. <code>cell_0_0 = my_sheet_name_here.MT.data[0][0]</code> but only do so if you know what you're doing.</li>
</ul>
<hr />
<h4 id="sheet-methods"><strong>Sheet methods</strong></h4>
<p><code>Sheet</code> objects also have some functions similar to lists. <strong>Note</strong> that these functions do <strong>not</strong> include the header or index.</p>
<p>Iterate over table rows:</p>
<pre><code class="language-python">for row in self.sheet:
    print (row)

# and in reverse
for row in reversed(self.sheet):
    print (row)
</code></pre>
<p>Check if the table has a particular value (membership):</p>
<pre><code class="language-python"># returns True or False
search_value = &quot;the cell value I'm looking for&quot;
print (search_value in self.sheet)
</code></pre>
<ul>
<li>Can also check if a row is in the sheet if a <code>list</code> is used.</li>
</ul>
<hr />
<h4 id="get-the-number-of-rows-in-the-sheet"><strong>Get the number of rows in the sheet</strong></h4>
<pre><code class="language-python">get_total_rows(include_index: bool = False) -&gt; int
</code></pre>
<hr />
<h4 id="get-the-number-of-columns-in-the-sheet"><strong>Get the number of columns in the sheet</strong></h4>
<pre><code class="language-python">get_total_columns(include_header: bool = False) -&gt; int
</code></pre>
<hr />
<h4 id="get-a-value-for-a-particular-cell-if-that-cell-was-empty"><strong>Get a value for a particular cell if that cell was empty</strong></h4>
<pre><code class="language-python">get_value_for_empty_cell(
    r: int,
    c: int,
    r_ops: bool = True,
    c_ops: bool = True,
) -&gt; object
</code></pre>
<ul>
<li><code>r_ops</code>/<code>c_ops</code> when both are <code>True</code> it will take into account whatever cell/row/column options exist. When just <code>r_ops</code> is <code>True</code> it will take into account row options only and when just <code>c_ops</code> is <code>True</code> it will take into account column options only.</li>
</ul>
<hr />
<h1 id="setting-sheet-data"><strong>Setting Sheet Data</strong></h1>
<p>Fundamentally, there are two ways to set table data:
- Overwriting the entire table and setting the table data to a new object.
- Modifying the existing data.</p>
<h4 id="overwriting-the-table"><strong>Overwriting the table</strong></h4>
<pre><code class="language-python">set_sheet_data(
    data: list | tuple | None = None,
    reset_col_positions: bool = True,
    reset_row_positions: bool = True,
    redraw: bool = True,
    verify: bool = False,
    reset_highlights: bool = False,
    keep_formatting: bool = True,
    delete_options: bool = False,
) -&gt; object
</code></pre>
<p>Parameters:
- <code>data</code> (<code>list</code>) has to be a list of lists for full functionality, for display only a list of tuples or a tuple of tuples will work.
- <code>reset_col_positions</code> and <code>reset_row_positions</code> (<code>bool</code>) when <code>True</code> will reset column widths and row heights.
- <code>redraw</code> (<code>bool</code>) refreshes the table after setting new data.
- <code>verify</code> (<code>bool</code>) goes through <code>data</code> and checks if it is a list of lists, will raise error if not, disabled by default.
- <code>reset_highlights</code> (<code>bool</code>) resets all table cell highlights.
- <code>keep_formatting</code> (<code>bool</code>) when <code>True</code> re-applies any prior formatting rules to the new data, if <code>False</code> all prior formatting rules are deleted.
- <code>delete_options</code> (<code>bool</code>) when <code>True</code> all table options such as dropdowns, check boxes, formatting, highlighting etc. are deleted.</p>
<p>Notes:
- This function does not impact the sheet header or index.</p>
<hr />
<pre><code class="language-python">@data.setter
data(value: object)
</code></pre>
<p>Notes:
- Acts like setting an attribute e.g. <code>sheet.data = [[1, 2, 3], [4, 5, 6]]</code>
- Uses the <code>set_sheet_data()</code> function and its default arguments.</p>
<hr />
<h4 id="reset-all-or-specific-sheet-elements-and-attributes"><strong>Reset all or specific sheet elements and attributes</strong></h4>
<pre><code class="language-python">reset(
    table: bool = True,
    header: bool = True,
    index: bool = True,
    row_heights: bool = True,
    column_widths: bool = True,
    cell_options: bool = True,
    undo_stack: bool = True,
    selections: bool = True,
    sheet_options: bool = False,
    redraw: bool = True,
) -&gt; Sheet
</code></pre>
<p>Parameters:
- <code>table</code> when <code>True</code> resets the table to an empty list.
- <code>header</code> when <code>True</code> resets the header to an empty list.
- <code>index</code> when <code>True</code> resets the row index to an empty list.
- <code>row_heights</code> when <code>True</code> deletes all displayed row lines.
- <code>column_widths</code> when <code>True</code> deletes all displayed column lines.
- <code>cell_options</code> when <code>True</code> deletes all dropdowns, checkboxes, highlights, data formatting, etc.
- <code>undo_stack</code> when <code>True</code> resets the sheets undo stack to empty.
- <code>selections</code> when <code>True</code> deletes all selection boxes.
- <code>sheet_options</code> when <code>True</code> resets all the sheets options such as colors, font, popup menu labels and many more to default, for a full list of what's reset see the file <code>sheet_options.py</code>.</p>
<p>Notes:
- This function could be useful when a whole new sheet needs to be loaded.</p>
<hr />
<h4 id="modifying-sheet-data"><strong>Modifying sheet data</strong></h4>
<p>A <code>Span</code> object (more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#span-objects">here</a>) is returned when using square brackets on a <code>Sheet</code> like so:</p>
<pre><code class="language-python">span = self.sheet[&quot;A1&quot;]
</code></pre>
<p>You can also use <code>sheet.span()</code>:</p>
<pre><code class="language-python">span = self.sheet.span(&quot;A1&quot;)
</code></pre>
<p>The above span example represents the cell <code>A1</code> - row 0, column 0. A reserved span attribute named <code>data</code> (you can also use <code>.value</code>) can then be used to modify sheet data <strong>starting</strong> from cell <code>A1</code>. example below:</p>
<pre><code class="language-python">span = self.sheet[&quot;A1&quot;]
span.data = &quot;new value for cell A1&quot;

# or even shorter:
self.sheet[&quot;A1&quot;].data = &quot;new value for cell A1&quot;

# or with sheet.span()
self.sheet.span(&quot;A1&quot;).data = &quot;new value for cell A1&quot;
</code></pre>
<p>If you provide a list or tuple it will set more than one cell, starting from the spans start cell. In the example below three cells are set in the first row, <strong>starting from cell B1</strong>:</p>
<pre><code class="language-python">self.sheet[&quot;B1&quot;].data = [&quot;row 0, column 1 new value (B1)&quot;,
                         &quot;row 0, column 2 new value (C1)&quot;,
                         &quot;row 0, column 3 new value (D1)&quot;]
</code></pre>
<p>You can set data in column orientation with a transposed span:</p>
<pre><code class="language-python">self.sheet[&quot;B1&quot;].transpose().data = [&quot;row 0, column 1 new value (B1)&quot;,
                                     &quot;row 1, column 1 new value (B2)&quot;,
                                     &quot;row 2, column 1 new value (B3)&quot;]
</code></pre>
<p>When setting data only a spans start cell is taken into account, the end cell is ignored. The example below demonstrates this, the spans end - <code>"B1"</code> is ignored and 4 cells get new values:</p>
<pre><code class="language-python">self.sheet[&quot;A1:B1&quot;].data = [&quot;A1 new val&quot;, &quot;B1 new val&quot;, &quot;C1 new val&quot;, &quot;D1 new val&quot;]
</code></pre>
<p>These are the span attributes which have an impact on the data set:
- <code>table</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the main table as well as the header/index if those are <code>True</code>.
- <code>index</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the index as well as the table/header if those are <code>True</code>.
- <code>header</code> (<code>bool</code>) when <code>True</code> will make all functions used with the span target the header as well as the table/index if those are <code>True</code>.
- <code>transposed</code> (<code>bool</code>) is used by data getting and setting functions that utilize spans. When <code>True</code>:
    - Returned sublists from data getting functions will represent columns rather than rows.
    - <strong>Data setting</strong> functions will assume that a single sequence is a column rather than row and that a list of lists is a list of columns rather than a list of rows.
- <code>widget</code> (<code>object</code>) is the reference to the original sheet which created the span (this is the widget that data is set to). This can be changed to a different sheet if required e.g. <code>my_span.widget = new_sheet</code>.</p>
<p>Some more complex examples of setting data:</p>
<pre><code class="language-python">&quot;&quot;&quot;
SETTING ROW DATA
&quot;&quot;&quot;
# first row gets some new values and the index gets a new value also
self.sheet[0].options(index=True).data = [&quot;index val&quot;, &quot;row 0 col 0&quot;, &quot;row 0 col 1&quot;, &quot;row 0 col 2&quot;]

# or instead using sheet.span() first row gets some new values and the index gets a new value also
self.sheet.span(0, index=True).data = [&quot;index val&quot;, &quot;row 0 col 0&quot;, &quot;row 0 col 1&quot;, &quot;row 0 col 2&quot;]

# first two rows get some new values, index included
self.sheet[0].options(index=True).data = [[&quot;index 0&quot;, &quot;row 0 col 0&quot;, &quot;row 0 col 1&quot;, &quot;row 0 col 2&quot;],
                                          [&quot;index 1&quot;, &quot;row 1 col 0&quot;, &quot;row 1 col 1&quot;, &quot;row 1 col 2&quot;]]

&quot;&quot;&quot;
SETTING COLUMN DATA
&quot;&quot;&quot;
# first column gets some new values and the header gets a new value also
self.sheet[&quot;A&quot;].options(transposed=True, header=True).data = [&quot;header val&quot;, &quot;row 0 col 0&quot;, &quot;row 1 col 0&quot;, &quot;row 2 col 0&quot;]

# or instead using sheet.span() first column gets some new values and the header gets a new value also
self.sheet.span(&quot;A&quot;, transposed=True, header=True).data = [&quot;header val&quot;, &quot;row 0 col 0&quot;, &quot;row 1 col 0&quot;, &quot;row 2 col 0&quot;]

# first two columns get some new values, header included
self.sheet[&quot;A&quot;].options(transposed=True, header=True).data = [[&quot;header 0&quot;, &quot;row 0 col 0&quot;, &quot;row 1 col 0&quot;, &quot;row 2 col 0&quot;],
                                                              [&quot;header 1&quot;, &quot;row 0 col 1&quot;, &quot;row 1 col 1&quot;, &quot;row 2 col 1&quot;]]

&quot;&quot;&quot;
SETTING CELL AREA DATA
&quot;&quot;&quot;
# cells B2, C2, B3, C3 get new values
self.sheet[&quot;B2&quot;].data = [[&quot;B2 new val&quot;, &quot;C2 new val&quot;],
                         [&quot;B3 new val&quot;, &quot;C3 new val&quot;]]

# or instead using sheet.span() cells B2, C2, B3, C3 get new values
self.sheet.span(&quot;B2&quot;).data = [[&quot;B2 new val&quot;, &quot;C2 new val&quot;],
                              [&quot;B3 new val&quot;, &quot;C3 new val&quot;]]

&quot;&quot;&quot;
SETTING CELL AREA DATA INCLUDING HEADER AND INDEX
&quot;&quot;&quot;
self.sheet_span = self.sheet.span(
    header=True,
    index=True,
    hdisp=False,
    idisp=False,
)

# set data for the span which was created above
self.sheet_span.data = [[&quot;&quot;,  &quot;A&quot;,  &quot;B&quot;,  &quot;C&quot;]
                        [&quot;1&quot;, &quot;A1&quot;, &quot;B1&quot;, &quot;C1&quot;],
                        [&quot;2&quot;, &quot;A2&quot;, &quot;B2&quot;, &quot;C2&quot;]]
</code></pre>
<h4 id="sheet-set-data-function"><strong>Sheet set data function</strong></h4>
<p>You can also use the <code>Sheet</code> function <code>set_data()</code>.</p>
<pre><code class="language-python">set_data(
    *key: CreateSpanTypes,
    data: object = None,
    undo: bool | None = None,
    emit_event: bool | None = None,
    redraw: bool = True,
    event_data: EventDataDict | None = None,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<p>Example:</p>
<pre><code class="language-python">self.sheet.set_data(
    &quot;A1&quot;,
    [[&quot;&quot;,  &quot;A&quot;,  &quot;B&quot;,  &quot;C&quot;]
     [&quot;1&quot;, &quot;A1&quot;, &quot;B1&quot;, &quot;C1&quot;],
     [&quot;2&quot;, &quot;A2&quot;, &quot;B2&quot;, &quot;C2&quot;]],
)
</code></pre>
<p>You can clear cells/rows/columns using a <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-clear-cells">spans <code>clear()</code> function</a> or the Sheets <code>clear()</code> function. Below is the Sheets clear function:</p>
<pre><code class="language-python">clear(
    *key: CreateSpanTypes,
    undo: bool | None = None,
    emit_event: bool | None = None,
    redraw: bool = True,
) -&gt; EventDataDict
</code></pre>
<ul>
<li><code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.</li>
<li><code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</li>
</ul>
<h4 id="insert-a-row-into-the-sheet"><strong>Insert a row into the sheet</strong></h4>
<pre><code class="language-python">insert_row(
    row: list[object] | tuple[object] | None = None,
    idx: str | int | None = None,
    height: int | None = None,
    row_index: bool = False,
    fill: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    redraw: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- Leaving <code>row</code> as <code>None</code> inserts an empty row, e.g. <code>insert_row()</code> will append an empty row to the sheet.
- <code>height</code> is the new rows displayed height in pixels, leave as <code>None</code> for default.
- <code>row_index</code> when <code>True</code> assumes there is a row index value at the start of the row.
- <code>fill</code> when <code>True</code> any provided rows that are shorter than the Sheets longest row will be filled with empty values up to the length of the longest row.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<hr />
<h4 id="insert-a-column-into-the-sheet"><strong>Insert a column into the sheet</strong></h4>
<pre><code class="language-python">insert_column(
    column: list[object] | tuple[object] | None = None,
    idx: str | int | None = None,
    width: int | None = None,
    header: bool = False,
    fill: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    redraw: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- Leaving <code>column</code> as <code>None</code> inserts an empty column, e.g. <code>insert_column()</code> will append an empty column to the sheet.
- <code>width</code> is the new columns displayed width in pixels, leave as <code>None</code> for default.
- <code>header</code> when <code>True</code> assumes there is a header value at the start of the column.
- <code>fill</code> when <code>True</code> any provided columns that are shorter than the Sheets longest column will be filled with empty values up to the length of the longest column.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<hr />
<h4 id="insert-multiple-columns-into-the-sheet"><strong>Insert multiple columns into the sheet</strong></h4>
<pre><code class="language-python">insert_columns(
    columns: list[tuple[object] | list[object]] | tuple[tuple[object] | list[object]] | int = 1,
    idx: str | int | None = None,
    widths: list[int] | tuple[int] | None = None,
    headers: bool = False,
    fill: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    create_selections: bool = True,
    add_row_heights: bool = True,
    push_ops: bool = True,
    redraw: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>columns</code> if <code>int</code> will insert that number of blank columns.
- <code>idx</code> (<code>str</code>, <code>int</code>, <code>None</code>) either <code>str</code> e.g. <code>"A"</code> for <code>0</code>, <code>int</code> or <code>None</code> for end.
- <code>widths</code> are the new columns displayed widths in pixels, leave as <code>None</code> for default.
- <code>headers</code> when <code>True</code> assumes there are headers values at the start of each column.
- <code>fill</code> when <code>True</code> any provided columns that are shorter than the Sheets longest column will be filled with empty values up to the length of the longest column.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.
- <code>create_selections</code> when <code>True</code> creates a selection box for the newly inserted columns.
- <code>add_row_heights</code> when <code>True</code> creates rows if there are no pre-existing rows.
- <code>push_ops</code> when <code>True</code> increases the indexes of all cell/column options such as dropdown boxes, highlights and data formatting.</p>
<hr />
<h4 id="insert-multiple-rows-into-the-sheet"><strong>Insert multiple rows into the sheet</strong></h4>
<pre><code class="language-python">insert_rows(
    rows: list[tuple[object] | list[object]] | tuple[tuple[object] | list[object]] | int = 1,
    idx: str | int | None = None,
    heights: list[int] | tuple[int] | None = None,
    row_index: bool = False,
    fill: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    create_selections: bool = True,
    add_column_widths: bool = True,
    push_ops: bool = True,
    tree: bool = True,
    redraw: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>rows</code> if <code>int</code> will insert that number of blank rows.
- <code>idx</code> (<code>str</code>, <code>int</code>, <code>None</code>) either <code>str</code> e.g. <code>"A"</code> for <code>0</code>, <code>int</code> or <code>None</code> for end.
- <code>heights</code> are the new rows displayed heights in pixels, leave as <code>None</code> for default.
- <code>row_index</code> when <code>True</code> assumes there are row index values at the start of each row.
- <code>fill</code> when <code>True</code> any provided rows that are shorter than the Sheets longest row will be filled with empty values up to the length of the longest row.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.
- <code>create_selections</code> when <code>True</code> creates a selection box for the newly inserted rows.
- <code>add_column_widths</code> when <code>True</code> creates columns if there are no pre-existing columns.
- <code>push_ops</code> when <code>True</code> increases the indexes of all cell/row options such as dropdown boxes, highlights and data formatting.
- <code>tree</code> is mainly used internally but when <code>True</code> and also when treeview mode is enabled it performs the necessary actions to create new ids and add them to the tree.</p>
<hr />
<h4 id="delete-a-row-from-the-sheet"><strong>Delete a row from the sheet</strong></h4>
<pre><code class="language-python">del_row(
    idx: int = 0,
    data_indexes: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    redraw: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>idx</code> is the row to delete.
- <code>data_indexes</code> only applicable when there are hidden rows. When <code>False</code> it makes the <code>idx</code> represent a displayed row and not the underlying Sheet data row. When <code>True</code> the index represent a data index.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<hr />
<h4 id="delete-multiple-rows-from-the-sheet"><strong>Delete multiple rows from the sheet</strong></h4>
<pre><code class="language-python">del_rows(
    rows: int | Iterator[int],
    data_indexes: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    redraw: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>rows</code> can be either <code>int</code> or an iterable of <code>int</code>s representing row indexes.
- <code>data_indexes</code> only applicable when there are hidden rows. When <code>False</code> it makes the <code>rows</code> indexes represent displayed rows and not the underlying Sheet data rows. When <code>True</code> the indexes represent data indexes.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<hr />
<h4 id="delete-a-column-from-the-sheet"><strong>Delete a column from the sheet</strong></h4>
<pre><code class="language-python">del_column(
    idx: int = 0,
    data_indexes: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    redraw: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>idx</code> is the column to delete.
- <code>data_indexes</code> only applicable when there are hidden columns. When <code>False</code> it makes the <code>idx</code> represent a displayed column and not the underlying Sheet data column. When <code>True</code> the index represent a data index.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<hr />
<h4 id="delete-multiple-columns-from-the-sheet"><strong>Delete multiple columns from the sheet</strong></h4>
<pre><code class="language-python">del_columns(
    columns: int | Iterator[int],
    data_indexes: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    redraw: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>columns</code> can be either <code>int</code> or an iterable of <code>int</code>s representing column indexes.
- <code>data_indexes</code> only applicable when there are hidden columns. When <code>False</code> it makes the <code>columns</code> indexes represent displayed columns and not the underlying Sheet data columns. When <code>True</code> the indexes represent data indexes.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<hr />
<p>Expands or contracts the sheet <strong>data</strong> dimensions.</p>
<pre><code class="language-python">sheet_data_dimensions(
    total_rows: int | None = None,
    total_columns: int | None = None,
) -&gt; Sheet
</code></pre>
<p>Parameters:
- <code>total_rows</code> sets the Sheets number of data rows.
- <code>total_columns</code> sets the Sheets number of data columns.</p>
<hr />
<pre><code class="language-python">set_sheet_data_and_display_dimensions(
    total_rows: int | None = None,
    total_columns: int | None = None,
) -&gt; Sheet
</code></pre>
<p>Parameters:
- <code>total_rows</code> when <code>int</code> will set the number of the Sheets data and display rows by deleting or adding rows.
- <code>total_columns</code> when <code>int</code> will set the number of the Sheets data and display columns by deleting or adding columns.</p>
<hr />
<pre><code class="language-python">total_rows(
    number: int | None = None,
    mod_positions: bool = True,
    mod_data: bool = True,
) -&gt; int | Sheet
</code></pre>
<p>Parameters:
- <code>number</code> sets the Sheets number of data rows. When <code>None</code> function will return the Sheets number of data rows including the number of rows in the index.
- <code>mod_positions</code> when <code>True</code> also sets the number of displayed rows.
- <code>mod_data</code> when <code>True</code> also sets the number of data rows.</p>
<hr />
<pre><code class="language-python">total_columns(
    number: int | None = None,
    mod_positions: bool = True,
    mod_data: bool = True,
) -&gt; int | Sheet
</code></pre>
<p>Parameters:
- <code>number</code> sets the Sheets number of data columns. When <code>None</code> function will return the Sheets number of data columns including the number of columns in the header.
- <code>mod_positions</code> when <code>True</code> also sets the number of displayed columns.
- <code>mod_data</code> when <code>True</code> also sets the number of data columns.</p>
<hr />
<h4 id="move-a-single-row-to-a-new-location"><strong>Move a single row to a new location</strong></h4>
<pre><code class="language-python">move_row(
    row: int,
    moveto: int,
) -&gt; tuple[dict, dict, dict]
</code></pre>
<ul>
<li>Note that <code>row</code> and <code>moveto</code> indexes represent displayed indexes and not data. When there are hidden rows this is an important distinction, otherwise it is not at all important. To specifically use data indexes use the function <code>move_rows()</code>.</li>
</ul>
<hr />
<h4 id="move-a-single-column-to-a-new-location"><strong>Move a single column to a new location</strong></h4>
<pre><code class="language-python">move_column(
    column: int,
    moveto: int,
) -&gt; tuple[dict[int, int], dict[int, int], EventDataDict]:
</code></pre>
<ul>
<li>Note that <code>column</code> and <code>moveto</code> indexes represent displayed indexes and not data. When there are hidden columns this is an important distinction, otherwise it is not at all important. To specifically use data indexes use the function <code>move_columns()</code>.</li>
</ul>
<hr />
<h4 id="move-any-rows-to-a-new-location"><strong>Move any rows to a new location</strong></h4>
<pre><code class="language-python">move_rows(
    move_to: int | None = None,
    to_move: list[int] | None = None,
    move_data: bool = True,
    data_indexes: bool = False,
    create_selections: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    move_heights: bool = True,
    event_data: EventDataDict | None = None,
    redraw: bool = True,
) -&gt; tuple[dict[int, int], dict[int, int], EventDataDict]:
</code></pre>
<p>Parameters:
- <code>move_to</code> is the new start index for the rows to be moved to.
- <code>to_move</code> is a <code>list</code> of row indexes to move to that new position, they will appear in the same order provided.
- <code>move_data</code> when <code>True</code> moves not just the displayed row positions but the Sheet data as well.
- <code>data_indexes</code> is only applicable when there are hidden rows. When <code>False</code> it makes the <code>move_to</code> and <code>to_move</code> indexes represent displayed rows and not the underlying Sheet data rows. When <code>True</code> the indexes represent data indexes.
- <code>create_selections</code> creates new selection boxes based on where the rows have moved.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.
- <code>move_heights</code> when <code>True</code> also moves the displayed row lines.</p>
<p>Notes:
- The rows in <code>to_move</code> do <strong>not</strong> have to be contiguous.</p>
<hr />
<h4 id="move-any-columns-to-a-new-location"><strong>Move any columns to a new location</strong></h4>
<pre><code class="language-python">move_columns(
    move_to: int | None = None,
    to_move: list[int] | None = None,
    move_data: bool = True,
    data_indexes: bool = False,
    create_selections: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    move_widths: bool = True,
    event_data: EventDataDict | None = None,
    redraw: bool = True,
) -&gt; tuple[dict[int, int], dict[int, int], EventDataDict]:
</code></pre>
<p>Parameters:
- <code>move_to</code> is the new start index for the columns to be moved to.
- <code>to_move</code> is a <code>list</code> of column indexes to move to that new position, they will appear in the same order provided.
- <code>move_data</code> when <code>True</code> moves not just the displayed column positions but the Sheet data as well.
- <code>data_indexes</code> is only applicable when there are hidden columns. When <code>False</code> it makes the <code>move_to</code> and <code>to_move</code> indexes represent displayed columns and not the underlying Sheet data columns. When <code>True</code> the indexes represent data indexes.
- <code>create_selections</code> creates new selection boxes based on where the columns have moved.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.
- <code>move_widths</code> when <code>True</code> also moves the displayed column lines.</p>
<p>Notes:
- The columns in <code>to_move</code> do <strong>not</strong> have to be contiguous.</p>
<hr />
<h4 id="move-any-columns-to-new-locations"><strong>Move any columns to new locations</strong></h4>
<pre><code class="language-python">mapping_move_columns(
    data_new_idxs: dict[int, int],
    disp_new_idxs: None | dict[int, int] = None,
    move_data: bool = True,
    create_selections: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    redraw: bool = True,
) -&gt; tuple[dict[int, int], dict[int, int], EventDataDict]
</code></pre>
<p>Parameters:
- <code>data_new_idxs</code> (<code>dict[int, int]</code>) must be a <code>dict</code> where the keys are the data columns to move as <code>int</code>s and the values are their new locations as <code>int</code>s.
- <code>disp_new_idxs</code> (<code>None | dict[int, int]</code>) either <code>None</code> or a <code>dict</code> where the keys are the displayed columns (basically the column widths) to move as <code>int</code>s and the values are their new locations as <code>int</code>s. If <code>None</code> then no column widths will be moved.
- <code>move_data</code> when <code>True</code> moves not just the displayed column positions but the Sheet data as well.
- <code>create_selections</code> creates new selection boxes based on where the columns have moved.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<hr />
<p>Get a mapping (<code>dict</code>) of all <code>old: new</code> column indexes.</p>
<pre><code class="language-python">full_move_columns_idxs(data_idxs: dict[int, int]) -&gt; dict[int, int]
</code></pre>
<ul>
<li>e.g. converts <code>{0: 1}</code> to <code>{0: 1, 1: 0}</code> if the maximum Sheet column number is <code>1</code>.</li>
</ul>
<hr />
<h4 id="move-any-rows-to-new-locations"><strong>Move any rows to new locations</strong></h4>
<pre><code class="language-python">mapping_move_rows(
    data_new_idxs: dict[int, int],
    disp_new_idxs: None | dict[int, int] = None,
    move_data: bool = True,
    create_selections: bool = True,
    undo: bool = True,
    emit_event: bool = False,
    redraw: bool = True,
) -&gt; tuple[dict[int, int], dict[int, int], EventDataDict]
</code></pre>
<p>Parameters:
- <code>data_new_idxs</code> (<code>dict[int, int]</code>) must be a <code>dict</code> where the keys are the data rows to move as <code>int</code>s and the values are their new locations as <code>int</code>s.
- <code>disp_new_idxs</code> (<code>None | dict[int, int]</code>) either <code>None</code> or a <code>dict</code> where the keys are the displayed rows (basically the row heights) to move as <code>int</code>s and the values are their new locations as <code>int</code>s. If <code>None</code> then no row heights will be moved.
- <code>move_data</code> when <code>True</code> moves not just the displayed row positions but the Sheet data as well.
- <code>create_selections</code> creates new selection boxes based on where the rows have moved.
- <code>undo</code> when <code>True</code> adds the change to the Sheets undo stack.
- <code>emit_event</code> when <code>True</code> causes a <code>"&lt;&lt;SheetModified&gt;&gt;</code> event to occur if it has been bound, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#tkinter-and-tksheet-events">here</a> for more information.</p>
<hr />
<p>Get a mapping (<code>dict</code>) of all <code>old: new</code> row indexes.</p>
<pre><code class="language-python">full_move_rows_idxs(data_idxs: dict[int, int]) -&gt; dict[int, int]
</code></pre>
<ul>
<li>e.g. converts <code>{0: 1}</code> to <code>{0: 1, 1: 0}</code> if the maximum Sheet row number is <code>1</code>.</li>
</ul>
<hr />
<h4 id="make-all-data-rows-the-same-length"><strong>Make all data rows the same length</strong></h4>
<pre><code class="language-python">equalize_data_row_lengths(include_header: bool = True) -&gt; int
</code></pre>
<ul>
<li>Makes every list in the table have the same number of elements, goes by longest list. This will only affect the data variable, not visible columns.</li>
<li>Returns the new row length for all rows in the Sheet.</li>
</ul>
<hr />
<h1 id="sorting-the-table"><strong>Sorting the Table</strong></h1>
<p>There are three built-in sorting keys to choose from but you can always create your own and use that instead. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#setting-the-default-sorting-key">here</a> for more information on how to set the default sorting key.</p>
<h4 id="natural_sort_key"><strong>natural_sort_key</strong></h4>
<p>This is the <strong>default</strong> sorting key for natural sorting of various Python types:
- Won't sort string version numbers.
- Will convert strings to floats.
- Will sort strings that are file paths.</p>
<p>Order:
0. None
1. Empty strings
2. bool
3. int, float (inc. strings that are numbers)
4. datetime (inc. strings that are dates)
5. strings (including string file paths and paths as POSIX strings) &amp; unknown objects with <strong>str</strong>
6. unknown objects</p>
<h4 id="version_sort_key"><strong>version_sort_key</strong></h4>
<p>An alternative sorting key that respects and sorts most version numbers:
- Won't convert strings to floats.
- Will sort string version numbers.
- Will sort strings that are file paths.</p>
<ol>
<li>None</li>
<li>Empty strings</li>
<li>bool</li>
<li>int, float</li>
<li>datetime (inc. strings that are dates)</li>
<li>strings (including string file paths and paths as POSIX strings) &amp; unknown objects with <strong>str</strong></li>
<li>unknown objects</li>
</ol>
<h4 id="fast_sort_key"><strong>fast_sort_key</strong></h4>
<p>A faster key for natural sorting of various Python types. This key should probably be used if you intend on sorting sheets with over a million cells:
- Won't sort strings that are dates very well.
- Won't convert strings to floats.
- Won't sort string file paths very well.
- Will do ok with string version numbers.</p>
<ol>
<li>None</li>
<li>Empty strings</li>
<li>bool</li>
<li>int, float</li>
<li>datetime</li>
<li>strings (including paths as POSIX strings) &amp; unknown objects with <strong>str</strong></li>
<li>unknown objects</li>
</ol>
<h4 id="setting-the-default-sorting-key"><strong>Setting the default sorting key</strong></h4>
<p>Setting the sorting key at initialization:</p>
<pre><code class="language-python">from tksheet import Sheet, natural_sort_key

my_sheet = Sheet(parent=parent, sort_key=natural_sort_key)
</code></pre>
<p>Setting the sorting key after initialization:</p>
<pre><code class="language-python">from tksheet import Sheet, natural_sort_key

my_sheet.set_options(sort_key=natural_sort_key)
</code></pre>
<p>Using a sorting key with a tksheet sort function call:</p>
<pre><code class="language-python">from tksheet import Sheet, natural_sort_key

my_sheet.sort_columns(0, key=natural_sort_key)
</code></pre>
<ul>
<li>Setting the key like this will, for this call, override whatever key was set at initialization or using <code>set_options()</code>.</li>
</ul>
<h4 id="notes-about-sorting"><strong>Notes about sorting</strong></h4>
<ul>
<li>The readonly functions can be used to disallow sorting of particular cells/rows/columns values.</li>
</ul>
<h4 id="sorting-cells"><strong>Sorting cells</strong></h4>
<pre><code class="language-python">sort(
    *box: CreateSpanTypes,
    reverse: bool = False,
    row_wise: bool = False,
    validation: bool = True,
    key: Callable | None = None,
    undo: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>boxes</code> (<code>CreateSpanTypes</code>).
- <code>reverse</code> (<code>bool</code>) if <code>True</code> sorts in reverse (descending) order.
- <code>row-wise</code> (<code>bool</code>) if <code>True</code> sorts values row-wise. Default is column-wise.
- <code>key</code> (<code>Callable</code>, <code>None</code>) if <code>None</code> then uses the default sorting key.
- <code>undo</code> (<code>bool</code>) if <code>True</code> then adds the change (if a change was made) to the undo stack.</p>
<p>Notes:
- Sort the values of the box columns, or the values of the box rows if <code>row_wise</code> is <code>True</code>.
- <strong>Will not shift cell options (properties) around, only cell values.</strong>
- The event name in <code>EventDataDict</code> for sorting table values is <code>"edit_table"</code>.
- The readonly functions can be used to disallow sorting of particular cells values.</p>
<p>Example:</p>
<pre><code class="language-python"># a box of cells row-wise
# start at row 0 &amp; col 0, up to but not including row 10 &amp; col 10
my_sheet.sort(0, 0, 10, 10, row_wise=True)

# sort the whole table
my_sheet.sort(None)
</code></pre>
<h4 id="sorting-row-values"><strong>Sorting row values</strong></h4>
<pre><code class="language-python">def sort_rows(
    rows: AnyIter[int] | Span | int | None = None,
    reverse: bool = False,
    validation: bool = True,
    key: Callable | None = None,
    undo: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>rows</code> (<code>AnyIter[int]</code> , <code>Span</code>, <code>int</code>, <code>None</code>) the rows to sort.
- <code>reverse</code> (<code>bool</code>) if <code>True</code> then sorts in reverse (descending) order.
- <code>key</code> (<code>Callable</code>, <code>None</code>) if <code>None</code> then uses the default sorting key.
- <code>undo</code> (<code>bool</code>) if <code>True</code> then adds the change (if a change was made) to the undo stack.</p>
<p>Notes:
- Sorts the values of each row independently.
- <strong>Will not shift cell options (properties) around, only cell values.</strong>
- The event name in <code>EventDataDict</code> for sorting table values is <code>"edit_table"</code>.
- The readonly functions can be used to disallow sorting of particular rows values.</p>
<h4 id="sorting-column-values"><strong>Sorting column values</strong></h4>
<pre><code class="language-python">def sort_columns(
    columns: AnyIter[int] | Span | int | None = None,
    reverse: bool = False,
    validation: bool = True,
    key: Callable | None = None,
    undo: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>columns</code> (<code>AnyIter[int]</code> , <code>Span</code>, <code>int</code>, <code>None</code>) the columns to sort.
- <code>reverse</code> (<code>bool</code>) if <code>True</code> then sorts in reverse (descending) order.
- <code>key</code> (<code>Callable</code>, <code>None</code>) if <code>None</code> then uses the default sorting key.
- <code>undo</code> (<code>bool</code>) if <code>True</code> then adds the change (if a change was made) to the undo stack.</p>
<p>Notes:
- Sorts the values of each column independently.
- <strong>Will not shift cell options (properties) around, only cell values.</strong>
- The event name in <code>EventDataDict</code> for sorting table values is <code>"edit_table"</code>.
- The readonly functions can be used to disallow sorting of particular columns values.</p>
<h4 id="sorting-the-order-of-all-rows-using-a-column"><strong>Sorting the order of all rows using a column</strong></h4>
<pre><code class="language-python">def sort_rows_by_column(
    column: int | None = None,
    reverse: bool = False,
    key: Callable | None = None,
    undo: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>column</code> (<code>int</code>, <code>None</code>) if <code>None</code> then it uses the currently selected column to sort.
- <code>reverse</code> (<code>bool</code>) if <code>True</code> then sorts in reverse (descending) order.
- <code>key</code> (<code>Callable</code>, <code>None</code>) if <code>None</code> then uses the default sorting key.
- <code>undo</code> (<code>bool</code>) if <code>True</code> then adds the change (if a change was made) to the undo stack.</p>
<p>Notes:
- Sorts the tree if treeview mode is active.</p>
<h4 id="sorting-the-order-of-all-columns-using-a-row"><strong>Sorting the order of all columns using a row</strong></h4>
<pre><code class="language-python">def sort_columns_by_row(
    row: int | None = None,
    reverse: bool = False,
    key: Callable | None = None,
    undo: bool = True,
) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>row</code> (<code>int</code>, <code>None</code>) if <code>None</code> then it uses the currently selected row to sort.
- <code>reverse</code> (<code>bool</code>) if <code>True</code> then sorts in reverse (descending) order.
- <code>key</code> (<code>Callable</code>, <code>None</code>) if <code>None</code> then uses the default sorting key.
- <code>undo</code> (<code>bool</code>) if <code>True</code> then adds the change (if a change was made) to the undo stack.</p>
<hr />
<h1 id="find-and-replace"><strong>Find and Replace</strong></h1>
<p>An in-built find and replace window can be enabled using <code>enable_bindings()</code>, e.g:</p>
<pre><code class="language-python">my_sheet.enable_bindings(&quot;find&quot;, &quot;replace&quot;)

# all bindings, including find and replace
my_sheet.enable_bindings()
</code></pre>
<p>See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#enable-table-functionality-and-bindings">enable_bindings</a> for more information.</p>
<p>There are also some <code>Sheet()</code> functions that can be utilized, shown below.</p>
<h4 id="check-if-the-find-window-is-open"><strong>Check if the find window is open</strong></h4>
<pre><code class="language-python">@property
find_open() -&gt; bool
</code></pre>
<p>e.g. <code>find_is_open = sheet.find_open</code></p>
<h4 id="open-or-close-the-find-window"><strong>Open or close the find window</strong></h4>
<pre><code class="language-python">open_find(focus: bool = False) -&gt; Sheet
</code></pre>
<pre><code class="language-python">close_find() -&gt; Sheet
</code></pre>
<h4 id="find-and-select"><strong>Find and select</strong></h4>
<pre><code class="language-python">next_match(within: bool | None = None, find: str | None = None) -&gt; Sheet
</code></pre>
<pre><code class="language-python">prev_match(within: bool | None = None, find: str | None = None) -&gt; Sheet
</code></pre>
<p>Parameters:
- <code>within</code> (<code>bool</code>, <code>None</code>) if <code>bool</code> then will override the find windows within selection setting. If <code>None</code> then it will use the find windows setting.
- <code>find</code> (<code>str</code>, <code>None</code>) if <code>str</code> then will override the find windows search value. If <code>None</code> then it will use the find windows search value.</p>
<p>Notes:
- If looking within selection then hidden rows and columns will be skipped.</p>
<h4 id="replace-all-using-mapping"><strong>Replace all using mapping</strong></h4>
<pre><code class="language-python">replace_all(mapping: dict[str, str], within: bool = False) -&gt; EventDataDict
</code></pre>
<p>Parameters:
- <code>mapping</code> (<code>dict[str, str]</code>) a <code>dict</code> of keys to search for and values to replace them with.
- <code>within</code> (<code>bool</code>) when <code>True</code> will only do replaces inside existing selection boxes.</p>
<p>Notes:
- Will do partial cell data replaces also.
- If looking within selection then hidden rows and columns will be skipped.</p>
<hr />
<h1 id="highlighting-cells"><strong>Highlighting Cells</strong></h1>
<h3 id="creating-highlights"><strong>Creating highlights</strong></h3>
<h4 id="using-spans-to-create-highlights"><strong>Using spans to create highlights</strong></h4>
<p><code>Span</code> objects (more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#span-objects">here</a>) can be used to highlight cells, rows, columns, the entire sheet, headers and the index.</p>
<p>You can use either of the following methods:
- Using a span method e.g. <code>span.highlight()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-create-highlights">here</a>.
- Using a sheet method e.g. <code>sheet.highlight(Span)</code></p>
<p>Or if you need user inserted row/columns in the middle of highlight areas to also be highlighted you can use named spans, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">here</a>.</p>
<p>Whether cells, rows or columns are highlighted depends on the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#get-a-spans-kind"><code>kind</code></a> of span.</p>
<pre><code class="language-python">highlight(
    *key: CreateSpanTypes,
    bg: bool | None | str = False,
    fg: bool | None | str = False,
    end: bool | None = None,
    overwrite: bool = False,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.
- <code>bg</code> and <code>fg</code> arguments use either a tkinter color or a hex <code>str</code> color.
- <code>end</code> (<code>bool</code>) is used for row highlighting where <code>True</code> makes the highlight go to the end of the Sheet window on the x axis.
- <code>overwrite</code> (<code>bool</code>) when <code>True</code> overwrites the any previous highlight for that cell/row/column, whereas <code>False</code> will only impact the keyword arguments used.
- Highlighting cells, rows or columns will also change the colors of dropdown boxes and check boxes.</p>
<p>Example:</p>
<pre><code class="language-python"># highlight cell - row 3, column 5
self.sheet.highlight(
    (3, 5),
    bg=&quot;dark green&quot;,
    fg=&quot;white&quot;,
)

# or

# same cells, background red, text color black
sheet[3, 5].bg = &quot;red&quot;
sheet[3, 5].fg = &quot;black&quot;
</code></pre>
<h4 id="other-ways-to-create-highlights"><strong>Other ways to create highlights</strong></h4>
<p><strong>Cells</strong></p>
<pre><code class="language-python">highlight_cells(
    row: int | Literal[&quot;all&quot;] = 0,
    column: int | Literal[&quot;all&quot;] = 0,
    cells: list[tuple[int, int]] = [],
    canvas: Literal[&quot;table&quot;, &quot;index&quot;, &quot;header&quot;] = &quot;table&quot;,
    bg: bool | None | str = False,
    fg: bool | None | str = False,
    redraw: bool = True,
    overwrite: bool = True,
) -&gt; Sheet
</code></pre>
<p><strong>Rows</strong></p>
<pre><code class="language-python">highlight_rows(
    rows: Iterator[int] | int,
    bg: None | str = None,
    fg: None | str = None,
    highlight_index: bool = True,
    redraw: bool = True,
    end_of_screen: bool = False,
    overwrite: bool = True,
) -&gt; Sheet
</code></pre>
<p><strong>Columns</strong></p>
<pre><code class="language-python">highlight_columns(
    columns: Iterator[int] | int,
    bg: bool | None | str = False,
    fg: bool | None | str = False,
    highlight_header: bool = True,
    redraw: bool = True,
    overwrite: bool = True,
) -&gt; Sheet
</code></pre>
<hr />
<h3 id="deleting-highlights"><strong>Deleting highlights</strong></h3>
<h4 id="using-spans-to-delete-highlights"><strong>Using spans to delete highlights</strong></h4>
<p>If the highlights were created by a named span then the named span must be deleted, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#deleting-a-named-span">here</a>.</p>
<p>Otherwise you can use either of the following methods to delete/remove highlights:
- Using a span method e.g. <code>span.dehighlight()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-delete-highlights">here</a>.
- Using a sheet method e.g. <code>sheet.dehighlight(Span)</code> details below:</p>
<pre><code class="language-python">dehighlight(
    *key: CreateSpanTypes,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.</p>
<p>Example:</p>
<pre><code class="language-python"># highlight column B
self.sheet.highlight(
    &quot;B&quot;,
    bg=&quot;dark green&quot;,
    fg=&quot;white&quot;,
)

# dehighlight column B
self.sheet.dehighlight(&quot;B&quot;)
</code></pre>
<h4 id="other-ways-to-delete-highlights"><strong>Other ways to delete highlights</strong></h4>
<p><strong>Cells</strong></p>
<pre><code class="language-python">dehighlight_cells(
    row: int | Literal[&quot;all&quot;] = 0,
    column: int = 0,
    cells: list[tuple[int, int]] = [],
    canvas: Literal[&quot;table&quot;, &quot;row_index&quot;, &quot;header&quot;] = &quot;table&quot;,
    all_: bool = False,
    redraw: bool = True,
) -&gt; Sheet
</code></pre>
<p><strong>Rows</strong></p>
<pre><code class="language-python">dehighlight_rows(
    rows: list[int] | Literal[&quot;all&quot;] = [],
    redraw: bool = True,
) -&gt; Sheet
</code></pre>
<p><strong>Columns</strong></p>
<pre><code class="language-python">dehighlight_columns(
    columns: list[int] | Literal[&quot;all&quot;] = [],
    redraw: bool = True,
) -&gt; Sheet
</code></pre>
<p><strong>All</strong></p>
<pre><code class="language-python">dehighlight_all(
    cells: bool = True,
    rows: bool = True,
    columns: bool = True,
    header: bool = True,
    index: bool = True,
    redraw: bool = True,
) -&gt; Sheet
</code></pre>
<hr />
<h1 id="dropdown-boxes"><strong>Dropdown Boxes</strong></h1>
<h4 id="creating-dropdown-boxes"><strong>Creating dropdown boxes</strong></h4>
<p><code>Span</code> objects (more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#span-objects">here</a>) can be used to create dropdown boxes for cells, rows, columns, the entire sheet, headers and the index.</p>
<p>You can use either of the following methods:
- Using a span method e.g. <code>span.dropdown()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-create-dropdown-boxes">here</a>.
- Using a sheet method e.g. <code>sheet.dropdown(Span)</code></p>
<p>Or if you need user inserted row/columns in the middle of areas with dropdown boxes to also have dropdown boxes you can use named spans, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">here</a>.</p>
<p>Whether dropdown boxes are created for cells, rows or columns depends on the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#get-a-spans-kind"><code>kind</code></a> of span.</p>
<pre><code class="language-python">dropdown(
    *key: CreateSpanTypes,
    values: list = [],
    edit_data: bool = True,
    set_values: dict[tuple[int, int] | int, object] | None = None,
    set_value: object = None,
    state: Literal[&quot;normal&quot;, &quot;readonly&quot;, &quot;disabled&quot;] = &quot;normal&quot;,
    redraw: bool = True,
    selection_function: Callable | None = None,
    modified_function: Callable | None = None,
    search_function: Callable = dropdown_search_function,
    validate_input: bool = True,
    text: None | str = None,
) -&gt; Span
</code></pre>
<p>Notes:
- <code>selection_function</code>/<code>modified_function</code> (<code>Callable</code>, <code>None</code>) parameters require either <code>None</code> or a function. The function you use needs at least one argument because tksheet will send information to your function about the triggered dropdown.
- When a user selects an item from the dropdown box the sheet will set the underlying cells data to the selected item, to bind this event use either the <code>selection_function</code> argument or see the function <code>extra_bindings()</code> with binding <code>"end_edit_cell"</code> <a href="https://github.com/ragardner/tksheet/wiki/Version-7#table-functionality-and-bindings">here</a>.</p>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.
- <code>values</code> are the values to appear in a list view type interface when the dropdown box is open.
- <code>edit_data</code> when <code>True</code> makes edits in the table, header or index (depending on the span) based on <code>set_values</code>/<code>set_value</code>.
- <code>set_values</code> when combined with <code>edit_data=True</code> allows a <code>dict</code> to be provided of data coordinates (<code>tuple[int, int]</code> for a cell span or <code>int</code> for a row/column span) as <code>key</code>s and values to set the cell at that coordinate to.
    - e.g. <code>set_values={(0, 0): "new value for A1"}</code>.
    - The idea behind this parameter is that an entire column or row can have individual cell values and is not set to <code>set_value</code> alone.
- <code>set_value</code> when combined with <code>edit_data=True</code> sets every cell in the span to the value provided. If left as <code>None</code> and if <code>set_values</code> is also <code>None</code> then the topmost value from <code>values</code> will be used or if not <code>values</code> then <code>""</code>.
- <code>state</code> determines whether or not there is also an editable text window at the top of the dropdown box when it is open.
- <code>redraw</code> refreshes the sheet so the newly created box is visible.
- <code>selection_function</code> can be used to trigger a specific function when an item from the dropdown box is selected, if you are using the above <code>extra_bindings()</code> as well it will also be triggered but after this function. e.g. <code>selection_function = my_function_name</code>
- <code>modified_function</code> can be used to trigger a specific function when the <code>state</code> of the box is set to <code>"normal"</code> and there is an editable text window and a change of the text in that window has occurred. Note that this function occurs before the dropdown boxes search feature.
- <code>search_function</code> (<code>None</code>, <code>callable</code>) sets the function that will be used to search the dropdown boxes values upon a dropdown text editor modified event when the dropdowns state is <code>normal</code>. Set to <code>None</code> to disable the search feature or use your own function with the following keyword arguments: <code>(search_for, data):</code> and make it return an row number (e.g. select and see the first value would be <code>0</code>) if positive and <code>None</code> if negative.
- <code>validate_input</code> (<code>bool</code>) when <code>True</code> will not allow cut, paste, delete or cell editor to input values to cell which are not in the dropdown boxes values.
- <code>text</code> (<code>None</code>, <code>str</code>) can be set to something other than <code>None</code> to always display over whatever value is in the cell, this is useful when you want to display a Header name over a dropdown box selection.</p>
<p>Example:</p>
<pre><code class="language-python"># create dropdown boxes in column &quot;D&quot;
self.sheet.dropdown(
    &quot;D&quot;,
    values=[0, 1, 2, 3, 4],
)
</code></pre>
<hr />
<h4 id="deleting-dropdown-boxes"><strong>Deleting dropdown boxes</strong></h4>
<p>If the dropdown boxes were created by a named span then the named span must be deleted, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#deleting-a-named-span">here</a>.</p>
<p>Otherwise you can use either of the following methods to delete/remove dropdown boxes.
- Using a span method e.g. <code>span.del_dropdown()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-delete-dropdown-boxes">here</a>.
- Using a sheet method e.g. <code>sheet.del_dropdown(Span)</code> details below:</p>
<pre><code class="language-python">del_dropdown(
    *key: CreateSpanTypes,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.</p>
<p>Example:</p>
<pre><code class="language-python"># create dropdown boxes in column &quot;D&quot;
self.sheet.dropdown(
    &quot;D&quot;,
    values=[0, 1, 2, 3, 4],
)

# delete dropdown boxes in column &quot;D&quot;
self.sheet.del_dropdown(&quot;D&quot;)
</code></pre>
<hr />
<h4 id="get-chosen-dropdown-boxes-values"><strong>Get chosen dropdown boxes values</strong></h4>
<pre><code class="language-python">get_dropdown_values(r: int = 0, c: int = 0) -&gt; None | list
</code></pre>
<pre><code class="language-python">get_header_dropdown_values(c: int = 0) -&gt; None | list
</code></pre>
<pre><code class="language-python">get_index_dropdown_values(r: int = 0) -&gt; None | list
</code></pre>
<hr />
<h4 id="set-the-values-and-cell-value-of-a-chosen-dropdown-box"><strong>Set the values and cell value of a chosen dropdown box</strong></h4>
<pre><code class="language-python">set_dropdown_values(
    r: int = 0,
    c: int = 0,
    set_existing_dropdown: bool = False,
    values: list = [],
    set_value: object = None,
) -&gt; Sheet
</code></pre>
<pre><code class="language-python">set_header_dropdown_values(
    c: int = 0,
    set_existing_dropdown: bool = False,
    values: list = [],
    set_value: object = None,
) -&gt; Sheet
</code></pre>
<pre><code class="language-python">set_index_dropdown_values(
    r: int = 0,
    set_existing_dropdown: bool = False,
    values: list = [],
    set_value: object = None,
) -&gt; Sheet
</code></pre>
<p>Parameters:
- <code>set_existing_dropdown</code> if <code>True</code> takes priority over <code>r</code> and <code>c</code> and sets the values of the last popped open dropdown box (if one one is popped open, if not then an <code>Exception</code> is raised).
- <code>values</code> (<code>list</code>, <code>tuple</code>)
- <code>set_value</code> (<code>str</code>, <code>None</code>) if not <code>None</code> will try to set the value of the chosen cell to given argument.</p>
<hr />
<h4 id="set-or-get-bound-dropdown-functions"><strong>Set or get bound dropdown functions</strong></h4>
<pre><code class="language-python">dropdown_functions(
    r: int,
    c: int,
    selection_function: str | Callable = &quot;&quot;,
    modified_function: str | Callable = &quot;&quot;,
) -&gt; None | dict
</code></pre>
<pre><code class="language-python">header_dropdown_functions(
    c: int,
    selection_function: str | Callable = &quot;&quot;,
    modified_function: str | Callable = &quot;&quot;,
) -&gt; None | dict
</code></pre>
<pre><code class="language-python">index_dropdown_functions(
    r: int,
    selection_function: str | Callable = &quot;&quot;,
    modified_function: str | Callable = &quot;&quot;,
) -&gt; None | dict
</code></pre>
<hr />
<h4 id="get-a-dictionary-of-all-dropdown-boxes"><strong>Get a dictionary of all dropdown boxes</strong></h4>
<pre><code class="language-python">get_dropdowns() -&gt; dict
</code></pre>
<p>Returns:</p>
<pre><code class="language-python">{(row int, column int): {'values': values,
                         'select_function': selection_function,
                         'modified_function': modified_function,
                         'state': state,
                         'text': text}}
</code></pre>
<pre><code class="language-python">get_header_dropdowns() -&gt; dict
</code></pre>
<pre><code class="language-python">get_index_dropdowns() -&gt; dict
</code></pre>
<hr />
<h4 id="open-a-dropdown-box"><strong>Open a dropdown box</strong></h4>
<pre><code class="language-python">open_dropdown(r: int, c: int) -&gt; Sheet
</code></pre>
<pre><code class="language-python">open_header_dropdown(c: int) -&gt; Sheet
</code></pre>
<pre><code class="language-python">open_index_dropdown(r: int) -&gt; Sheet
</code></pre>
<hr />
<h4 id="close-a-dropdown-box"><strong>Close a dropdown box</strong></h4>
<pre><code class="language-python">close_dropdown(r: int | None = None, c: int | None = None) -&gt; Sheet
</code></pre>
<pre><code class="language-python">close_header_dropdown(c: int | None = None) -&gt; Sheet
</code></pre>
<pre><code class="language-python">close_index_dropdown(r: int | None = None) -&gt; Sheet
</code></pre>
<p>Notes:
- Also destroys any opened text editor windows.</p>
<hr />
<h1 id="check-boxes"><strong>Check Boxes</strong></h1>
<h4 id="creating-check-boxes"><strong>Creating check boxes</strong></h4>
<p><code>Span</code> objects (more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#span-objects">here</a>) can be used to create check boxes for cells, rows, columns, the entire sheet, headers and the index.</p>
<p>You can use either of the following methods:
- Using a span method e.g. <code>span.checkbox()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-create-check-boxes">here</a>.
- Using a sheet method e.g. <code>sheet.checkbox(Span)</code></p>
<p>Or if you need user inserted row/columns in the middle of areas with check boxes to also have check boxes you can use named spans, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">here</a>.</p>
<p>Whether check boxes are created for cells, rows or columns depends on the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#get-a-spans-kind"><code>kind</code></a> of span.</p>
<pre><code class="language-python">checkbox(
    *key: CreateSpanTypes,
    edit_data: bool = True,
    checked: bool | None = None,
    state: Literal[&quot;normal&quot;, &quot;disabled&quot;] = &quot;normal&quot;,
    redraw: bool = True,
    check_function: Callable | None = None,
    text: str = &quot;&quot;,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.
- <code>edit_data</code> when <code>True</code> edits the underlying cell data to either <code>checked</code> if <code>checked</code> is a <code>bool</code> or tries to convert the existing cell data to a <code>bool</code>.
- <code>checked</code> is the initial creation value to set the box to, if <code>None</code> then and <code>edit_data</code> is <code>True</code> then it will try to convert the underlying cell data to a <code>bool</code>.
- <code>state</code> can be <code>"normal"</code> or <code>"disabled"</code>. If <code>"disabled"</code> then color will be same as table grid lines, else it will be the cells text color.
- <code>check_function</code> can be used to trigger a function when the user clicks a checkbox.
- <code>text</code> displays text next to the checkbox in the cell, but will not be used as data, data will either be <code>True</code> or <code>False</code>.</p>
<p>Notes:
- <code>check_function</code> (<code>Callable</code>, <code>None</code>) requires either <code>None</code> or a function. The function you use needs at least one argument because when the checkbox is set it will send information to your function about the clicked checkbox.
- Use <code>highlight_cells()</code> or rows or columns to change the color of the checkbox.
- Check boxes are always left aligned despite any align settings.
- To get the current checkbox value either:
    - Get the cell data, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#getting-sheet-data">here</a>.
    - Use the parameter <code>check_function</code> with a function of your own creation to be called when the checkbox is set by the user.</p>
<p>Example:</p>
<pre><code class="language-python">self.sheet.checkbox(
    &quot;D&quot;,
    checked=True,
)
</code></pre>
<hr />
<h4 id="deleting-check-boxes"><strong>Deleting check boxes</strong></h4>
<p>If the check boxes were created by a named span then the named span must be deleted, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#deleting-a-named-span">here</a>.</p>
<p>Otherwise you can use either of the following methods to delete/remove check boxes:
- Using a span method e.g. <code>span.del_checkbox()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-delete-check-boxes">here</a>.
- Using a sheet method e.g. <code>sheet.del_checkbox(Span)</code> details below:</p>
<pre><code class="language-python">del_checkbox(
    *key: CreateSpanTypes,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.</p>
<p>Example:</p>
<pre><code class="language-python"># creating checkboxes in column D
self.sheet.checkbox(
    &quot;D&quot;,
    checked=True,
)

# deleting checkboxes in column D
self.sheet.del_checkbox(&quot;D&quot;)
</code></pre>
<h4 id="set-or-toggle-a-check-box"><strong>Set or toggle a check box</strong></h4>
<pre><code class="language-python">click_checkbox(
    *key: CreateSpanTypes,
    checked: bool | None = None,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<pre><code class="language-python">click_header_checkbox(c: int, checked: bool | None = None) -&gt; Sheet
</code></pre>
<pre><code class="language-python">click_index_checkbox(r: int, checked: bool | None = None) -&gt; Sheet
</code></pre>
<hr />
<h4 id="get-a-dictionary-of-all-check-box-dictionaries"><strong>Get a dictionary of all check box dictionaries</strong></h4>
<pre><code class="language-python">get_checkboxes() -&gt; dict
</code></pre>
<pre><code class="language-python">get_header_checkboxes() -&gt; dict
</code></pre>
<pre><code class="language-python">get_index_checkboxes() -&gt; dict
</code></pre>
<hr />
<h1 id="data-formatting"><strong>Data Formatting</strong></h1>
<p>By default tksheet stores all user inputted data as strings and while tksheet can store and display any datatype with a <code>__str__()</code> method this has some obvious limitations.</p>
<p>Data formatting aims to provide greater functionality when working with different datatypes and provide strict typing for the sheet. With formatting you can convert sheet data and user input to a specific datatype.</p>
<p>Additionally, formatting also provides a function for displaying data on the table GUI (as a rounded float for example) and logic for handling invalid and missing data.</p>
<p>tksheet has several basic built-in formatters and provides functionality for creating your own custom formats as well.</p>
<p>A demonstration of all the built-in and custom formatters can be found <a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-using-and-creating-formatters">here</a>.</p>
<h3 id="creation-and-deletion-of-data-formatting-rules"><strong>Creation and deletion of data formatting rules</strong></h3>
<h4 id="creating-a-data-format-rule"><strong>Creating a data format rule</strong></h4>
<p><code>Span</code> objects (more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#span-objects">here</a>) can be used to format data for cells, rows, columns and the entire sheet.</p>
<p>You can use either of the following methods:
- Using a span method e.g. <code>span.format()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-format-data">here</a>.
- Using a sheet method e.g. <code>sheet.format(Span)</code></p>
<p>Or if you need user inserted row/columns in the middle of areas with data formatting to also be formatted you can use named spans, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">here</a>.</p>
<p>Whether data is formatted for cells, rows or columns depends on the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#get-a-spans-kind"><code>kind</code></a> of span.</p>
<pre><code class="language-python">format(
    *key: CreateSpanTypes,
    formatter_options: dict = {},
    formatter_class: object = None,
    redraw: bool = True,
    **kwargs,
) -&gt; Span
</code></pre>
<p>Notes:
1. When applying multiple overlapping formats with e.g. a formatted cell which overlaps a formatted row, the priority is as follows:
    - Cell formats first.
    - Row formats second.
    - Column formats third.
2. Data formatting will effectively override <code>validate_input = True</code> on cells with dropdown boxes.
3. When getting data take careful note of the <code>get_displayed</code> options, as these are the difference between getting the actual formatted data and what is displayed on the table GUI.</p>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.
- <code>formatter_options</code> (<code>dict</code>) a dictionary of keyword options/arguements to pass to the formatter, see <a href="https://github.com/ragardner/tksheet/wiki/Version-7#formatters">here</a> for information on what argument to use.
- <code>formatter_class</code> (<code>class</code>) in case you want to use a custom class to store functions and information as opposed to using the built-in methods.
- <code>**kwargs</code> any additional keyword options/arguements to pass to the formatter.</p>
<hr />
<h4 id="deleting-a-data-format-rule"><strong>Deleting a data format rule</strong></h4>
<p>If the data format rule was created by a named span then the named span must be deleted, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#deleting-a-named-span">here</a>.</p>
<p>Otherwise you can use either of the following methods to delete/remove data formatting rules:
- Using a span method e.g. <code>span.del_format()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-delete-check-boxes">here</a>.
- Using a sheet method e.g. <code>sheet.del_format(Span)</code> details below:</p>
<pre><code class="language-python">del_format(
    *key: CreateSpanTypes,
    clear_values: bool = False,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<ul>
<li><code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.</li>
<li><code>clear_values</code> (<code>bool</code>) if true, all the cells covered by the span will have their values cleared.</li>
</ul>
<hr />
<h4 id="delete-all-formatting"><strong>Delete all formatting</strong></h4>
<pre><code class="language-python">del_all_formatting(clear_values: bool = False) -&gt; Sheet
</code></pre>
<ul>
<li><code>clear_values</code> (<code>bool</code>) if true, all the sheets cell values will be cleared.</li>
</ul>
<hr />
<h4 id="reapply-formatting-to-entire-sheet"><strong>Reapply formatting to entire sheet</strong></h4>
<pre><code class="language-python">reapply_formatting() -&gt; Sheet
</code></pre>
<ul>
<li>Useful if you have manually changed the entire sheets data using <code>sheet.MT.data =</code> and want to reformat the sheet using any existing formatting you have set.</li>
</ul>
<hr />
<h4 id="check-if-a-cell-is-formatted"><strong>Check if a cell is formatted</strong></h4>
<pre><code class="language-python">formatted(r: int, c: int) -&gt; dict
</code></pre>
<ul>
<li>If the cell is formatted function returns a <code>dict</code> with all the format keyword arguments. The <code>dict</code> will be empty if the cell is not formatted.</li>
</ul>
<hr />
<h3 id="formatters"><strong>Formatters</strong></h3>
<p>In addition to the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#generic-formatter">generic</a> formatter, <code>tksheet</code> provides formatters for many different data types.</p>
<p>A basic example showing how formatting some columns as <code>float</code> might be done:</p>
<pre><code class="language-python">import tkinter as tk

from tksheet import (
    Sheet,
    float_formatter,
)
from tksheet import (
    num2alpha,
)


class demo(tk.Tk):
    def __init__(self):
        super().__init__()
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.sheet = Sheet(
            self,
            data=[[f&quot;{r}&quot;, f&quot;{r}&quot;] for r in range(5)],
            expand_sheet_if_paste_too_big=True,
            theme=&quot;dark blue&quot;,
        )
        &quot;&quot;&quot;
        Format example
        &quot;&quot;&quot;
        # some keyword arguments inside float_formatter()
        self.sheet.format(
            num2alpha(0), # column A
            formatter_options=float_formatter(
                decimals=1,
                nullable=True,
            ),
        )
        # some keyword arguments outside
        # of float_formatter() instead
        self.sheet.format(
            &quot;B&quot;, # column B
            formatter_options=float_formatter(),
            decimals=3,
            nullable=False,
        )
        &quot;&quot;&quot;
        Rest of code
        &quot;&quot;&quot;
        self.sheet.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.enable_bindings(
            &quot;all&quot;,
            &quot;ctrl_select&quot;,
            &quot;edit_header&quot;,
            &quot;edit_index&quot;,
        )


app = demo()
app.mainloop()
</code></pre>
<p><strong>You can use any of the following formatters as an argument for the parameter <code>formatter_options</code>.</strong></p>
<p>A full list of keyword arguments available to these formatters is shown <a href="https://github.com/ragardner/tksheet/wiki/Version-7#generic-formatter">here</a>.</p>
<hr />
<h4 id="int-formatter"><strong>Int Formatter</strong></h4>
<p>The <code>int_formatter</code> is the basic configuration for a simple interger formatter.</p>
<pre><code class="language-python">int_formatter(
    datatypes: tuple[object] | object = int,
    format_function: Callable = to_int,
    to_str_function: Callable = to_str,
    invalid_value: object = &quot;NaN&quot;,
    **kwargs,
) -&gt; dict
</code></pre>
<p>Parameters:
 - <code>format_function</code> (<code>function</code>) a function that takes a string and returns an <code>int</code>. By default, this is set to the in-built <code>tksheet.to_int</code>. This function will always convert float-likes to its floor, for example <code>"5.9"</code> will be converted to <code>5</code>.
 - <code>to_str_function</code> (<code>function</code>) By default, this is set to the in-built <code>tksheet.to_str</code>, which is a very basic function that will displace the default string representation of the value.</p>
<p>Example:</p>
<pre><code class="language-python">sheet.format_cell(0, 0, formatter_options = tksheet.int_formatter())
</code></pre>
<hr />
<h4 id="float-formatter"><strong>Float Formatter</strong></h4>
<p>The <code>float_formatter</code> is the basic configuration for a simple float formatter. It will always round float-likes to the specified number of decimal places, for example <code>"5.999"</code> will be converted to <code>"6.0"</code> if <code>decimals = 1</code>.</p>
<pre><code class="language-python">float_formatter(
    datatypes: tuple[object] | object = float,
    format_function: Callable = to_float,
    to_str_function: Callable = float_to_str,
    invalid_value: object = &quot;NaN&quot;,
    decimals: int = 2,
    **kwargs
) -&gt; dict
</code></pre>
<p>Parameters:
 - <code>format_function</code> (<code>function</code>) a function that takes a string and returns a <code>float</code>. By default, this is set to the in-built <code>tksheet.to_float</code>.
 - <code>to_str_function</code> (<code>function</code>) By default, this is set to the in-built <code>tksheet.float_to_str</code>, which will display the float to the specified number of decimal places.
 - <code>decimals</code> (<code>int</code>, <code>None</code>) the number of decimal places to round to. Defaults to <code>2</code>.</p>
<p>Example:</p>
<pre><code class="language-python">sheet.format_cell(0, 0, formatter_options = tksheet.float_formatter(decimals = None)) # A float formatter with maximum float() decimal places
</code></pre>
<hr />
<h4 id="percentage-formatter"><strong>Percentage Formatter</strong></h4>
<p>The <code>percentage_formatter</code> is the basic configuration for a simple percentage formatter. It will always round float-likes as a percentage to the specified number of decimal places, for example <code>"5.999%"</code> will be converted to <code>"6.0%"</code> if <code>decimals = 1</code>.</p>
<pre><code class="language-python">percentage_formatter(
    datatypes: tuple[object] | object = float,
    format_function: Callable = to_percentage,
    to_str_function: Callable = percentage_to_str,
    invalid_value: object = &quot;NaN&quot;,
    decimals: int = 0,
    **kwargs,
) -&gt; dict
</code></pre>
<p>Parameters:
 - <code>format_function</code> (<code>function</code>) a function that takes a string and returns a <code>float</code>. By default, this is set to the in-built <code>tksheet.to_percentage</code>. This function will always convert percentages to their decimal equivalent, for example <code>"5%"</code> will be converted to <code>0.05</code>.
 - <code>to_str_function</code> (<code>function</code>) By default, this is set to the in-built <code>tksheet.percentage_to_str</code>, which will display the float as a percentage to the specified number of decimal places. For example, <code>0.05</code> will be displayed as <code>"5.0%"</code>.
 - <code>decimals</code> (<code>int</code>) the number of decimal places to round to. Defaults to <code>0</code>.</p>
<p>Example:</p>
<pre><code class="language-python">sheet.format_cell(0, 0, formatter_options=tksheet.percentage_formatter(decimals=1)) # A percentage formatter with 1 decimal place
</code></pre>
<p><strong>Note:</strong></p>
<p>By default <code>percentage_formatter()</code> converts user entry <code>21</code> to <code>2100%</code> and <code>21%</code> to <code>21%</code>. An example where <code>21</code> is converted to <code>21%</code> instead is shown below:</p>
<pre><code class="language-python"># formats column A as percentage

# uses:
# format_function=alt_to_percentage
# to_str_function=alt_percentage_to_str
sheet.format(
    &quot;A&quot;,
    formatter_options=tksheet.percentage_formatter(
        format_function=alt_to_percentage,
        to_str_function=alt_percentage_to_str,
    )
)
</code></pre>
<hr />
<h4 id="bool-formatter"><strong>Bool Formatter</strong></h4>
<pre><code class="language-python">bool_formatter(
    datatypes: tuple[object] | object = bool,
    format_function: Callable = to_bool,
    to_str_function: Callable = bool_to_str,
    invalid_value: object = &quot;NA&quot;,
    truthy: set = truthy,
    falsy: set = falsy,
    **kwargs,
) -&gt; dict
</code></pre>
<p>Parameters:
 - <code>format_function</code> (<code>function</code>) a function that takes a string and returns a <code>bool</code>. By default, this is set to the in-built <code>tksheet.to_bool</code>.
 - <code>to_str_function</code> (<code>function</code>) By default, this is set to the in-built <code>tksheet.bool_to_str</code>, which will display the boolean as <code>"True"</code> or <code>"False"</code>.
 - <code>truthy</code> (<code>set</code>) a set of values that will be converted to <code>True</code>. Defaults to the in-built <code>tksheet.truthy</code>.
 - <code>falsy</code> (<code>set</code>) a set of values that will be converted to <code>False</code>. Defaults to the in-built <code>tksheet.falsy</code>.</p>
<p>Example:</p>
<pre><code class="language-python"># A bool formatter with custom truthy and falsy values to account for aussie and kiwi slang
sheet.format_cell(0, 0, formatter_options = tksheet.bool_formatter(truthy = tksheet.truthy | {&quot;nah yeah&quot;}, falsy = tksheet.falsy | {&quot;yeah nah&quot;}))
</code></pre>
<hr />
<h4 id="generic-formatter"><strong>Generic Formatter</strong></h4>
<pre><code class="language-python">formatter(
    datatypes: tuple[object] | object,
    format_function: Callable,
    to_str_function: Callable = to_str,
    invalid_value: object = &quot;NaN&quot;,
    nullable: bool = True,
    pre_format_function: Callable | None = None,
    post_format_function: Callable | None = None,
    clipboard_function: Callable | None = None,
    **kwargs,
) -&gt; dict
</code></pre>
<p>This is the generic formatter options interface. You can use this to create your own custom formatters. The following options are available.</p>
<p>Note that all these options can also be passed to the <code>Sheet()</code> format functions as keyword arguments and are available as attributes for all formatters.</p>
<p>You can also provide functions of your own creation for all the below arguments which take functions if you require.</p>
<ul>
<li><code>datatypes</code> (<code>list</code>) a list of datatypes that the formatter will accept. For example, <code>datatypes = [int, float]</code> will accept integers and floats.</li>
<li><code>format_function</code> (<code>function</code>) a function that takes a string and returns a value of the desired datatype. For example, <code>format_function = int</code> will convert a string to an integer.</li>
<li><code>to_str_function</code> (<code>function</code>) a function that takes a value of the desired datatype and returns a string. This determines how the formatter displays its data on the table. For example, <code>to_str_function = str</code> will convert an integer to a string. Defaults to <code>tksheet.to_str</code>.</li>
<li><code>invalid_value</code> (<code>any</code>) the value to return if the input string is invalid. For example, <code>invalid_value = "NA"</code> will return "NA" if the input string is invalid.</li>
<li><code>nullable</code> (<code>bool</code>) if true, the formatter will accept <code>None</code> as a valid input.</li>
<li><code>pre_format_function</code> (<code>function</code>) a function that takes a input string and returns a string. This function is called before the <code>format_function</code> and can be used to modify the input string before it is converted to the desired datatype. This can be useful if you want to strip out unwanted characters or convert a string to a different format before converting it to the desired datatype.</li>
<li><code>post_format_function</code> (<code>function</code>) a function that takes a value <strong>which might not be of the desired datatype, e.g. <code>None</code> if the cell is nullable and empty</strong> and if successful returns a value of the desired datatype or if not successful returns the input value. This function is called after the <code>format_function</code> and can be used to modify the output value after it is converted to the desired datatype. This can be useful if you want to round a float for example.</li>
<li><code>clipboard_function</code> (<code>function</code>) a function that takes a value of the desired datatype and returns a string. This function is called when the cell value is copied to the clipboard. This can be useful if you want to convert a value to a different format before it is copied to the clipboard.</li>
<li><code>**kwargs</code> any additional keyword options/arguements to pass to the formatter. These keyword arguments will be passed to the <code>format_function</code>, <code>to_str_function</code>, and the <code>clipboard_function</code>. These can be useful if you want to specifiy any additional formatting options, such as the number of decimal places to round to.</li>
</ul>
<hr />
<h3 id="datetime-formatters-and-designing-your-own-custom-formatters"><strong>Datetime Formatters and Designing Your Own Custom Formatters</strong></h3>
<p>tksheet is at the moment a dependency free library and so doesn't include a datetime parser as is.</p>
<p>You can however very easily make a datetime parser if you are willing to install a third-party package. Recommended are:</p>
<ul>
<li><a href="https://dateparser.readthedocs.io/en/latest/">dateparser</a></li>
<li><a href="https://dateutil.readthedocs.io/en/stable/">dateutil</a></li>
</ul>
<p>Both of these packages have a very comprehensive datetime parser which can be used to create a custom datetime formatter for tksheet.</p>
<p>Below is a simple example of how you might create a custom datetime formatter using the <code>dateutil</code> package.</p>
<pre><code class="language-python">from tksheet import *
from datetime import datetime, date
from dateutil.parser import parse

def to_local_datetime(dt, **kwargs):
    '''
    Our custom format_function, converts a string or a date to a datetime object in the local timezone.
    '''
    if isinstance(dt, datetime):
        pass # Do nothing
    elif isinstance(dt, date):
        dt = datetime(dt.year, dt.month, dt.day) # Always good to account for unexpected inputs
    else:
        try:
            dt = parser.parse(dt)
        except:
            raise ValueError(f&quot;Could not parse {dt} as a datetime&quot;)
    if dt.tzinfo is None:
        dt = dt.replace(tzinfo = tzlocal()) # If no timezone is specified, assume local timezone
    dt = dt.astimezone(tzlocal()) # Convert to local timezone
    return dt

def datetime_to_str(dt, **kwargs):
    '''
    Our custom to_str_function, converts a datetime object to a string with a format that can be specfied in kwargs.
    '''
    return dt.strftime(kwargs['format'])

# Now we can create our custom formatter dictionary from the generic formatter interface in tksheet
datetime_formatter = formatter(datatypes = datetime,
                               format_function = to_local_datetime,
                               to_str_function = datetime_to_str,
                               invalid_value = &quot;NaT&quot;,
                               format = &quot;%d/%m/%Y %H:%M:%S&quot;,
                               )

# From here we can pass our datetime_formatter into sheet.format() or span.format() just like any other formatter
</code></pre>
<p>For those wanting even more customisation of their formatters you also have the option of creating a custom formatter class. This is a more advanced topic and is not covered here, but it's recommended to create a new class which is a subclass of the <code>tksheet.Formatter</code> class and overriding the methods you would like to customise. This custom class can then be passed into the <code>format_cells()</code> <code>formatter_class</code> argument.</p>
<hr />
<h1 id="readonly-cells"><strong>Readonly Cells</strong></h1>
<h4 id="creating-a-readonly-rule"><strong>Creating a readonly rule</strong></h4>
<p><code>Span</code> objects (more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#span-objects">here</a>) can be used to create readonly rules for cells, rows, columns, the entire sheet, headers and the index.</p>
<p>You can use either of the following methods:
- Using a span method e.g. <code>span.readonly()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-set-cells-to-read-only">here</a>.
- Using a sheet method e.g. <code>sheet.readonly(Span)</code></p>
<p>Or if you need user inserted row/columns in the middle of areas with a readonly rule to also have a readonly rule you can use named spans, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">here</a>.</p>
<p>Whether cells, rows or columns are readonly depends on the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#get-a-spans-kind"><code>kind</code></a> of span.</p>
<pre><code class="language-python">readonly(
    *key: CreateSpanTypes,
    readonly: bool = True,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.
- <code>readonly</code> (<code>bool</code>) <code>True</code> to create a rule and <code>False</code> to delete one created without the use of named spans.</p>
<hr />
<h4 id="deleting-a-readonly-rule"><strong>Deleting a readonly rule</strong></h4>
<p>If the readonly rule was created by a named span then the named span must be deleted, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#deleting-a-named-span">here</a>.</p>
<p>Otherwise you can use either of the following methods to delete/remove readonly rules:
- Using a span method e.g. <code>span.readonly()</code> with the keyword argument <code>readonly=False</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-set-cells-to-read-only">here</a>.
- Using a sheet method e.g. <code>sheet.readonly(Span)</code> with the keyword argument <code>readonly=False</code> example below:</p>
<pre><code class="language-python"># creating a readonly rule
self.sheet.readonly(
    self.sheet.span(&quot;A&quot;, header=True),
    readonly=True,
)

# deleting the readonly rule
self.sheet.readonly(
    self.sheet.span(&quot;A&quot;, header=True),
    readonly=False,
)
</code></pre>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.
- <code>readonly</code> (<code>bool</code>) <code>True</code> to create a rule and <code>False</code> to delete one created without the use of named spans.</p>
<hr />
<h1 id="text-font-and-alignment"><strong>Text Font and Alignment</strong></h1>
<h3 id="font"><strong>Font</strong></h3>
<ul>
<li>Font arguments require a three tuple e.g. <code>("Arial", 12, "normal")</code> or <code>("Arial", 12, "bold")</code> or <code>("Arial", 12, "italic")</code></li>
<li>The table and index currently share a font, it's not possible to change the index font separate from the table font.</li>
</ul>
<p><strong>Set the table and index font</strong></p>
<pre><code class="language-python">font(
    newfont: tuple[str, int, str] | None = None,
    reset_row_positions: bool = True,
) -&gt; tuple[str, int, str]
</code></pre>
<p><strong>Set the header font</strong></p>
<pre><code class="language-python">header_font(newfont: tuple[str, int, str] | None = None) -&gt; tuple[str, int, str]
</code></pre>
<h3 id="text-alignment"><strong>Text Alignment</strong></h3>
<p>There are functions to set the text alignment for specific cells/rows/columns and also functions to set the text alignment for a whole part of the sheet (table/index/header).</p>
<ul>
<li>Alignment argument (<code>str</code>) options are:<ul>
<li><code>"w"</code>, <code>"west"</code>, <code>"left"</code></li>
<li><code>"e"</code>, <code>"east"</code>, <code>"right"</code></li>
<li><code>"c"</code>, <code>"center"</code>, <code>"centre"</code></li>
</ul>
</li>
</ul>
<p>Unfortunately vertical alignment is not available.</p>
<h4 id="whole-widget-text-alignment"><strong>Whole widget text alignment</strong></h4>
<p>Set the text alignment for the whole of the table (doesn't include index/header).</p>
<pre><code class="language-python">table_align(
    align: str = None,
    redraw: bool = True,
) -&gt; str | Sheet
</code></pre>
<p>Set the text alignment for the whole of the header.</p>
<pre><code class="language-python">header_align(
    align: str = None,
    redraw: bool = True,
) -&gt; str | Sheet
</code></pre>
<p>Set the text alignment for the whole of the index.</p>
<pre><code class="language-python">row_index_align(
    align: str = None,
    redraw: bool = True,
) -&gt; str | Sheet

# can also use index_align() which behaves the same
</code></pre>
<h4 id="creating-a-specific-cell-row-or-column-text-alignment-rule"><strong>Creating a specific cell row or column text alignment rule</strong></h4>
<p>The following function is for setting text alignment for specific cells, rows or columns in the table, header and index.</p>
<p><code>Span</code> objects (more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#span-objects">here</a>) can be used to create text alignment rules for cells, rows, columns, the entire sheet, headers and the index.</p>
<p>You can use either of the following methods:
- Using a span method e.g. <code>span.align()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-create-text-alignment-rules">here</a>.
- Using a sheet method e.g. <code>sheet.align(Span)</code></p>
<p>Or if you need user inserted row/columns in the middle of areas with an alignment rule to also have an alignment rule you can use named spans, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#named-spans">here</a>.</p>
<p>Whether cells, rows or columns are affected depends on the <a href="https://github.com/ragardner/tksheet/wiki/Version-7#get-a-spans-kind"><code>kind</code></a> of span.</p>
<pre><code class="language-python">align(
    *key: CreateSpanTypes,
    align: str | None = None,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.
- <code>align</code> (<code>str</code>, <code>None</code>) must be one of the following:
    - <code>"w"</code>, <code>"west"</code>, <code>"left"</code>
    - <code>"e"</code>, <code>"east"</code>, <code>"right"</code>
    - <code>"c"</code>, <code>"center"</code>, <code>"centre"</code></p>
<h4 id="deleting-a-specific-text-alignment-rule"><strong>Deleting a specific text alignment rule</strong></h4>
<p>If the text alignment rule was created by a named span then the named span must be deleted, more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#deleting-a-named-span">here</a>.</p>
<p>Otherwise you can use either of the following methods to delete/remove specific text alignment rules:
- Using a span method e.g. <code>span.del_align()</code> more information <a href="https://github.com/ragardner/tksheet/wiki/Version-7#using-a-span-to-delete-text-alignment-rules">here</a>.
- Using a sheet method e.g. <code>sheet.del_align(Span)</code> details below:</p>
<pre><code class="language-python">del_align(
    *key: CreateSpanTypes,
    redraw: bool = True,
) -&gt; Span
</code></pre>
<p>Parameters:
- <code>key</code> (<code>CreateSpanTypes</code>) either a span or a type which can create a span. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#creating-a-span">here</a> for more information on the types that can create a span.</p>
<h4 id="get-existing-specific-text-alignments"><strong>Get existing specific text alignments</strong></h4>
<p>Cell text alignments:</p>
<pre><code class="language-python">get_cell_alignments() -&gt; dict
</code></pre>
<p>Row text alignments:</p>
<pre><code class="language-python">get_row_alignments() -&gt; dict
</code></pre>
<p>Column text alignments:</p>
<pre><code class="language-python">get_column_alignments() -&gt; dict
</code></pre>
<hr />
<h1 id="getting-cell-properties"><strong>Getting Cell Properties</strong></h1>
<p>The below functions can be used to retrieve cell options/properties such as highlights, format, readonly etc.</p>
<h4 id="get-table-cell-properties"><strong>Get table cell properties</strong></h4>
<p>Retrieve options for a single cell in the main table. Also retrieves any row/column options impacting that cell.</p>
<pre><code class="language-Python">props(
    row: int,
    column: int | str,
    key: None
    | Literal[
        &quot;format&quot;,
        &quot;highlight&quot;,
        &quot;dropdown&quot;,
        &quot;checkbox&quot;,
        &quot;readonly&quot;,
        &quot;align&quot;,
    ] = None,
    cellops: bool = True,
    rowops: bool = True,
    columnops: bool = True,
) -&gt; dict
</code></pre>
<p>Parameters:
- <code>row</code> only <code>int</code>.
- <code>column</code> <code>int</code> or <code>str</code> e.g. <code>"A"</code> is index <code>0</code>.
- <code>key</code>:
    - If left as <code>None</code> then all existing properties for that cell will be returned in a <code>dict</code>.
    - If using a <code>str</code> e.g. <code>"highlight"</code> it will only look for highlight properties for that cell.
- <code>cellops</code> when <code>True</code> will look for cell options for the cell.
- <code>rowops</code> when <code>True</code> will look for row options for the cell.
- <code>columnops</code> when <code>True</code> will look for column options for the cell.</p>
<p>Example:</p>
<pre><code class="language-python"># making column B, including header read only
sheet.readonly(sheet[&quot;B&quot;].options(header=True))

# checking if row 0, column 1 (B) is readonly:
cell_is_readonly = sheet.props(0, 1, &quot;readonly&quot;)

# can also use a string for the column:
cell_is_readonly = sheet.props(0, &quot;b&quot;, &quot;readonly&quot;)
</code></pre>
<hr />
<h4 id="get-index-cell-properties"><strong>Get index cell properties</strong></h4>
<p>Retrieve options for a single cell in the index.</p>
<pre><code class="language-python">index_props(
    row: int,
    key: None
    | Literal[
        &quot;format&quot;,
        &quot;highlight&quot;,
        &quot;dropdown&quot;,
        &quot;checkbox&quot;,
        &quot;readonly&quot;,
        &quot;align&quot;,
    ] = None,
) -&gt; dict
</code></pre>
<p>Parameters:
- <code>row</code> only <code>int</code>.
- <code>key</code>:
    - If left as <code>None</code> then all existing properties for that cell will be returned in a <code>dict</code>.
    - If using a <code>str</code> e.g. <code>"highlight"</code> it will only look for highlight properties for that cell.</p>
<hr />
<h4 id="get-header-cell-properties"><strong>Get header cell properties</strong></h4>
<p>Retrieve options for a single cell in the header.</p>
<pre><code class="language-python">header_props(
    column: int | str,
    key: None
    | Literal[
        &quot;format&quot;,
        &quot;highlight&quot;,
        &quot;dropdown&quot;,
        &quot;checkbox&quot;,
        &quot;readonly&quot;,
        &quot;align&quot;,
    ] = None,
) -&gt; dict
</code></pre>
<p>Parameters:
- <code>column</code> only <code>int</code>.
- <code>key</code>:
    - If left as <code>None</code> then all existing properties for that cell will be returned in a <code>dict</code>.
    - If using a <code>str</code> e.g. <code>"highlight"</code> it will only look for highlight properties for that cell.</p>
<hr />
<h1 id="getting-selected-cells"><strong>Getting Selected Cells</strong></h1>
<p>All selected cell/box getting functions return or generate <strong>displayed</strong> cell coordinates.
- Displayed cell coordinates ignore hidden rows/columns when indexing cells.
- Data cell coordinates include hidden rows/columns in indexing cells.</p>
<h4 id="get-the-currently-selected-cell"><strong>Get the currently selected cell</strong></h4>
<p>This is always a single cell of displayed indices. If you have hidden rows or columns you can change the integers to data indices using the following functions:
- <a href="https://github.com/ragardner/tksheet/wiki/Version-7#displayed-row-index-to-data">Change a row</a>
- <a href="https://github.com/ragardner/tksheet/wiki/Version-7#displayed-column-index-to-data">Change a column</a></p>
<pre><code class="language-python">get_currently_selected() -&gt; tuple | Selected
</code></pre>
<p>Notes:
- Returns either:
    - <code>namedtuple</code> of <code>(row, column, type_, box, iid, fill_iid)</code>.
        - <code>type_</code> can be <code>"rows"</code>, <code>"columns"</code> or <code>"cells"</code>.
        - <code>box</code> <code>tuple[int, int, int, int]</code> are the coordinates of the box that the currently selected box is attached to.
            - <code>(from row, from column, up to but not including row, up to but not including column)</code>.
        - <code>iid</code> is the canvas item id of the currently selected box.
        - <code>fill_iid</code> is the canvas item id of the box that the currently selected box is attached to.
    - An empty <code>tuple</code> if nothing is selected.
- Can also use <code>sheet.selected</code> as shorter <code>@property</code> version of the function.</p>
<p>Example:</p>
<pre><code class="language-python">currently_selected = self.sheet.get_currently_selected()
if currently_selected:
    row = currently_selected.row
    column = currently_selected.column
    type_ = currently_selected.type_

if self.sheet.selected:
    ...
</code></pre>
<hr />
<h4 id="get-selected-rows"><strong>Get selected rows</strong></h4>
<pre><code class="language-python">get_selected_rows(
    get_cells: bool = False,
    get_cells_as_rows: bool = False,
    return_tuple: bool = False,
) -&gt; tuple[int] | tuple[tuple[int, int]] | set[int] | set[tuple[int, int]]
</code></pre>
<ul>
<li>Returns displayed indexes.</li>
</ul>
<hr />
<h4 id="get-selected-columns"><strong>Get selected columns</strong></h4>
<pre><code class="language-python">get_selected_columns(
    get_cells: bool = False,
    get_cells_as_columns: bool = False,
    return_tuple: bool = False,
) -&gt; tuple[int] | tuple[tuple[int, int]] | set[int] | set[tuple[int, int]]
</code></pre>
<ul>
<li>Returns displayed indexes.</li>
</ul>
<hr />
<h4 id="get-selected-cells"><strong>Get selected cells</strong></h4>
<pre><code class="language-python">get_selected_cells(
    get_rows: bool = False,
    get_columns: bool = False,
    sort_by_row: bool = False,
    sort_by_column: bool = False,
    reverse: bool = False,
) -&gt; list[tuple[int, int]] | set[tuple[int, int]]
</code></pre>
<ul>
<li>Returns displayed coordinates.</li>
</ul>
<hr />
<h4 id="generate-selected-cells"><strong>Generate selected cells</strong></h4>
<pre><code class="language-python">gen_selected_cells(
    get_rows: bool = False,
    get_columns: bool = False,
) -&gt; Generator[tuple[int, int]]
</code></pre>
<ul>
<li>Generates displayed coordinates.</li>
</ul>
<hr />
<h4 id="get-all-selection-boxes"><strong>Get all selection boxes</strong></h4>
<pre><code class="language-python">get_all_selection_boxes() -&gt; tuple[tuple[int, int, int, int]]
</code></pre>
<ul>
<li>Returns displayed coordinates.</li>
</ul>
<hr />
<h4 id="get-all-selection-boxes-and-their-types"><strong>Get all selection boxes and their types</strong></h4>
<pre><code class="language-python">get_all_selection_boxes_with_types() -&gt; list[tuple[tuple[int, int, int, int], str]]
</code></pre>
<p>Equivalent to <code>get_all_selection_boxes_with_types()</code> but shortened as <code>@property</code>.</p>
<pre><code class="language-python">@property
boxes() -&gt; list[tuple[tuple[int, int, int, int], str]]
</code></pre>
<hr />
<h4 id="check-if-cell-is-selected"><strong>Check if cell is selected</strong></h4>
<pre><code class="language-python">cell_selected(
    r: int,
    c: int,
    rows: bool = False,
    columns: bool = False,
) -&gt; bool
</code></pre>
<ul>
<li><code>rows</code> if <code>True</code> also checks if provided cell is part of a selected row.</li>
<li><code>columns</code> if <code>True</code> also checks if provided cell is part of a selected column.</li>
</ul>
<hr />
<h4 id="check-if-row-is-selected"><strong>Check if row is selected</strong></h4>
<pre><code class="language-python">row_selected(r: int, cells: bool = False) -&gt; bool
</code></pre>
<ul>
<li><code>cells</code> if <code>True</code> also checks if provided row is selected as part of a cell selection box.</li>
</ul>
<hr />
<h4 id="check-if-column-is-selected"><strong>Check if column is selected</strong></h4>
<pre><code class="language-python">column_selected(c: int, cells: bool = False) -&gt; bool
</code></pre>
<ul>
<li><code>cells</code> if <code>True</code> also checks if provided column is selected as part of a cell selection box.</li>
</ul>
<hr />
<h4 id="check-if-any-cells-rows-or-columns-are-selected-there-are-options-for-exclusions"><strong>Check if any cells, rows or columns are selected, there are options for exclusions</strong></h4>
<pre><code class="language-python">anything_selected(
    exclude_columns: bool = False,
    exclude_rows: bool = False,
    exclude_cells: bool = False,
) -&gt; bool
</code></pre>
<hr />
<h4 id="check-if-user-has-the-entire-table-selected"><strong>Check if user has the entire table selected</strong></h4>
<pre><code class="language-python">all_selected() -&gt; bool
</code></pre>
<hr />
<pre><code class="language-python">get_ctrl_x_c_boxes(nrows: bool = True) -&gt; tuple[dict[tuple[int, int, int, int], str], int]
</code></pre>
<hr />
<pre><code class="language-python">@property
ctrl_boxes() -&gt; dict[tuple[int, int, int, int], str]
</code></pre>
<hr />
<pre><code class="language-python">get_selected_min_max() -&gt; tuple[int, int, int, int] | tuple[None, None, None, None]
</code></pre>
<ul>
<li>returns <code>(min_y, min_x, max_y, max_x)</code> of any selections including rows/columns.</li>
</ul>
<hr />
<h1 id="modifying-selected-cells"><strong>Modifying Selected Cells</strong></h1>
<p>All selected cell/box setting functions use <strong>displayed</strong> cell coordinates.
- Displayed cell coordinates ignore hidden rows/columns when indexing cells.
- Data cell coordinates include hidden rows/columns in indexing cells.</p>
<pre><code class="language-python">set_currently_selected(row: int | None = None, column: int | None = None) -&gt; Sheet
</code></pre>
<hr />
<pre><code class="language-python">select_row(row: int, redraw: bool = True, run_binding_func: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"row_select"</code> bound.</li>
</ul>
<hr />
<pre><code class="language-python">select_column(column: int, redraw: bool = True, run_binding_func: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"column_select"</code> bound.</li>
</ul>
<hr />
<pre><code class="language-python">select_cell(row: int, column: int, redraw: bool = True, run_binding_func: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"cell_select"</code> bound.</li>
</ul>
<hr />
<pre><code class="language-python">select_all(redraw: bool = True, run_binding_func: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"select_all"</code> bound.</li>
</ul>
<hr />
<p>Deselect a specific cell, row or column.</p>
<pre><code class="language-python">deselect(
    row: int | None | Literal[&quot;all&quot;] = None,
    column: int | None = None,
    cell: tuple | None = None,
    redraw: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li>Leave parameters as <code>None</code>, or <code>row</code> as <code>"all"</code> to deselect everything.</li>
<li>Can also close text editors and open dropdowns.</li>
</ul>
<hr />
<p>Deselect any cell, row or column selection box conflicting with <code>rows</code> and/or <code>columns</code>.</p>
<pre><code class="language-python">deselect_any(
    rows: Iterator[int] | int | None,
    columns: Iterator[int] | int | None,
    redraw: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li>Leave parameters as <code>None</code> to deselect everything.</li>
<li>Can also close text editors and open dropdowns.</li>
</ul>
<hr />
<pre><code class="language-python">add_cell_selection(
    row: int,
    column: int,
    redraw: bool = True,
    run_binding_func: bool = True,
    set_as_current: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"cell_select"</code> bound.</li>
</ul>
<hr />
<pre><code class="language-python">add_row_selection(
    row: int,
    redraw: bool = True,
    run_binding_func: bool = True,
    set_as_current: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"row_select"</code> bound.</li>
</ul>
<hr />
<pre><code class="language-python">add_column_selection(
    column: int,
    redraw: bool = True,
    run_binding_func: bool = True,
    set_as_current: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"column_select"</code> bound.</li>
</ul>
<hr />
<pre><code class="language-python">toggle_select_cell(
    row: int,
    column: int,
    add_selection: bool = True,
    redraw: bool = True,
    run_binding_func: bool = True,
    set_as_current: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"cell_select"</code> bound.</li>
</ul>
<hr />
<pre><code class="language-python">toggle_select_row(
    row: int,
    add_selection: bool = True,
    redraw: bool = True,
    run_binding_func: bool = True,
    set_as_current: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"row_select"</code> bound.</li>
</ul>
<hr />
<pre><code class="language-python">toggle_select_column(
    column: int,
    add_selection: bool = True,
    redraw: bool = True,
    run_binding_func: bool = True,
    set_as_current: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>run_binding_func</code> is only relevant if you have <code>extra_bindings()</code> with <code>"column_select"</code> bound.</li>
</ul>
<hr />
<pre><code class="language-python">create_selection_box(
    r1: int,
    c1: int,
    r2: int,
    c2: int,
    type_: str = &quot;cells&quot;,
) -&gt; int
</code></pre>
<ul>
<li><code>type_</code> either <code>"cells"</code> or <code>"rows"</code> or <code>"columns"</code>.</li>
<li>Returns the canvas item id for the box.</li>
</ul>
<hr />
<pre><code class="language-python">@boxes.setter
boxes(boxes: Sequence[tuple[tuple[int, int, int, int], str]])
</code></pre>
<ul>
<li>Can be used to set the Sheets selection boxes, deselects everything before setting.</li>
</ul>
<p>Example:</p>
<pre><code class="language-python">sheet.boxes = [
    ((0, 0, 3, 3), &quot;cells&quot;),
    ((4, 0, 5, 10), &quot;rows&quot;),
]
</code></pre>
<ul>
<li>The above would select a cells box from cell <code>A1</code> up to and including cell <code>C3</code> and row <code>4</code> (in python index, <code>5</code> as excel index) where the sheet has 10 columns.</li>
<li>The <code>str</code> in the type hint should be either <code>"cells"</code> or <code>"rows"</code> or <code>"columns"</code>.</li>
</ul>
<hr />
<pre><code class="language-python">recreate_all_selection_boxes() -&gt; Sheet
</code></pre>
<hr />
<h1 id="row-heights-and-column-widths"><strong>Row Heights and Column Widths</strong></h1>
<h4 id="auto-resize-column-widths-to-fit-the-window"><strong>Auto resize column widths to fit the window</strong></h4>
<p>To enable auto resizing of columns to the Sheet window use <code>set_options()</code> with the keyword argument <code>auto_resize_columns</code>. This argument can either be an <code>int</code> or <code>None</code>. If set as an <code>int</code> the columns will automatically resize to fit the width of the window, the <code>int</code> value being the minimum of each column in pixels. If <code>None</code> it will disable the auto resizing. Example:</p>
<pre><code class="language-python"># auto resize columns, column minimum width set to 150 pixels
set_options(auto_resize_columns=150)
</code></pre>
<hr />
<h4 id="auto-resize-row-heights-to-fit-the-window"><strong>Auto resize row heights to fit the window</strong></h4>
<p>To enable auto resizing of rows to the Sheet window use <code>set_options()</code> with the keyword argument <code>auto_resize_rows</code>. This argument can either be an <code>int</code> or <code>None</code>. If set as an <code>int</code> the rows will automatically resize to fit the width of the window, the <code>int</code> value being the minimum of each row in pixels. If <code>None</code> it will disable the auto resizing. Example:</p>
<pre><code class="language-python"># auto resize rows, row minimum width set to 30 pixels
set_options(auto_resize_rows=30)
</code></pre>
<hr />
<h4 id="set-default-column-width-in-pixels"><strong>Set default column width in pixels</strong></h4>
<pre><code class="language-python">default_column_width(width: int | None = None) -&gt; int
</code></pre>
<ul>
<li><code>width</code> (<code>int</code>, <code>None</code>) use an <code>int</code> to set the width in pixels, <code>None</code> does not set the width.</li>
</ul>
<hr />
<h4 id="set-default-row-height-in-pixels-or-lines"><strong>Set default row height in pixels or lines</strong></h4>
<pre><code class="language-python">default_row_height(height: int | str | None = None) -&gt; int
</code></pre>
<ul>
<li><code>height</code> (<code>int</code>, <code>str</code>, <code>None</code>) use a numerical <code>str</code> for number of lines e.g. <code>"3"</code> for a height that fits 3 lines OR <code>int</code> for pixels.</li>
</ul>
<hr />
<h4 id="set-default-header-bar-height-in-pixels-or-lines"><strong>Set default header bar height in pixels or lines</strong></h4>
<pre><code class="language-python">default_header_height(height: int | str | None = None) -&gt; int
</code></pre>
<ul>
<li><code>height</code> (<code>int</code>, <code>str</code>, <code>None</code>) use a numerical <code>str</code> for number of lines e.g. <code>"3"</code> for a height that fits 3 lines or <code>int</code> for pixels.</li>
</ul>
<hr />
<h4 id="set-a-specific-cell-size-to-its-text"><strong>Set a specific cell size to its text</strong></h4>
<pre><code class="language-python">set_cell_size_to_text(
    row: int,
    column: int,
    only_set_if_too_small: bool = False,
    redraw: bool = True,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="set-all-row-heights-and-column-widths-to-cell-text-sizes"><strong>Set all row heights and column widths to cell text sizes</strong></h4>
<pre><code class="language-python">set_all_cell_sizes_to_text(
    redraw: bool = True,
    width: int | None = None,
    slim: bool = False,
) -&gt; tuple[list[float], list[float]]
</code></pre>
<ul>
<li>Returns the Sheets row positions and column positions in that order.</li>
<li><code>width</code> a minimum width for all column widths set using this function.</li>
<li><code>slim</code> column widths will be set precisely to text width and not add any extra space.</li>
</ul>
<hr />
<h4 id="set-all-column-widths-to-a-specific-width-in-pixels"><strong>Set all column widths to a specific width in pixels</strong></h4>
<pre><code class="language-python">set_all_column_widths(
    width: int | None = None,
    only_set_if_too_small: bool = False,
    redraw: bool = True,
    recreate_selection_boxes: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>width</code> (<code>int</code>, <code>None</code>) leave <code>None</code> to set to cell text sizes for each column.</li>
</ul>
<hr />
<h4 id="set-all-row-heights-to-a-specific-height-in-pixels"><strong>Set all row heights to a specific height in pixels</strong></h4>
<pre><code class="language-python">set_all_row_heights(
    height: int | None = None,
    only_set_if_too_small: bool = False,
    redraw: bool = True,
    recreate_selection_boxes: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>height</code> (<code>int</code>, <code>None</code>) leave <code>None</code> to set to cell text sizes for each row.</li>
</ul>
<hr />
<h4 id="set-or-get-a-specific-column-width"><strong>Set or get a specific column width</strong></h4>
<pre><code class="language-python">column_width(
    column: int | Literal[&quot;all&quot;, &quot;displayed&quot;] | None = None,
    width: int | Literal[&quot;default&quot;, &quot;text&quot;] | None = None,
    only_set_if_too_small: bool = False,
    redraw: bool = True,
) -&gt; Sheet | int
</code></pre>
<hr />
<h4 id="set-or-get-a-specific-row-height"><strong>Set or get a specific row height</strong></h4>
<pre><code class="language-python">row_height(
    row: int | Literal[&quot;all&quot;, &quot;displayed&quot;] | None = None,
    height: int | Literal[&quot;default&quot;, &quot;text&quot;] | None = None,
    only_set_if_too_small: bool = False,
    redraw: bool = True,
) -&gt; Sheet | int
</code></pre>
<hr />
<h4 id="get-the-sheets-column-widths"><strong>Get the sheets column widths</strong></h4>
<pre><code class="language-python">get_column_widths(canvas_positions: bool = False) -&gt; list[float]
</code></pre>
<ul>
<li><code>canvas_positions</code> (<code>bool</code>) gets the actual canvas x coordinates of column lines.</li>
</ul>
<hr />
<h4 id="get-the-sheets-row-heights"><strong>Get the sheets row heights</strong></h4>
<pre><code class="language-python">get_row_heights(canvas_positions: bool = False) -&gt; list[float]
</code></pre>
<ul>
<li><code>canvas_positions</code> (<code>bool</code>) gets the actual canvas y coordinates of row lines.</li>
</ul>
<hr />
<h4 id="get-a-rows-text-height"><strong>Get a rows text height</strong></h4>
<pre><code class="language-python">get_row_text_height(
    row: int,
    visible_only: bool = False,
    only_if_too_small: bool = False,
) -&gt; int
</code></pre>
<ul>
<li>Returns a height in pixels which will fit all text in the specified row.</li>
<li><code>visible_only</code> if <code>True</code> only measures rows visible on the Sheet.</li>
<li><code>only_if_too_small</code> if <code>True</code> will only return a new height if the current row height is too short to accomodate its text.</li>
</ul>
<hr />
<h4 id="get-a-columns-text-width"><strong>Get a columns text width</strong></h4>
<pre><code class="language-python">get_column_text_width(
    column: int,
    visible_only: bool = False,
    only_if_too_small: bool = False,
) -&gt; int
</code></pre>
<ul>
<li>Returns a width in pixels which will fit all text in the specified column.</li>
<li><code>visible_only</code> if <code>True</code> only measures columns visible on the Sheet.</li>
<li><code>only_if_too_small</code> if <code>True</code> will only return a new width if the current column width is too thin to accomodate its text.</li>
</ul>
<hr />
<h4 id="set-or-reset-displayed-column-widthslines"><strong>Set or reset displayed column widths/lines</strong></h4>
<pre><code class="language-python">set_column_widths(
    column_widths: Iterator[int, float] | None = None,
    canvas_positions: bool = False,
    reset: bool = False,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="set-or-reset-displayed-row-heightslines"><strong>Set or reset displayed row heights/lines</strong></h4>
<pre><code class="language-python">set_row_heights(
    row_heights: Iterator[int, float] | None = None,
    canvas_positions: bool = False,
    reset: bool = False,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="set-the-width-of-the-index-to-a-str-or-existing-values"><strong>Set the width of the index to a str or existing values</strong></h4>
<pre><code class="language-python">set_width_of_index_to_text(text: None | str = None, *args, **kwargs) -&gt; Sheet
</code></pre>
<ul>
<li><code>text</code> (<code>str</code>, <code>None</code>) provide a <code>str</code> to set the width to or use <code>None</code> to set it to existing values in the index.</li>
</ul>
<hr />
<h4 id="set-the-width-of-the-index-to-a-value-in-pixels"><strong>Set the width of the index to a value in pixels</strong></h4>
<pre><code class="language-python">set_index_width(pixels: int, redraw: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li>Note that it disables auto resizing of index. Use <a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-options-and-other-functions"><code>set_options()</code></a> to restore auto resizing.</li>
</ul>
<hr />
<h4 id="set-the-height-of-the-header-to-a-str-or-existing-values"><strong>Set the height of the header to a str or existing values</strong></h4>
<pre><code class="language-python">set_height_of_header_to_text(text: None | str = None) -&gt; Sheet
</code></pre>
<ul>
<li><code>text</code> (<code>str</code>, <code>None</code>) provide a <code>str</code> to set the height to or use <code>None</code> to set it to existing values in the header.</li>
</ul>
<hr />
<h4 id="set-the-height-of-the-header-to-a-value-in-pixels"><strong>Set the height of the header to a value in pixels</strong></h4>
<pre><code class="language-python">set_header_height_pixels(pixels: int, redraw: bool = True) -&gt; Sheet
</code></pre>
<hr />
<h4 id="set-the-height-of-the-header-to-accomodate-a-number-of-lines"><strong>Set the height of the header to accomodate a number of lines</strong></h4>
<pre><code class="language-python">set_header_height_lines(nlines: int, redraw: bool = True) -&gt; Sheet
</code></pre>
<hr />
<h4 id="delete-displayed-column-lines"><strong>Delete displayed column lines</strong></h4>
<pre><code class="language-python">del_column_position(idx: int, deselect_all: bool = False) -&gt; Sheet
del_column_positions(idxs: Iterator[int] | None = None) -&gt; Sheet
</code></pre>
<hr />
<h4 id="delete-displayed-row-lines"><strong>Delete displayed row lines</strong></h4>
<pre><code class="language-python">del_row_position(idx: int, deselect_all: bool = False) -&gt; Sheet
del_row_positions(idxs: Iterator[int] | None = None) -&gt; Sheet
</code></pre>
<hr />
<h4 id="insert-a-displayed-row-line"><strong>Insert a displayed row line</strong></h4>
<pre><code class="language-python">insert_row_position(
    idx: Literal[&quot;end&quot;] | int = &quot;end&quot;,
    height: int | None = None,
    deselect_all: bool = False,
    redraw: bool = False,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="insert-a-displayed-column-line"><strong>Insert a displayed column line</strong></h4>
<pre><code class="language-python">insert_column_position(
    idx: Literal[&quot;end&quot;] | int = &quot;end&quot;,
    width: int | None = None,
    deselect_all: bool = False,
    redraw: bool = False,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="insert-multiple-displayed-row-lines"><strong>Insert multiple displayed row lines</strong></h4>
<pre><code class="language-python">insert_row_positions(
    idx: Literal[&quot;end&quot;] | int = &quot;end&quot;,
    heights: Sequence[float] | int | None = None,
    deselect_all: bool = False,
    redraw: bool = False,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="insert-multiple-displayed-column-lines"><strong>Insert multiple displayed column lines</strong></h4>
<pre><code class="language-python">insert_column_positions(
    idx: Literal[&quot;end&quot;] | int = &quot;end&quot;,
    widths: Sequence[float] | int | None = None,
    deselect_all: bool = False,
    redraw: bool = False,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="set-the-number-of-displayed-row-lines-and-column-lines"><strong>Set the number of displayed row lines and column lines</strong></h4>
<pre><code class="language-python">sheet_display_dimensions(
    total_rows: int | None =None,
    total_columns: int | None =None,
) -&gt; tuple[int, int] | Sheet
</code></pre>
<hr />
<h4 id="move-a-displayed-row-line"><strong>Move a displayed row line</strong></h4>
<pre><code class="language-python">move_row_position(row: int, moveto: int) -&gt; Sheet
</code></pre>
<hr />
<h4 id="move-a-displayed-column-line"><strong>Move a displayed column line</strong></h4>
<pre><code class="language-python">move_column_position(column: int, moveto: int) -&gt; Sheet
</code></pre>
<hr />
<h4 id="get-a-list-of-default-column-width-values"><strong>Get a list of default column width values</strong></h4>
<pre><code class="language-python">get_example_canvas_column_widths(total_cols: int | None = None) -&gt; list[float]
</code></pre>
<hr />
<h4 id="get-a-list-of-default-row-height-values"><strong>Get a list of default row height values</strong></h4>
<pre><code class="language-python">get_example_canvas_row_heights(total_rows: int | None = None) -&gt; list[float]
</code></pre>
<hr />
<h4 id="verify-a-list-of-row-heights-or-canvas-y-coordinates"><strong>Verify a list of row heights or canvas y coordinates</strong></h4>
<pre><code class="language-python">verify_row_heights(row_heights: list[float], canvas_positions: bool = False) -&gt; bool
</code></pre>
<hr />
<h4 id="verify-a-list-of-column-widths-or-canvas-x-coordinates"><strong>Verify a list of column widths or canvas x coordinates</strong></h4>
<pre><code class="language-python">verify_column_widths(column_widths: list[float], canvas_positions: bool = False) -&gt; bool
</code></pre>
<hr />
<h4 id="make-a-row-height-valid"><strong>Make a row height valid</strong></h4>
<pre><code class="language-python">valid_row_height(height: int) -&gt; int
</code></pre>
<hr />
<h4 id="make-a-column-width-valid"><strong>Make a column width valid</strong></h4>
<pre><code class="language-python">valid_column_width(width: int) -&gt; int
</code></pre>
<hr />
<h4 id="get-visible-rows"><strong>Get visible rows</strong></h4>
<pre><code class="language-python">@property
visible_rows() -&gt; tuple[int, int]
</code></pre>
<ul>
<li>Returns start row, end row</li>
<li>e.g. <code>start_row, end_row = sheet.visible_rows</code></li>
</ul>
<hr />
<h4 id="get-visible-columns"><strong>Get visible columns</strong></h4>
<pre><code class="language-python">@property
visible_columns() -&gt; tuple[int, int]
</code></pre>
<ul>
<li>Returns start column, end column</li>
<li>e.g. <code>start_column, end_column = sheet.visible_columns</code></li>
</ul>
<hr />
<h1 id="identifying-bound-event-mouse-position"><strong>Identifying Bound Event Mouse Position</strong></h1>
<p>The below functions require a mouse click event, for example you could bind right click, example <a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-custom-right-click-and-text-editor-functionality">here</a>, and then identify where the user has clicked.</p>
<hr />
<p>Determine if a tk <code>event.widget</code> is the <code>Sheet</code>.</p>
<pre><code class="language-python">event_widget_is_sheet(
    event: object,
    table: bool = True,
    index: bool = True,
    header: bool = True,
    top_left: bool = True,
) -&gt; bool
</code></pre>
<p>Notes:
- Parameters set to <code>True</code> will include events that occurred within that widget.
    - e.g. If an event occurs in the top left corner of the sheet but the parameter <code>top_left</code> is <code>False</code> the function will return <code>False</code>.</p>
<hr />
<p>Check if any Sheet widgets have focus.</p>
<pre><code class="language-python">has_focus() -&gt; bool:
</code></pre>
<ul>
<li>Includes child widgets such as scroll bars.</li>
</ul>
<hr />
<pre><code class="language-python">identify_region(event: object) -&gt; Literal[&quot;table&quot;, &quot;index&quot;, &quot;header&quot;, &quot;top left&quot;]
</code></pre>
<hr />
<pre><code class="language-python">identify_row(
    event: object,
    exclude_index: bool = False,
    allow_end: bool = True,
) -&gt; int | None
</code></pre>
<hr />
<pre><code class="language-python">identify_column(
    event: object,
    exclude_header: bool = False,
    allow_end: bool = True,
) -&gt; int | None
</code></pre>
<hr />
<h4 id="sheet-control-actions"><strong>Sheet control actions</strong></h4>
<p>For example: <code>sheet.bind("&lt;Control-B&gt;", sheet.paste)</code></p>
<pre><code class="language-python">cut(event: object = None, validation: bool = True) -&gt; None | EventDataDict
paste(event: object = None, validation: bool = True) -&gt; None | EventDataDict
delete(event: object = None, validation: bool = True) -&gt; None | EventDataDict
copy(event: object = None) -&gt; None | EventDataDict
undo(event: object = None) -&gt; None | EventDataDict
redo(event: object = None) -&gt; None | EventDataDict
</code></pre>
<ul>
<li><code>validation</code> (<code>bool</code>) when <code>False</code> disables any bound <code>edit_validation()</code> function from running.</li>
</ul>
<hr />
<h1 id="scroll-positions-and-cell-visibility"><strong>Scroll Positions and Cell Visibility</strong></h1>
<h4 id="sync-scroll-positions-between-widgets"><strong>Sync scroll positions between widgets</strong></h4>
<pre><code class="language-python">sync_scroll(widget: object) -&gt; Sheet
</code></pre>
<ul>
<li>Sync scroll positions between <code>Sheet</code>s, may or may not work with other widgets. Uses scrollbar positions.</li>
</ul>
<p>Syncing two sheets:</p>
<pre><code class="language-python">self.sheet1.sync_scroll(self.sheet2)
</code></pre>
<p>Syncing three sheets:</p>
<pre><code class="language-python"># syncs sheet 1 and 2 between each other
self.sheet1.sync_scroll(self.sheet2)

# syncs sheet 1 and 3 between each other
self.sheet1.sync_scroll(self.sheet3)

# syncs sheet 2 and 3 between each other
self.sheet2.sync_scroll(self.sheet3)
</code></pre>
<h4 id="unsync-scroll-positions-between-widgets"><strong>Unsync scroll positions between widgets</strong></h4>
<pre><code class="language-python">unsync_scroll(widget: object = None) -&gt; Sheet
</code></pre>
<ul>
<li>Leaving <code>widget</code> as <code>None</code> unsyncs all previously synced widgets.</li>
</ul>
<h4 id="see-or-scroll-to-a-specific-cell-on-the-sheet"><strong>See or scroll to a specific cell on the sheet</strong></h4>
<pre><code class="language-python">see(
    row: int = 0,
    column: int = 0,
    keep_yscroll: bool = False,
    keep_xscroll: bool = False,
    bottom_right_corner: bool | None = None,
    check_cell_visibility: bool = True,
    redraw: bool = True,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="check-if-a-cell-has-any-part-of-it-visible"><strong>Check if a cell has any part of it visible</strong></h4>
<pre><code class="language-python">cell_visible(r: int, c: int) -&gt; bool
</code></pre>
<hr />
<h4 id="check-if-a-cell-is-totally-visible"><strong>Check if a cell is totally visible</strong></h4>
<pre><code class="language-python">cell_completely_visible(r: int, c: int, seperate_axes: bool = False) -&gt; bool
</code></pre>
<ul>
<li><code>separate_axes</code> returns tuple of bools e.g. <code>(cell y axis is visible, cell x axis is visible)</code></li>
</ul>
<hr />
<pre><code class="language-python">set_xview(position: None | float = None, option: str = &quot;moveto&quot;) -&gt; Sheet | tuple[float, float]
</code></pre>
<p>Notes:
- If <code>position</code> is <code>None</code> then <code>tuple[float, float]</code> of main table <code>xview()</code> is returned.
- <code>xview</code> and <code>xview_moveto</code> have the same behaviour.</p>
<hr />
<pre><code class="language-python">set_yview(position: None | float = None, option: str = &quot;moveto&quot;) -&gt; Sheet | tuple[float, float]
</code></pre>
<ul>
<li>If <code>position</code> is <code>None</code> then <code>tuple[float, float]</code> of main table <code>yview()</code> is returned.</li>
<li><code>yview</code> and <code>yview_moveto</code> have the same behaviour.</li>
</ul>
<hr />
<pre><code class="language-python">get_xview() -&gt; tuple[float, float]
</code></pre>
<hr />
<pre><code class="language-python">get_yview() -&gt; tuple[float, float]
</code></pre>
<hr />
<pre><code class="language-python">set_view(x_args: [str, float], y_args: [str, float]) -&gt; Sheet
</code></pre>
<hr />
<h1 id="hiding-columns"><strong>Hiding Columns</strong></h1>
<p>Note that once you have hidden columns you can use the function <code>displayed_column_to_data(column)</code> to retrieve a column data index from a displayed index.</p>
<h4 id="display-only-certain-columns"><strong>Display only certain columns</strong></h4>
<pre><code class="language-python">display_columns(
    columns: None | Literal[&quot;all&quot;] | Iterator[int] = None,
    all_columns_displayed: None | bool = None,
    reset_col_positions: bool = True,
    refresh: bool = False,
    redraw: bool = False,
    deselect_all: bool = True,
    **kwargs,
) -&gt; list[int] | None
</code></pre>
<p>Parameters:
- <code>columns</code> (<code>int</code>, <code>iterable</code>, <code>"all"</code>) are the columns to be displayed, omit the columns to be hidden.
- Use argument <code>True</code> with <code>all_columns_displayed</code> to display all columns, use <code>False</code> to display only the columns you've set using the <code>columns</code> arg.
- You can also use the keyword argument <code>all_displayed</code> instead of <code>all_columns_displayed</code>.</p>
<p>Examples:</p>
<pre><code class="language-python"># display all columns
self.sheet.display_columns(&quot;all&quot;)

# displaying specific columns only
self.sheet.display_columns([2, 4, 7], all_displayed = False)
</code></pre>
<hr />
<h4 id="get-all-columns-displayed-boolean"><strong>Get all columns displayed boolean</strong></h4>
<p><strong>Get the bool</strong></p>
<pre><code class="language-python">@property
all_columns()
</code></pre>
<ul>
<li>e.g. <code>get_all_columns_displayed = sheet.all_columns</code>.</li>
</ul>
<p><strong>Set the bool</strong></p>
<pre><code class="language-python">@all_columns.setter
all_columns(a: bool)
</code></pre>
<p>e.g. <code>sheet.all_columns = True</code>.</p>
<pre><code class="language-python">all_columns_displayed(a: bool | None = None) -&gt; bool
</code></pre>
<ul>
<li><code>a</code> (<code>bool</code>, <code>None</code>) Either set by using <code>bool</code> or get by leaving <code>None</code> e.g. <code>all_columns_displayed()</code>.</li>
</ul>
<hr />
<h4 id="hide-specific-columns"><strong>Hide specific columns</strong></h4>
<pre><code class="language-python">hide_columns(
    columns: int | set | Iterator[int] = set(),
    redraw: bool = True,
    deselect_all: bool = True,
    data_indexes: bool = False,
) -&gt; Sheet
</code></pre>
<p>Parameters:
- <strong>NOTE</strong>: <code>columns</code> (<code>int</code>) by default uses displayed column indexes, not data indexes. In other words the indexes of the columns displayed on the screen are the ones that are hidden, this is useful when used in conjunction with <code>get_selected_columns()</code>.
- <code>data_indexes</code> when <code>False</code> it makes the <code>columns</code> parameter indexes represent displayed columns and not the underlying Sheet data columns. When <code>True</code> the indexes represent data indexes.</p>
<p>Example:</p>
<pre><code class="language-python">columns_to_hide = set(sheet.data_c(c) for c in sheet.get_selected_columns())
sheet.hide_columns(
    columns_to_hide,
    data_indexes=True,
)
</code></pre>
<hr />
<h4 id="unhide-specific-columns"><strong>Unhide specific columns</strong></h4>
<pre><code class="language-python">show_columns(
    columns: int | Iterator[int],
    redraw: bool = True,
    deselect_all: bool = True,
) -&gt; Sheet
</code></pre>
<p>Parameters:
- <strong>NOTE</strong>: <code>columns</code> (<code>int</code>) uses data column indexes, not displayed indexes. In other words the indexes of the columns which represent the underlying data are shown.</p>
<p>Notes:
- Will return if all columns are currently displayed (<code>Sheet.all_columns</code>).</p>
<p>Example:</p>
<pre><code class="language-python"># converting displayed column indexes to data indexes using data_c(c)
columns = set(sheet.data_c(c) for c in sheet.get_selected_columns())

# hiding columns
sheet.hide_columns(
    columns,
    data_indexes=True,
)

# showing them again
sheet.show_columns(columns)
</code></pre>
<hr />
<h4 id="displayed-column-index-to-data"><strong>Displayed column index to data</strong></h4>
<p>Convert a displayed column index to a data index. If the internal <code>all_columns_displayed</code> attribute is <code>True</code> then it will return the provided argument.</p>
<pre><code class="language-python">displayed_column_to_data(c)
data_c(c)
</code></pre>
<hr />
<h4 id="get-currently-displayed-columns"><strong>Get currently displayed columns</strong></h4>
<pre><code class="language-python">@property
displayed_columns() -&gt; list[int]
</code></pre>
<ul>
<li>e.g. <code>columns = sheet.displayed_columns</code></li>
</ul>
<hr />
<h1 id="hiding-rows"><strong>Hiding Rows</strong></h1>
<p>Note that once you have hidden rows you can use the function <code>displayed_row_to_data(row)</code> to retrieve a row data index from a displayed index.</p>
<h4 id="display-only-certain-rows"><strong>Display only certain rows</strong></h4>
<pre><code class="language-python">display_rows(
    rows: None | Literal[&quot;all&quot;] | Iterator[int] = None,
    all_rows_displayed: None | bool = None,
    reset_row_positions: bool = True,
    refresh: bool = False,
    redraw: bool = False,
    deselect_all: bool = True,
    **kwargs,
) -&gt; list[int] | None
</code></pre>
<p>Parameters:
- <code>rows</code> (<code>int</code>, <code>iterable</code>, <code>"all"</code>) are the rows to be displayed, omit the rows to be hidden.
- Use argument <code>True</code> with <code>all_rows_displayed</code> to display all rows, use <code>False</code> to display only the rows you've set using the <code>rows</code> arg.
- You can also use the keyword argument <code>all_displayed</code> instead of <code>all_rows_displayed</code>.</p>
<p>Examples:
- An example of row filtering using this function can be found <a href="https://github.com/ragardner/tksheet/wiki/Version-7#example-header-dropdown-boxes-and-row-filtering">here</a>.
- More examples below:</p>
<pre><code class="language-python"># display all rows
self.sheet.display_rows(&quot;all&quot;)

# display specific rows only
self.sheet.display_rows([2, 4, 7], all_displayed = False)
</code></pre>
<hr />
<h4 id="hide-specific-rows"><strong>Hide specific rows</strong></h4>
<pre><code class="language-python">hide_rows(
    rows: int | set | Iterator[int] = set(),
    redraw: bool = True,
    deselect_all: bool = True,
    data_indexes: bool = False,
) -&gt; Sheet
</code></pre>
<p>Parameters:
- <strong>NOTE</strong>: <code>rows</code> (<code>int</code>) by default uses displayed row indexes, not data indexes. In other words the indexes of the rows displayed on the screen are the ones that are hidden, this is useful when used in conjunction with <code>get_selected_rows()</code>.
- <code>data_indexes</code> when <code>False</code> it makes the <code>rows</code> parameter indexes represent displayed rows and not the underlying Sheet data rows. When <code>True</code> the indexes represent data indexes.</p>
<p>Example:</p>
<pre><code class="language-python">rows_to_hide = set(sheet.data_r(r) for r in sheet.get_selected_rows())
sheet.hide_rows(
    rows_to_hide,
    data_indexes=True,
)
</code></pre>
<hr />
<h4 id="unhide-specific-rows"><strong>Unhide specific rows</strong></h4>
<pre><code class="language-python">show_rows(
    rows: int | Iterator[int],
    redraw: bool = True,
    deselect_all: bool = True,
) -&gt; Sheet
</code></pre>
<p>Parameters:
- <strong>NOTE</strong>: <code>rows</code> (<code>int</code>) uses data row indexes, not displayed indexes. In other words the indexes of the rows which represent the underlying data are shown.</p>
<p>Notes:
- Will return if all rows are currently displayed (<code>Sheet.all_rows</code>).</p>
<p>Example:</p>
<pre><code class="language-python"># converting displayed row indexes to data indexes using data_r(r)
rows = set(sheet.data_r(r) for r in sheet.get_selected_rows())

# hiding rows
sheet.hide_rows(
    rows,
    data_indexes=True,
)

# showing them again
sheet.show_rows(rows)
</code></pre>
<hr />
<h4 id="get-or-set-the-all-rows-displayed-boolean"><strong>Get or set the all rows displayed boolean</strong></h4>
<p><strong>Get the bool</strong></p>
<pre><code class="language-python">@property
all_rows()
</code></pre>
<ul>
<li>e.g. <code>get_all_rows_displayed = sheet.all_rows</code>.</li>
</ul>
<p><strong>Set the bool</strong></p>
<pre><code class="language-python">@all_rows.setter
all_rows(a: bool)
</code></pre>
<p>e.g. <code>sheet.all_rows = True</code>.</p>
<pre><code class="language-python">all_rows_displayed(a: bool | None = None) -&gt; bool
</code></pre>
<ul>
<li><code>a</code> (<code>bool</code>, <code>None</code>) Either set by using <code>bool</code> or get by leaving <code>None</code> e.g. <code>all_rows_displayed()</code>.</li>
</ul>
<hr />
<h4 id="displayed-row-index-to-data"><strong>Displayed row index to data</strong></h4>
<p>Convert a displayed row index to a data index. If the internal <code>all_rows_displayed</code> attribute is <code>True</code> then it will return the provided argument.</p>
<pre><code class="language-python">displayed_row_to_data(r)
data_r(r)
</code></pre>
<hr />
<h4 id="get-currently-displayed-rows"><strong>Get currently displayed rows</strong></h4>
<pre><code class="language-python">@property
displayed_rows() -&gt; list[int]
</code></pre>
<ul>
<li>e.g. <code>rows = sheet.displayed_rows</code></li>
</ul>
<hr />
<h1 id="hiding-sheet-elements"><strong>Hiding Sheet Elements</strong></h1>
<h4 id="hide-parts-of-the-sheet-or-all-of-it"><strong>Hide parts of the Sheet or all of it</strong></h4>
<pre><code class="language-python">hide(
    canvas: Literal[
        &quot;all&quot;,
        &quot;row_index&quot;,
        &quot;header&quot;,
        &quot;top_left&quot;,
        &quot;x_scrollbar&quot;,
        &quot;y_scrollbar&quot;,
    ] = &quot;all&quot;,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>canvas</code> (<code>str</code>) options are <code>all</code>, <code>row_index</code>, <code>header</code>, <code>top_left</code>, <code>x_scrollbar</code>, <code>y_scrollbar</code><ul>
<li><code>all</code> hides the entire table and is the default.</li>
</ul>
</li>
</ul>
<hr />
<h4 id="show-parts-of-the-sheet-or-all-of-it"><strong>Show parts of the Sheet or all of it</strong></h4>
<pre><code class="language-python">show(
    canvas: Literal[
        &quot;all&quot;,
        &quot;row_index&quot;,
        &quot;header&quot;,
        &quot;top_left&quot;,
        &quot;x_scrollbar&quot;,
        &quot;y_scrollbar&quot;,
    ] = &quot;all&quot;,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>canvas</code> (<code>str</code>) options are <code>all</code>, <code>row_index</code>, <code>header</code>, <code>top_left</code>, <code>x_scrollbar</code>, <code>y_scrollbar</code><ul>
<li><code>all</code> shows the entire table and is the default.</li>
</ul>
</li>
</ul>
<hr />
<h1 id="sheet-height-and-width"><strong>Sheet Height and Width</strong></h1>
<h4 id="modify-widget-height-and-width-in-pixels"><strong>Modify widget height and width in pixels</strong></h4>
<pre><code class="language-python">height_and_width(
    height: int | None = None,
    width: int | None = None,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>height</code> (<code>int</code>, <code>None</code>) set a height in pixels.</li>
<li><code>width</code> (<code>int</code>, <code>None</code>) set a width in pixels.
If both arguments are <code>None</code> then table will reset to default tkinter canvas dimensions.</li>
</ul>
<hr />
<pre><code class="language-python">get_frame_y(y: int) -&gt; int
</code></pre>
<ul>
<li>Adds the height of the Sheets header to a y position.</li>
</ul>
<hr />
<pre><code class="language-python">get_frame_x(x: int) -&gt; int
</code></pre>
<ul>
<li>Adds the width of the Sheets index to an x position.</li>
</ul>
<hr />
<h1 id="cell-text-editor"><strong>Cell Text Editor</strong></h1>
<h4 id="open-the-currently-selected-cell-in-the-main-table"><strong>Open the currently selected cell in the main table</strong></h4>
<pre><code class="language-python">open_cell(ignore_existing_editor: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li>Function utilises the currently selected cell in the main table, even if a column/row is selected, to open a non selected cell first use <code>set_currently_selected()</code> to set the cell to open.</li>
</ul>
<hr />
<h4 id="open-the-currently-selected-cell-but-in-the-header"><strong>Open the currently selected cell but in the header</strong></h4>
<pre><code class="language-python">open_header_cell(ignore_existing_editor: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li>Also uses currently selected cell, which you can set with <code>set_currently_selected()</code>.</li>
</ul>
<hr />
<h4 id="open-the-currently-selected-cell-but-in-the-index"><strong>Open the currently selected cell but in the index</strong></h4>
<pre><code class="language-python">open_index_cell(ignore_existing_editor: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li>Also uses currently selected cell, which you can set with <code>set_currently_selected()</code>.</li>
</ul>
<hr />
<h4 id="set-the-cell-text-editor-value-if-it-is-open"><strong>Set the cell text editor value if it is open</strong></h4>
<p><strong>Table:</strong></p>
<pre><code class="language-python">set_text_editor_value(
    text: str = &quot;&quot;,
) -&gt; Sheet
</code></pre>
<p><strong>Index:</strong></p>
<pre><code class="language-python">set_index_text_editor_value(
    text: str = &quot;&quot;,
) -&gt; Sheet
</code></pre>
<p><strong>Header:</strong></p>
<pre><code class="language-python">set_header_text_editor_value(
    text: str = &quot;&quot;,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="close-any-existing-text-editor"><strong>Close any existing text editor</strong></h4>
<pre><code class="language-python">close_text_editor(set_data: bool = True) -&gt; Sheet
</code></pre>
<p>Notes:
- Closes any open text editors, including header and index.
- Also closes any existing <code>"normal"</code> state dropdown box.</p>
<p>Parameters:
- <code>set_data</code> (<code>bool</code>) when <code>True</code> sets the cell data to the text editor value (if it is valid). When <code>False</code> the text editor is closed without setting data.</p>
<hr />
<h4 id="get-an-existing-text-editors-value"><strong>Get an existing text editors value</strong></h4>
<pre><code class="language-python">get_text_editor_value() -&gt; str | None
</code></pre>
<p>Notes:
- <code>None</code> is returned if no text editor exists, a <code>str</code> of the text editors value will be returned if it does.</p>
<hr />
<h4 id="hide-all-text-editors"><strong>Hide all text editors</strong></h4>
<pre><code class="language-python">destroy_text_editor(event: object = None) -&gt; Sheet
</code></pre>
<hr />
<h4 id="get-the-table-tk-text-widget-which-acts-as-the-text-editor"><strong>Get the table tk Text widget which acts as the text editor</strong></h4>
<pre><code class="language-python">get_text_editor_widget(event: object = None) -&gt; tk.Text | None
</code></pre>
<hr />
<h4 id="bind-additional-keys-to-the-text-editor-window"><strong>Bind additional keys to the text editor window</strong></h4>
<pre><code class="language-python">bind_key_text_editor(key: str, function: Callable) -&gt; Sheet
</code></pre>
<hr />
<h4 id="unbind-additional-text-editors-bindings-set-using-the-above-function"><strong>Unbind additional text editors bindings set using the above function</strong></h4>
<pre><code class="language-python">unbind_key_text_editor(key: str) -&gt; Sheet
</code></pre>
<hr />
<h1 id="sheet-options-and-other-functions"><strong>Sheet Options and Other Functions</strong></h1>
<pre><code class="language-python">set_options(redraw: bool = True, **kwargs) -&gt; Sheet
</code></pre>
<p>The list of key word arguments available for <code>set_options()</code> are as follows, <a href="https://github.com/ragardner/tksheet/wiki/Version-7#initialization-options">see here</a> as a guide for argument types.</p>
<pre><code class="language-python">name

show_top_left

sort_key
edit_cell_tab
edit_cell_return
editor_del_key
auto_resize_columns
auto_resize_rows
to_clipboard_delimiter
to_clipboard_quotechar
to_clipboard_lineterminator
from_clipboard_delimiters
show_dropdown_borders
show_default_header_for_empty
show_default_index_for_empty
selected_rows_to_end_of_window
horizontal_grid_to_end_of_window
vertical_grid_to_end_of_window
paste_insert_column_limit
paste_insert_row_limit
paste_can_expand_x
paste_can_expand_y
arrow_key_down_right_scroll_page
enable_edit_cell_auto_resize
page_up_down_select_row
display_selected_fg_over_highlights
show_horizontal_grid
show_vertical_grid
empty_horizontal
empty_vertical
default_row_height
default_column_width
default_header_height
default_row_index_width
row_drag_and_drop_perform
column_drag_and_drop_perform
auto_resize_default_row_index
default_header
default_row_index
min_column_width
max_column_width
max_row_height
max_header_height
max_index_width
font
header_font
index_font

show_selected_cells_border
theme
top_left_bg
top_left_fg
top_left_fg_highlight

table_bg
table_grid_fg
table_fg
table_selected_box_cells_fg
table_selected_box_rows_fg
table_selected_box_columns_fg
table_selected_cells_border_fg
table_selected_cells_bg
table_selected_cells_fg
table_selected_rows_border_fg
table_selected_rows_bg
table_selected_rows_fg
table_selected_columns_border_fg
table_selected_columns_bg
table_selected_columns_fg

header_bg
header_border_fg
header_grid_fg
header_fg
header_selected_cells_bg
header_selected_cells_fg
header_selected_columns_bg
header_selected_columns_fg

index_bg
index_border_fg
index_grid_fg
index_fg
index_selected_cells_bg
index_selected_cells_fg
index_selected_rows_bg
index_selected_rows_fg

resizing_line_fg
drag_and_drop_bg
outline_thickness
outline_color
frame_bg
popup_menu_font
popup_menu_fg
popup_menu_bg
popup_menu_highlight_bg
popup_menu_highlight_fg

# scroll bars
vertical_scroll_background
horizontal_scroll_background
vertical_scroll_troughcolor
horizontal_scroll_troughcolor
vertical_scroll_lightcolor
horizontal_scroll_lightcolor
vertical_scroll_darkcolor
horizontal_scroll_darkcolor
vertical_scroll_bordercolor
horizontal_scroll_bordercolor
vertical_scroll_active_bg
horizontal_scroll_active_bg
vertical_scroll_not_active_bg
horizontal_scroll_not_active_bg
vertical_scroll_pressed_bg
horizontal_scroll_pressed_bg
vertical_scroll_active_fg
horizontal_scroll_active_fg
vertical_scroll_not_active_fg
horizontal_scroll_not_active_fg
vertical_scroll_pressed_fg
horizontal_scroll_pressed_fg
scrollbar_theme_inheritance
scrollbar_show_arrows
vertical_scroll_arrowsize
horizontal_scroll_arrowsize
vertical_scroll_borderwidth
horizontal_scroll_borderwidth
vertical_scroll_gripcount
horizontal_scroll_gripcount

# for changing the in-built right click menus labels
# use a string as an argument

sort_cells_label
sort_cells_x_label
sort_row_label
sort_column_label
sort_rows_label
sort_columns_label
sort_cells_reverse_label
sort_cells_x_reverse_label
sort_row_reverse_label
sort_column_reverse_label
sort_rows_reverse_label
sort_columns_reverse_label
sort_cells_accelerator
sort_cells_x_accelerator
sort_row_accelerator
sort_column_accelerator
sort_rows_accelerator
sort_columns_accelerator
sort_cells_reverse_accelerator
sort_cells_x_reverse_accelerator
sort_row_reverse_accelerator
sort_column_reverse_accelerator
sort_rows_reverse_accelerator
sort_columns_reverse_accelerator

edit_header_label
edit_header_accelerator
edit_index_label
edit_index_accelerator
edit_cell_label
edit_cell_accelerator
cut_label
cut_accelerator
cut_contents_label
cut_contents_accelerator
copy_label
copy_accelerator
copy_contents_label
copy_contents_accelerator
paste_label
paste_accelerator
delete_label
delete_accelerator
clear_contents_label
clear_contents_accelerator
delete_columns_label
delete_columns_accelerator
insert_columns_left_label
insert_columns_left_accelerator
insert_column_label
insert_column_accelerator
insert_columns_right_label
insert_columns_right_accelerator
delete_rows_label
delete_rows_accelerator
insert_rows_above_label
insert_rows_above_accelerator
insert_rows_below_label
insert_rows_below_accelerator
insert_row_label
insert_row_accelerator
select_all_label
select_all_accelerator
undo_label
undo_accelerator

# for changing the keyboard bindings for copy, paste, etc.
# use a list of strings as an argument
copy_bindings
cut_bindings
paste_bindings
undo_bindings
redo_bindings
delete_bindings
select_all_bindings
select_columns_bindings
select_rows_bindings
row_start_bindings
table_start_bindings
tab_bindings
up_bindings
right_bindings
down_bindings
left_bindings
shift_up_bindings
shift_right_bindings
shift_down_bindings
shift_left_bindings
prior_bindings
next_bindings
</code></pre>
<p>Notes:
- A dictionary can be provided instead of using the keyword arguments:</p>
<pre><code class="language-python">kwargs = {
    &quot;copy_bindings&quot;: [
        &quot;&lt;Control-g&gt;&quot;,
        &quot;&lt;Control-G&gt;&quot;,
    ],
    &quot;cut_bindings&quot;: [
        &quot;&lt;Control-c&gt;&quot;,
        &quot;&lt;Control-C&gt;&quot;,
    ],
}
sheet.set_options(**kwargs)
</code></pre>
<hr />
<p>Get internal storage dictionary of highlights, readonly cells, dropdowns etc. Specifically for cell options.</p>
<pre><code class="language-python">get_cell_options(key: None | str = None, canvas: Literal[&quot;table&quot;, &quot;row_index&quot;, &quot;header&quot;] = &quot;table&quot;) -&gt; dict
</code></pre>
<hr />
<p>Get internal storage dictionary of highlights, readonly rows, dropdowns etc. Specifically for row options.</p>
<pre><code class="language-python">get_row_options(key: None | str = None) -&gt; dict
</code></pre>
<hr />
<p>Get internal storage dictionary of highlights, readonly columns, dropdowns etc. Specifically for column options.</p>
<pre><code class="language-python">get_column_options(key: None | str = None) -&gt; dict
</code></pre>
<hr />
<p>Get internal storage dictionary of highlights, readonly header cells, dropdowns etc. Specifically for header options.</p>
<pre><code class="language-python">get_header_options(key: None | str = None) -&gt; dict
</code></pre>
<hr />
<p>Get internal storage dictionary of highlights, readonly row index cells, dropdowns etc. Specifically for row index options.</p>
<pre><code class="language-python">get_index_options(key: None | str = None) -&gt; dict
</code></pre>
<hr />
<p>Delete any formats, alignments, dropdown boxes, check boxes, highlights etc. that are larger than the sheets currently held data, includes row index and header in measurement of dimensions.</p>
<pre><code class="language-python">del_out_of_bounds_options() -&gt; Sheet
</code></pre>
<hr />
<p>Delete all alignments, dropdown boxes, check boxes, highlights etc.</p>
<pre><code class="language-python">reset_all_options() -&gt; Sheet
</code></pre>
<hr />
<p>Flash a dashed box of chosen dimensions.</p>
<pre><code class="language-python">show_ctrl_outline(
    canvas: Literal[&quot;table&quot;] = &quot;table&quot;,
    start_cell: tuple[int, int] = (0, 0),
    end_cell: tuple[int, int] = (1, 1),
) -&gt; Sheet
</code></pre>
<hr />
<p>Various functions related to the Sheets internal undo and redo stacks.</p>
<pre><code class="language-python"># clears both undos and redos
reset_undos() -&gt; Sheet

# get the Sheets modifiable deque variables which store changes for undo and redo
get_undo_stack() -&gt; deque
get_redo_stack() -&gt; deque

# set the Sheets undo and redo stacks, returns Sheet widget
set_undo_stack(stack: deque) -&gt; Sheet
set_redo_stack(stack: deque) -&gt; Sheet
</code></pre>
<hr />
<p>Refresh the table.</p>
<pre><code class="language-python">refresh(redraw_header: bool = True, redraw_row_index: bool = True) -&gt; Sheet
</code></pre>
<hr />
<p>Refresh the table.</p>
<pre><code class="language-python">redraw(redraw_header: bool = True, redraw_row_index: bool = True) -&gt; Sheet
</code></pre>
<hr />
<h1 id="treeview-mode"><strong>Treeview Mode</strong></h1>
<p>tksheet has a treeview mode which behaves similarly to the ttk treeview widget, it is not a drop in replacement for it though.</p>
<p>Always either use a fresh <code>Sheet()</code> instance or use <a href="https://github.com/ragardner/tksheet/wiki/Version-7#reset-all-or-specific-sheet-elements-and-attributes">Sheet.reset()</a> before enabling treeview mode.</p>
<h3 id="to-note"><strong>TO NOTE:</strong></h3>
<ul>
<li>When treeview mode is enabled the row index is a <code>list</code> of <code>Node</code> objects. The row index should not be modified by the usual <code>row_index()</code> function.</li>
<li>Most other tksheet functions should work as normal.</li>
<li>The index text alignment must be <code>"w"</code> aka west or left.</li>
</ul>
<h2 id="creating-a-treeview-mode-sheet"><strong>Creating a treeview mode sheet</strong></h2>
<p>You can make a treeview mode sheet by using the initialization parameter <code>treeview</code>:</p>
<pre><code class="language-python">sheet = Sheet(parent, treeview=True)
</code></pre>
<p>Or by using <a href="https://github.com/ragardner/tksheet/wiki/Version-7#reset-all-or-specific-sheet-elements-and-attributes"><code>Sheet.reset()</code></a> and <a href="https://github.com/ragardner/tksheet/wiki/Version-7#sheet-options-and-other-functions"><code>Sheet.set_options()</code></a>.</p>
<pre><code class="language-python">my_sheet.reset()
my_sheet.set_options(treeview=True)
</code></pre>
<p>See the other sections on sheet initialization and examples for the other usual <code>Sheet()</code> parameters.</p>
<h2 id="treeview-mode-functions"><strong>Treeview mode functions</strong></h2>
<p>Functions designed for use with treeview mode.</p>
<h4 id="insert-an-item"><strong>Insert an item</strong></h4>
<pre><code class="language-python">insert(
    parent: str = &quot;&quot;,
    index: None | int | Literal[&quot;end&quot;] = None,
    iid: None | str = None,
    text: None | str = None,
    values: None | list[object] = None,
    create_selections: bool = False,
    undo: bool = True,
) -&gt; str
</code></pre>
<p>Parameters:
- <code>parent</code> is the <code>iid</code> of the parent item (if any). If left as <code>""</code> then the item will not have a parent.
- <code>index</code> is the row number for the item to be placed at, leave as <code>None</code> for the end.
- <code>iid</code> is a new and unique item id. It will be generated automatically if left as <code>None</code>.
- <code>text</code> is the displayed text in the row index for the item.
- <code>values</code> is a list of values which will become the items row in the sheet.
- <code>create_selections</code> when <code>True</code> selects the row that has just been created.
- <code>undo</code> when <code>True</code> adds the change to the undo stack.</p>
<p>Notes:
- Returns the <code>iid</code>.</p>
<p>Example:</p>
<pre><code class="language-python">sheet.insert(
    iid=&quot;top level&quot;,
    text=&quot;Top level&quot;,
    values=[&quot;cell A1&quot;, &quot;cell B1&quot;],
)
sheet.insert(
    parent=&quot;top level&quot;,
    iid=&quot;mid level&quot;,
    text=&quot;Mid level&quot;,
    values=[&quot;cell A2&quot;, &quot;cell B2&quot;],
)
</code></pre>
<hr />
<h4 id="insert-multiple-items"><strong>Insert multiple items</strong></h4>
<pre><code class="language-python">bulk_insert(
    data: list[list[object]],
    parent: str = &quot;&quot;,
    index: None | int | Literal[&quot;end&quot;] = None,
    iid_column: int | None = None,
    text_column: int | None | str = None,
    create_selections: bool = False,
    include_iid_column: bool = True,
    include_text_column: bool = True,
    undo: bool = True,
) -&gt; dict[str, int]
</code></pre>
<p>Parameters:
- <code>parent</code> is the <code>iid</code> of the parent item (if any). If left as <code>""</code> then the items will not have a parent.
- <code>index</code> is the row number for the items to be placed at, leave as <code>None</code> for the end.
- <code>iid_column</code> if left as <code>None</code> iids will be automatically generated for the new items, else you can specify a column in the <code>data</code> which contains the iids.
- <code>text_column</code>:
    - If left as <code>None</code> there will be no displayed text next to the items.
    - A text column can be provided in the data and <code>text_column</code> set to an <code>int</code> representing its index to provide the displayed text for the items.
    - Or if a <code>str</code> is used all items will have that <code>str</code> as their displayed text.
- <code>create_selections</code> when <code>True</code> selects the row that has just been created.
- <code>include_iid_column</code> when <code>False</code> excludes the iid column from the inserted rows.
- <code>include_text_column</code> when the <code>text_column</code> is an <code>int</code> setting this to <code>False</code> excludes that column from the treeview.
- <code>undo</code> when <code>True</code> adds the change to the undo stack.</p>
<p>Notes:
- Returns a <code>dict[str, int]</code> of key: new iids, value: their data row number.</p>
<p>Example:</p>
<pre><code class="language-python">sheet.insert(iid=&quot;ID-1&quot;, text=&quot;ID-1&quot;, values=[&quot;ID 1 Value&quot;])
sheet.bulk_insert(
    data=[
        [&quot;CID-1&quot;, &quot;CID 1 Value&quot;],
        [&quot;CID-2&quot;, &quot;CID 2 Value&quot;],
    ],
    parent=&quot;ID-1&quot;,
    iid_column=0,
    text_column=0,
    include_iid_column=False,
    include_text_column=False,
)
</code></pre>
<hr />
<h4 id="build-a-tree-from-data"><strong>Build a tree from data</strong></h4>
<p>This takes a list of lists where sublists are rows and a few arguments to bulk insert items into the treeview. <strong>Note that</strong>:
- <strong>It resets the sheet</strong> so cannot be used to bulk add to an already existing treeview.</p>
<pre><code class="language-python">tree_build(
    data: list[list[object]],
    iid_column: int,
    parent_column: int,
    text_column: None | int = None,
    push_ops: bool = False,
    row_heights: Sequence[int] | None | False = None,
    open_ids: Iterator[str] | None = None,
    safety: bool = True,
    ncols: int | None = None,
    lower: bool = False,
    include_iid_column: bool = True,
    include_parent_column: bool = True,
    include_text_column: bool = True,
) -&gt; Sheet
</code></pre>
<p>Parameters:
- <code>data</code> a list of lists, one column must be an iid column, another must be a parent iid column.
- <code>text_column</code> if an <code>int</code> is used then the values in that column will populate the row index.
- <code>push_ops</code> when <code>True</code> the newly inserted rows will push all existing sheet options such as highlights downwards.
- <code>row_heights</code> a <code>list</code> of <code>int</code>s can be used to provide the displayed row heights in pixels (does not include hidden items). Only use if you know what you're doing here.
- <code>open_ids</code> a list of iids which will be opened.
- <code>safety</code> when <code>True</code> checks for infinite loops, empty iid cells and duplicate iids. No error or warning will be generated.
    - In the case of infinite loops the parent iid cell will be cleared.
    - In the case of empty iid cells the row will be ignored.
    - In the case of duplicate iids they will be renamed and <code>"DUPLICATED_&lt;number&gt;"</code> will be attached to the end.
- <code>ncols</code> is like maximum columns, an <code>int</code> which limits the number of columns that are included in the loaded data.
- <code>lower</code> makes all item ids - iids lower case.
- <code>include_iid_column</code> when <code>False</code> excludes the iid column from the inserted rows.
- <code>include_parent_column</code> when <code>False</code> excludes the parent column from the inserted rows.
- <code>include_text_column</code> when the <code>text_column</code> is an <code>int</code> setting this to <code>False</code> excludes that column from the treeview.</p>
<p>Notes:
- Returns the <code>Sheet</code> object.</p>
<p>Example:</p>
<pre><code class="language-python">data = [
    [&quot;id1&quot;, &quot;&quot;, &quot;id1 val&quot;],
    [&quot;id2&quot;, &quot;id1&quot;, &quot;id2 val&quot;],
]
sheet.tree_build(
    data=data,
    iid_column=0,
    parent_column=1,
    include_iid_column=False,
    include_parent_column=False,
)
</code></pre>
<hr />
<h4 id="reset-the-treeview"><strong>Reset the treeview</strong></h4>
<pre><code class="language-python">tree_reset() -&gt; Sheet
</code></pre>
<hr />
<h4 id="get-treeview-iids-that-are-open"><strong>Get treeview iids that are open</strong></h4>
<pre><code class="language-python">tree_get_open() -&gt; set[str]
</code></pre>
<hr />
<h4 id="set-the-open-treeview-iids"><strong>Set the open treeview iids</strong></h4>
<pre><code class="language-python">tree_set_open(open_ids: Iterator[str]) -&gt; Sheet
</code></pre>
<ul>
<li>Any other iids are closed as a result.</li>
</ul>
<hr />
<h4 id="open-treeview-iids"><strong>Open treeview iids</strong></h4>
<pre><code class="language-python">tree_open(*items, redraw: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li>Opens all given iids.</li>
</ul>
<hr />
<h4 id="close-treeview-iids"><strong>Close treeview iids</strong></h4>
<pre><code class="language-python">tree_close(*items, redraw: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li>Closes all given iids.</li>
</ul>
<hr />
<h4 id="set-or-get-an-iids-attributes"><strong>Set or get an iids attributes</strong></h4>
<pre><code class="language-python">item(
    item: str,
    iid: str | None = None,
    text: str | None = None,
    values: list | None = None,
    open_: bool | None = None,
    undo: bool = True,
    emit_event: bool = True,
    redraw: bool = True,
) -&gt; DotDict | Sheet
</code></pre>
<p>Parameters:
- <code>item</code> iid, required argument.
- <code>iid</code> use a <code>str</code> to rename the iid.
- <code>text</code> use a <code>str</code> to get the iid new display text in the row index.
- <code>values</code> use a <code>list</code> of values to give the item a new row of values (does not include row index).
- <code>open_</code> use a <code>bool</code> to set the item as open or closed. <code>False</code> is closed.
- <code>undo</code> adds any changes to the undo stack.
- <code>emit_event</code> emits a <code>&lt;&lt;SheetModified&gt;&gt;</code> event if changes were made.</p>
<p>Notes:
- If no arguments are given a <code>DotDict</code> is returned with the item attributes.</p>
<pre><code class="language-python">{
    &quot;text&quot;: ...,
    &quot;values&quot;: ...,
    &quot;open_&quot;: ...,
}
</code></pre>
<hr />
<h4 id="get-an-iids-row-number"><strong>Get an iids row number</strong></h4>
<pre><code class="language-python">itemrow(item: str) -&gt; int
</code></pre>
<ul>
<li>Includes hidden rows in counting row numbers.</li>
</ul>
<hr />
<h4 id="get-a-row-numbers-item"><strong>Get a row numbers item</strong></h4>
<pre><code class="language-python">rowitem(row: int, data_index: bool = False) -&gt; str | None
</code></pre>
<ul>
<li>Includes hidden rows in counting row numbers. See <a href="https://github.com/ragardner/tksheet/wiki/Version-7#hiding-rows">here</a> for more information.</li>
</ul>
<hr />
<h4 id="get-treeview-children"><strong>Get treeview children</strong></h4>
<pre><code class="language-python">get_children(item: None | str = None) -&gt; Generator[str]
</code></pre>
<ul>
<li><code>item</code>:<ul>
<li>When left as <code>None</code> will return all iids currently in treeview, including hidden rows.</li>
<li>Use an empty <code>str</code> (<code>""</code>) to get all top level iids in the treeview.</li>
<li>Use an iid to get the children for that particular iid. Does not include all descendants.</li>
</ul>
</li>
</ul>
<pre><code class="language-python">tree_traverse(item: None | str = None) -&gt; Generator[str]:
</code></pre>
<ul>
<li>Exactly the same as above but instead of retrieving iids from the index list it gets top iids and uses traversal to iterate through descendants.</li>
</ul>
<hr />
<h4 id="get-item-descendants"><strong>Get item descendants</strong></h4>
<pre><code class="language-python">descendants(item: str, check_open: bool = False) -&gt; Generator[str]:
</code></pre>
<ul>
<li>Returns a generator which yields item ids in depth first order.</li>
</ul>
<hr />
<h4 id="get-the-currently-selected-treeview-item"><strong>Get the currently selected treeview item</strong></h4>
<pre><code class="language-python">@property
tree_selected() -&gt; str | None:
</code></pre>
<ul>
<li>Returns the item id of the currently selected box row. If nothing is selected returns <code>None</code>.</li>
</ul>
<hr />
<h4 id="delete-treeview-items"><strong>Delete treeview items</strong></h4>
<pre><code class="language-python">del_items(*items) -&gt; Sheet
</code></pre>
<ul>
<li><code>*items</code> the iids of items to delete.</li>
<li>Also deletes all item descendants.</li>
</ul>
<hr />
<h4 id="move-items-to-a-new-parent"><strong>Move items to a new parent</strong></h4>
<pre><code class="language-python">set_children(parent: str, *newchildren) -&gt; Sheet
</code></pre>
<ul>
<li><code>parent</code> the new parent for the items.</li>
<li><code>*newchildren</code> the items to move.</li>
</ul>
<hr />
<h4 id="move-an-item-to-a-new-parent"><strong>Move an item to a new parent</strong></h4>
<pre><code class="language-python">move(
    item: str,
    parent: str,
    index: int | None = None,
    select: bool = True,
    undo: bool = True,
    emit_event: bool = False,
) -&gt; tuple[dict[int, int], dict[int, int], EventDataDict]
</code></pre>
<p>Parameters:
- <code>item</code> is the iid to move.
- <code>parent</code> is the new parent for the item.
    - Use an empty <code>str</code> (<code>""</code>) to move the item to the top.
- <code>index</code>:
    - Leave as <code>None</code> to move to item to the end of the top/children.
    - Use an <code>int</code> to move the item to an index within its parents children (or within top level items if moving to the top).
- <code>select</code> when <code>True</code> selects the moved rows.
- <code>undo</code> when <code>True</code> adds the change to the undo stack.
- <code>emit_event</code> when <code>True</code> emits events related to sheet modification.</p>
<p>Notes:
- Also moves all of the items descendants.
- The <code>reattach()</code> function is exactly the same as <code>move()</code>.
- Returns <code>dict[int, int]</code> of <code>{old index: new index, ...}</code> for data and displayed rows separately and also an <code>EventDataDict</code>.</p>
<hr />
<h4 id="check-an-item-exists"><strong>Check an item exists</strong></h4>
<pre><code class="language-python">exists(item: str) -&gt; bool
</code></pre>
<ul>
<li><code>item</code> - a treeview iid.</li>
</ul>
<hr />
<h4 id="get-an-items-parent"><strong>Get an items parent</strong></h4>
<pre><code class="language-python">parent(item: str) -&gt; str
</code></pre>
<ul>
<li><code>item</code> - a treeview iid.</li>
</ul>
<hr />
<h4 id="get-an-items-index"><strong>Get an items index</strong></h4>
<pre><code class="language-python">index(item: str) -&gt; int
</code></pre>
<ul>
<li><code>item</code> - a treeview iid.</li>
</ul>
<hr />
<h4 id="check-if-an-item-is-currently-displayed"><strong>Check if an item is currently displayed</strong></h4>
<pre><code class="language-python">item_displayed(item: str) -&gt; bool
</code></pre>
<ul>
<li><code>item</code> - a treeview iid.</li>
</ul>
<hr />
<h4 id="display-an-item"><strong>Display an item</strong></h4>
<p>Make sure an items parents are all open, does <strong>not</strong> scroll to the item.</p>
<pre><code class="language-python">display_item(item: str, redraw: bool = False) -&gt; Sheet
</code></pre>
<ul>
<li><code>item</code> - a treeview iid.</li>
</ul>
<hr />
<h4 id="scroll-to-an-item"><strong>Scroll to an item</strong></h4>
<ul>
<li>Make sure an items parents are all open and scrolls to the item.</li>
</ul>
<pre><code class="language-python">scroll_to_item(item: str, redraw: bool = False) -&gt; Sheet
</code></pre>
<ul>
<li><code>item</code> - a treeview iid.</li>
</ul>
<hr />
<h4 id="get-currently-selected-items"><strong>Get currently selected items</strong></h4>
<pre><code class="language-python">selection(cells: bool = False) -&gt; list[str]
</code></pre>
<p>Notes:
- Returns a list of selected iids (selected rows but as iids).</p>
<p>Parameters:
- <code>cells</code> when <code>True</code> any selected cells will also qualify as selected items.</p>
<hr />
<h4 id="set-selected-items"><strong>Set selected items</strong></h4>
<pre><code class="language-python">selection_set(*items, run_binding: bool = True, redraw: bool = True) -&gt; Sheet
</code></pre>
<ul>
<li>Sets selected rows (items).</li>
</ul>
<hr />
<h4 id="add-selected-items"><strong>Add selected items</strong></h4>
<pre><code class="language-python">selection_add(*items, run_binding: bool = True, redraw: bool = True) -&gt; Sheet
</code></pre>
<hr />
<h4 id="remove-selections"><strong>Remove selections</strong></h4>
<pre><code class="language-python">selection_remove(*items, redraw: bool = True) -&gt; Sheet
</code></pre>
<hr />
<h4 id="toggle-selections"><strong>Toggle selections</strong></h4>
<pre><code class="language-python">selection_toggle(*items, redraw: bool = True) -&gt; Sheet
</code></pre>
<hr />
<h1 id="progress-bars"><strong>Progress Bars</strong></h1>
<p>Progress bars can be created for individual cells. They will only update when tkinter updates.</p>
<h4 id="create-a-progress-bar"><strong>Create a progress bar</strong></h4>
<pre><code class="language-python">create_progress_bar(
    row: int,
    column: int,
    bg: str,
    fg: str,
    name: Hashable,
    percent: int = 0,
    del_when_done: bool = False,
) -&gt; Sheet
</code></pre>
<ul>
<li><code>row</code> the row coordinate to create the bar at.</li>
<li><code>column</code> the column coordinate to create the bar at.</li>
<li><code>bg</code> the background color for the bar.</li>
<li><code>fg</code> the text color for the bar.</li>
<li><code>name</code> a name is required for easy referral to the bar later on.<ul>
<li>Names can be re-used for multiple bars.</li>
</ul>
</li>
<li><code>percent</code> the starting progress of the bar as an <code>int</code> either <code>0</code>, <code>100</code> or a number in between.</li>
<li><code>del_when_done</code> if <code>True</code> the <code>Sheet</code> will automatically delete the progress bar once it is modified with a percent of <code>100</code> or more.</li>
</ul>
<hr />
<h4 id="modify-progress-bars"><strong>Modify progress bars</strong></h4>
<pre><code class="language-python">progress_bar(
    name: Hashable | None = None,
    cell: tuple[int, int] | None = None,
    percent: int | None = None,
    bg: str | None = None,
    fg: str | None = None,
) -&gt; Sheet
</code></pre>
<p>Either <code>name</code> or <code>cell</code> can be used to refer to existing progress bars:
- <code>name</code> the name given to a progress bar, or multiple progress bars.
    - If this parameter is used then <code>cell</code> will not be used.
    - Will modify all progress bars with the given name.
- <code>cell</code> (<code>tuple[int, int]</code>) a tuple of two <code>int</code>s representing the progress bars location, <code>(row, column)</code>.
    - Can only refer to one progress bar.</p>
<p>Values that can be modified:
- <code>bg</code> the background color for the bar, leave as <code>None</code> for no change.
- <code>fg</code> the text color for the bar, leave as <code>None</code> for no change.
- <code>percent</code> the progress of the bar as an <code>int</code> either <code>0</code>, <code>100</code> or a number in between, leave as <code>None</code> for no change.</p>
<hr />
<h4 id="delete-progress-bars"><strong>Delete progress bars</strong></h4>
<p>Note that this will delete the progress bars data from the Sheet as well.</p>
<pre><code class="language-python">del_progress_bar(
    name: Hashable | None = None,
    cell: tuple[int, int] | None = None,
) -&gt; Sheet
</code></pre>
<p>Either <code>name</code> or <code>cell</code> can be used to refer to existing progress bars:
- <code>name</code> the name given to a progress bar, or multiple progress bars.
    - Will delete all progress bars with the given name.
    - If this parameter is used then <code>cell</code> will not be used.
- <code>cell</code> (<code>tuple[int, int]</code>) a tuple of two <code>int</code>s representing the progress bars location, <code>(row, column)</code>.
    - Can only refer to one progress bar.</p>
<hr />
<h1 id="tags"><strong>Tags</strong></h1>
<p>Tags can be used to keep track of specific cells, rows and columns wherever they move. Note that:
- If rows/columns are deleted the the associated tags will be also.
- There is no equivalent <code>tag_bind</code> functionality at this time.
- All tagging functions use data indexes (not displayed indexes) - this is only relevant when there are hidden rows/columns.</p>
<h4 id="tag-a-specific-cell"><strong>Tag a specific cell</strong></h4>
<pre><code class="language-python">tag_cell(
    cell: tuple[int, int],
    *tags,
) -&gt; Sheet
</code></pre>
<p>Example:</p>
<pre><code class="language-python">sheet.tag_cell((0, 0), &quot;tag a1&quot;, &quot;tag a1 no.2&quot;)
</code></pre>
<hr />
<h4 id="tag-specific-rows"><strong>Tag specific rows</strong></h4>
<pre><code class="language-python">tag_rows(
    rows: int | Iterator[int],
    *tags,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="tag-specific-columns"><strong>Tag specific columns</strong></h4>
<pre><code class="language-python">tag_columns(
    columns: int | Iterator[int],
    *tags,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="tag-using-a-span"><strong>Tag using a span</strong></h4>
<pre><code class="language-python">tag(
    *key: CreateSpanTypes,
    tags: Iterator[str] | str = &quot;&quot;,
) -&gt; Sheet
</code></pre>
<hr />
<h4 id="untag"><strong>Untag</strong></h4>
<pre><code class="language-python">untag(
    cell: tuple[int, int] | None = None,
    rows: int | Iterator[int] | None = None,
    columns: int | Iterator[int] | None = None,
) -&gt; Sheet
</code></pre>
<ul>
<li>This removes all tags from the cell, rows or columns provided.</li>
</ul>
<hr />
<h4 id="delete-tags"><strong>Delete tags</strong></h4>
<pre><code class="language-python">tag_del(
    *tags,
    cells: bool = True,
    rows: bool = True,
    columns: bool = True,
) -&gt; Sheet
</code></pre>
<ul>
<li>This deletes the provided tags from all <code>cells</code> if <code>True</code>, <code>rows</code> if <code>True</code> and <code>columns</code> if <code>True</code>.</li>
</ul>
<hr />
<h4 id="get-cells-rows-or-columns-associated-with-tags"><strong>Get cells, rows or columns associated with tags</strong></h4>
<pre><code class="language-python">tag_has(
    *tags,
) -&gt; DotDict
</code></pre>
<p>Notes:
- Returns all cells, rows and columns associated with <strong>any</strong> of the provided tags in the form of a <code>dict</code> with dot notation accessbility which has the following keys:
    - <code>"cells"</code> - with a value of <code>set[tuple[int, int]]</code> where the <code>tuple</code>s are cell coordinates - <code>(row, column)</code>.
    - <code>"rows"</code> - with a value of <code>set[int]</code> where the <code>int</code>s are rows.
    - <code>"columns"</code> - with a value of <code>set[int]</code> where the <code>int</code>s are columns.
- Returns data indexes.
- This function <strong>updates</strong> the <code>set</code>s with any cells/rows/columns associated with each tag, it does <strong>not</strong> return cells/rows/columns that have all the provided tags.</p>
<p>Example:</p>
<pre><code class="language-python">sheet.tag_rows((0, 1), &quot;row tag a&quot;, &quot;row tag b&quot;)
sheet.tag_rows(4, &quot;row tag b&quot;)
sheet.tag_rows(5, &quot;row tag c&quot;)
sheet.tag_rows(6, &quot;row tag d&quot;)
with_tags = sheet.tag_has(&quot;row tag b&quot;, &quot;row tag c&quot;)

print (with_tags.rows)
# prints {0, 1, 4, 5}
</code></pre>
<hr />
<h1 id="example-loading-data-from-excel"><strong>Example Loading Data from Excel</strong></h1>
<p>Using <code>pandas</code> library, requires additional libraries:
- <code>pandas</code>
- <code>openpyxl</code></p>
<pre><code class="language-python">from tksheet import Sheet
import tkinter as tk
import pandas as pd


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight = 1)
        self.grid_rowconfigure(0, weight = 1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight = 1)
        self.frame.grid_rowconfigure(0, weight = 1)
        self.sheet = Sheet(self.frame,
                           data = pd.read_excel(&quot;excel_file.xlsx&quot;,      # filepath here
                                                #sheet_name = &quot;sheet1&quot;, # optional sheet name here
                                                engine = &quot;openpyxl&quot;,
                                                header = None).values.tolist())
        self.sheet.enable_bindings()
        self.frame.grid(row = 0, column = 0, sticky = &quot;nswe&quot;)
        self.sheet.grid(row = 0, column = 0, sticky = &quot;nswe&quot;)


app = demo()
app.mainloop()
</code></pre>
<hr />
<h1 id="example-custom-right-click-and-text-editor-validation"><strong>Example Custom Right Click and Text Editor Validation</strong></h1>
<p>This is to demonstrate:
- Adding your own commands to the in-built right click popup menu (or how you might start making your own right click menu functionality)
- Validating text editor input; in this demonstration the validation removes spaces from user input.</p>
<pre><code class="language-python">from tksheet import Sheet
import tkinter as tk


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight=1)
        self.frame.grid_rowconfigure(0, weight=1)
        self.sheet = Sheet(self.frame,
                           data=[[f&quot;Row {r}, Column {c}\nnewline1\nnewline2&quot; for c in range(50)] for r in range(500)])
        self.sheet.enable_bindings(
            &quot;single_select&quot;,
            &quot;drag_select&quot;,
            &quot;edit_cell&quot;,
            &quot;paste&quot;,
            &quot;cut&quot;,
            &quot;copy&quot;,
            &quot;delete&quot;,
            &quot;select_all&quot;,
            &quot;column_select&quot;,
            &quot;row_select&quot;,
            &quot;column_width_resize&quot;,
            &quot;double_click_column_resize&quot;,
            &quot;arrowkeys&quot;,
            &quot;row_height_resize&quot;,
            &quot;double_click_row_resize&quot;,
            &quot;right_click_popup_menu&quot;,
            &quot;rc_select&quot;,
        )
        self.sheet.extra_bindings(&quot;begin_edit_cell&quot;, self.begin_edit_cell)
        self.sheet.edit_validation(self.validate_edits)
        self.sheet.popup_menu_add_command(&quot;Say Hello&quot;, self.new_right_click_button)
        self.frame.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.grid(row=0, column=0, sticky=&quot;nswe&quot;)

    def new_right_click_button(self, event=None):
        print (&quot;Hello World!&quot;)

    def begin_edit_cell(self, event=None):
        return event.value

    def validate_edits(self, event):
        # remove spaces from any cell edits, including paste
        if isinstance(event.value, str) and event.value:
            return event.value.replace(&quot; &quot;, &quot;&quot;)


app = demo()
app.mainloop()
</code></pre>
<ul>
<li>If you want a totally new right click menu you can use <code>self.sheet.bind("&lt;3&gt;", &lt;function&gt;)</code> with a <code>tk.Menu</code> of your own design (right click is <code>&lt;2&gt;</code> on MacOS) and don't use <code>"right_click_popup_menu"</code> with <code>enable_bindings()</code>.</li>
</ul>
<hr />
<h1 id="example-displaying-selections"><strong>Example Displaying Selections</strong></h1>
<pre><code class="language-python">from tksheet import (
    Sheet,
    num2alpha,
)
import tkinter as tk


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight = 1)
        self.grid_rowconfigure(0, weight = 1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight = 1)
        self.frame.grid_rowconfigure(0, weight = 1)
        self.sheet = Sheet(self.frame,
                           data = [[f&quot;Row {r}, Column {c}\nnewline1\nnewline2&quot; for c in range(50)] for r in range(500)])
        self.sheet.enable_bindings(&quot;all&quot;, &quot;ctrl_select&quot;)
        self.sheet.extra_bindings([(&quot;all_select_events&quot;, self.sheet_select_event)])
        self.show_selections = tk.Label(self)
        self.frame.grid(row = 0, column = 0, sticky = &quot;nswe&quot;)
        self.sheet.grid(row = 0, column = 0, sticky = &quot;nswe&quot;)
        self.show_selections.grid(row = 1, column = 0, sticky = &quot;nsw&quot;)

    def sheet_select_event(self, event = None):
        if event.eventname == &quot;select&quot; and event.selection_boxes and event.selected:
            # get the most recently selected box in case there are multiple
            box = next(reversed(event.selection_boxes))
            type_ = event.selection_boxes[box]
            if type_ == &quot;cells&quot;:
                self.show_selections.config(text=f&quot;{type_.capitalize()}: {box.from_r + 1},{box.from_c + 1} : {box.upto_r},{box.upto_c}&quot;)
            elif type_ == &quot;rows&quot;:
                self.show_selections.config(text=f&quot;{type_.capitalize()}: {box.from_r + 1} : {box.upto_r}&quot;)
            elif type_ == &quot;columns&quot;:
                self.show_selections.config(text=f&quot;{type_.capitalize()}: {num2alpha(box.from_c)} : {num2alpha(box.upto_c - 1)}&quot;)
        else:
            self.show_selections.config(text=&quot;&quot;)


app = demo()
app.mainloop()
</code></pre>
<hr />
<h1 id="example-list-box"><strong>Example List Box</strong></h1>
<p>This is to demonstrate some simple customization to make a different sort of widget (a list box).</p>
<pre><code class="language-python">from tksheet import Sheet
import tkinter as tk

class Sheet_Listbox(Sheet):
    def __init__(self,
                 parent,
                 values = []):
        Sheet.__init__(self,
                       parent = parent,
                       show_horizontal_grid = False,
                       show_vertical_grid = False,
                       show_header = False,
                       show_row_index = False,
                       show_top_left = False,
                       empty_horizontal = 0,
                       empty_vertical = 0)
        if values:
            self.values(values)

    def values(self, values = []):
        self.set_sheet_data([[v] for v in values],
                            reset_col_positions = False,
                            reset_row_positions = False,
                            redraw = False,
                            verify = False)
        self.set_all_cell_sizes_to_text()


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0,
                                  weight = 1)
        self.grid_rowconfigure(0,
                               weight = 1)
        self.listbox = Sheet_Listbox(self,
                                     values = [f&quot;_________  Item {i}  _________&quot; for i in range(2000)])
        self.listbox.grid(row = 0,
                          column = 0,
                          sticky = &quot;nswe&quot;)
        #self.listbox.values([f&quot;new values {i}&quot; for i in range(50)]) set values


app = demo()
app.mainloop()
</code></pre>
<hr />
<h1 id="example-header-dropdown-boxes-and-row-filtering"><strong>Example Header Dropdown Boxes and Row Filtering</strong></h1>
<p>A very simple demonstration of row filtering using header dropdown boxes.</p>
<pre><code class="language-python">from tksheet import (
    Sheet,
    num2alpha as n2a,
)
import tkinter as tk


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight=1)
        self.frame.grid_rowconfigure(0, weight=1)
        self.data = [
            [&quot;3&quot;, &quot;c&quot;, &quot;z&quot;],
            [&quot;1&quot;, &quot;a&quot;, &quot;x&quot;],
            [&quot;1&quot;, &quot;b&quot;, &quot;y&quot;],
            [&quot;2&quot;, &quot;b&quot;, &quot;y&quot;],
            [&quot;2&quot;, &quot;c&quot;, &quot;z&quot;],
        ]
        self.sheet = Sheet(
            self.frame,
            data=self.data,
            column_width=180,
            theme=&quot;dark&quot;,
            height=700,
            width=1100,
        )
        self.sheet.enable_bindings(
            &quot;copy&quot;,
            &quot;rc_select&quot;,
            &quot;arrowkeys&quot;,
            &quot;double_click_column_resize&quot;,
            &quot;column_width_resize&quot;,
            &quot;column_select&quot;,
            &quot;row_select&quot;,
            &quot;drag_select&quot;,
            &quot;single_select&quot;,
            &quot;select_all&quot;,
        )
        self.frame.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.grid(row=0, column=0, sticky=&quot;nswe&quot;)

        self.sheet.dropdown(
            self.sheet.span(n2a(0), header=True, table=False),
            values=[&quot;all&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;],
            set_value=&quot;all&quot;,
            selection_function=self.header_dropdown_selected,
            text=&quot;Header A Name&quot;,
        )
        self.sheet.dropdown(
            self.sheet.span(n2a(1), header=True, table=False),
            values=[&quot;all&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;],
            set_value=&quot;all&quot;,
            selection_function=self.header_dropdown_selected,
            text=&quot;Header B Name&quot;,
        )
        self.sheet.dropdown(
            self.sheet.span(n2a(2), header=True, table=False),
            values=[&quot;all&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;],
            set_value=&quot;all&quot;,
            selection_function=self.header_dropdown_selected,
            text=&quot;Header C Name&quot;,
        )

    def header_dropdown_selected(self, event=None):
        hdrs = self.sheet.headers()
        # this function is run before header cell data is set by dropdown selection
        # so we have to get the new value from the event
        hdrs[event.loc] = event.value
        if all(dd == &quot;all&quot; for dd in hdrs):
            self.sheet.display_rows(&quot;all&quot;)
        else:
            rows = [
                rn for rn, row in enumerate(self.data) if all(row[c] == e or e == &quot;all&quot; for c, e in enumerate(hdrs))
            ]
            self.sheet.display_rows(rows=rows, all_displayed=False)
        self.sheet.redraw()


app = demo()
app.mainloop()
</code></pre>
<hr />
<h1 id="example-readme-screenshot-code"><strong>Example Readme Screenshot Code</strong></h1>
<p>The code used to make a screenshot for the readme file.</p>
<pre><code class="language-python">from tksheet import (
    Sheet,
    num2alpha as n2a,
)
import tkinter as tk


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight=1)
        self.frame.grid_rowconfigure(0, weight=1)
        self.sheet = Sheet(
            self.frame,
            empty_horizontal=0,
            empty_vertical=0,
            paste_can_expand_x=True,
            paste_can_expand_y=True,
            align=&quot;w&quot;,
            header_align=&quot;c&quot;,
            data=[[f&quot;Row {r}, Column {c}\nnewline 1\nnewline 2&quot; for c in range(6)] for r in range(21)],
            headers=[
                &quot;Dropdown Column&quot;,
                &quot;Checkbox Column&quot;,
                &quot;Center Aligned Column&quot;,
                &quot;East Aligned Column&quot;,
                &quot;&quot;,
                &quot;&quot;,
            ],
            theme=&quot;dark&quot;,
            height=520,
            width=930,
        )
        self.sheet.enable_bindings(&quot;all&quot;, &quot;edit_index&quot;, &quot;edit_header&quot;)
        self.sheet.popup_menu_add_command(
            &quot;Hide Rows&quot;,
            self.hide_rows,
            table_menu=False,
            header_menu=False,
            empty_space_menu=False,
        )
        self.sheet.popup_menu_add_command(
            &quot;Show All Rows&quot;,
            self.show_rows,
            table_menu=False,
            header_menu=False,
            empty_space_menu=False,
        )
        self.sheet.popup_menu_add_command(
            &quot;Hide Columns&quot;,
            self.hide_columns,
            table_menu=False,
            index_menu=False,
            empty_space_menu=False,
        )
        self.sheet.popup_menu_add_command(
            &quot;Show All Columns&quot;,
            self.show_columns,
            table_menu=False,
            index_menu=False,
            empty_space_menu=False,
        )
        self.frame.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        colors = (
            &quot;#509f56&quot;,
            &quot;#64a85b&quot;,
            &quot;#78b160&quot;,
            &quot;#8cba66&quot;,
            &quot;#a0c36c&quot;,
            &quot;#b4cc71&quot;,
            &quot;#c8d576&quot;,
            &quot;#dcde7c&quot;,
            &quot;#f0e782&quot;,
            &quot;#ffec87&quot;,
            &quot;#ffe182&quot;,
            &quot;#ffdc7d&quot;,
            &quot;#ffd77b&quot;,
            &quot;#ffc873&quot;,
            &quot;#ffb469&quot;,
            &quot;#fea05f&quot;,
            &quot;#fc8c55&quot;,
            &quot;#fb784b&quot;,
            &quot;#fa6441&quot;,
            &quot;#f85037&quot;,
        )
        self.sheet.align_columns(columns=2, align=&quot;c&quot;)
        self.sheet.align_columns(columns=3, align=&quot;e&quot;)
        self.sheet.create_index_dropdown(r=0, values=[&quot;Dropdown&quot;] + [f&quot;{i}&quot; for i in range(15)])
        self.sheet.create_index_checkbox(r=3, checked=True, text=&quot;Checkbox&quot;)
        self.sheet.create_dropdown(r=&quot;all&quot;, c=0, values=[&quot;Dropdown&quot;] + [f&quot;{i}&quot; for i in range(15)])
        self.sheet.create_checkbox(r=&quot;all&quot;, c=1, checked=True, text=&quot;Checkbox&quot;)
        self.sheet.create_header_dropdown(c=0, values=[&quot;Header Dropdown&quot;] + [f&quot;{i}&quot; for i in range(15)])
        self.sheet.create_header_checkbox(c=1, checked=True, text=&quot;Header Checkbox&quot;)
        self.sheet.align_cells(5, 0, align=&quot;c&quot;)
        self.sheet.highlight_cells(5, 0, bg=&quot;gray50&quot;, fg=&quot;blue&quot;)
        self.sheet.highlight_cells(17, canvas=&quot;index&quot;, bg=&quot;yellow&quot;, fg=&quot;black&quot;)
        self.sheet.highlight_cells(12, 1, bg=&quot;gray90&quot;, fg=&quot;purple&quot;)
        for r in range(len(colors)):
            self.sheet.highlight_cells(row=r, column=3, fg=colors[r])
            self.sheet.highlight_cells(row=r, column=4, bg=colors[r], fg=&quot;black&quot;)
            self.sheet.highlight_cells(row=r, column=5, bg=colors[r], fg=&quot;purple&quot;)
        self.sheet.highlight_cells(column=5, canvas=&quot;header&quot;, bg=&quot;white&quot;, fg=&quot;purple&quot;)
        self.sheet.align(n2a(2), align=&quot;c&quot;)
        self.sheet.align(n2a(3), align=&quot;e&quot;)
        self.sheet.dropdown(
            self.sheet.span(&quot;A&quot;, header=True),
            values=[&quot;Dropdown&quot;] + [f&quot;{i}&quot; for i in range(15)],
        )
        self.sheet.checkbox(
            self.sheet.span(&quot;B&quot;, header=True),
            checked=True,
            text=&quot;Checkbox&quot;,
        )
        self.sheet.align(5, 0, align=&quot;c&quot;)
        self.sheet.highlight(5, 0, bg=&quot;gray50&quot;, fg=&quot;blue&quot;)
        self.sheet.highlight(
            self.sheet.span(17, index=True, table=False),
            bg=&quot;yellow&quot;,
            fg=&quot;black&quot;,
        )
        self.sheet.highlight(12, 1, bg=&quot;gray90&quot;, fg=&quot;purple&quot;)
        for r in range(len(colors)):
            self.sheet.highlight(r, 3, fg=colors[r])
            self.sheet.highlight(r, 4, bg=colors[r], fg=&quot;black&quot;)
            self.sheet.highlight(r, 5, bg=colors[r], fg=&quot;purple&quot;)
        self.sheet.highlight(
            self.sheet.span(n2a(5), header=True, table=False),
            bg=&quot;white&quot;,
            fg=&quot;purple&quot;,
        )
        self.sheet.set_all_column_widths()
        self.sheet.extra_bindings(&quot;all&quot;, self.all_extra_bindings)

    def hide_rows(self, event=None):
        rows = self.sheet.get_selected_rows()
        if rows:
            self.sheet.hide_rows(rows)

    def show_rows(self, event=None):
        self.sheet.display_rows(&quot;all&quot;, redraw=True)

    def hide_columns(self, event=None):
        columns = self.sheet.get_selected_columns()
        if columns:
            self.sheet.hide_columns(columns)

    def show_columns(self, event=None):
        self.sheet.display_columns(&quot;all&quot;, redraw=True)

    def all_extra_bindings(self, event=None):
        return event.value


app = demo()
app.mainloop()
</code></pre>
<hr />
<h1 id="example-saving-tksheet-as-a-csv-file"><strong>Example Saving tksheet as a csv File</strong></h1>
<p>To both load a csv file and save tksheet data as a csv file not including headers and index.</p>
<pre><code class="language-python">from tksheet import Sheet
import tkinter as tk
from tkinter import filedialog
import csv
from os.path import normpath
import io


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.withdraw()
        self.title(&quot;tksheet&quot;)
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight=1)
        self.frame.grid_rowconfigure(0, weight=1)
        self.sheet = Sheet(self.frame, data=[[f&quot;Row {r}, Column {c}&quot; for c in range(6)] for r in range(21)])
        self.sheet.enable_bindings(&quot;all&quot;, &quot;edit_header&quot;, &quot;edit_index&quot;)
        self.frame.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.popup_menu_add_command(&quot;Open csv&quot;, self.open_csv)
        self.sheet.popup_menu_add_command(&quot;Save sheet&quot;, self.save_sheet)
        self.sheet.set_all_cell_sizes_to_text()
        self.sheet.change_theme(&quot;light green&quot;)

        # create a span which encompasses the table, header and index
        # all data values, no displayed values
        self.sheet_span = self.sheet.span(
            header=True,
            index=True,
            hdisp=False,
            idisp=False,
        )

        # center the window and unhide
        self.update_idletasks()
        w = self.winfo_screenwidth() - 20
        h = self.winfo_screenheight() - 70
        size = (900, 500)
        self.geometry(&quot;%dx%d+%d+%d&quot; % (size + ((w / 2 - size[0] / 2), h / 2 - size[1] / 2)))
        self.deiconify()

    def save_sheet(self):
        filepath = filedialog.asksaveasfilename(
            parent=self,
            title=&quot;Save sheet as&quot;,
            filetypes=[(&quot;CSV File&quot;, &quot;.csv&quot;), (&quot;TSV File&quot;, &quot;.tsv&quot;)],
            defaultextension=&quot;.csv&quot;,
            confirmoverwrite=True,
        )
        if not filepath or not filepath.lower().endswith((&quot;.csv&quot;, &quot;.tsv&quot;)):
            return
        try:
            with open(normpath(filepath), &quot;w&quot;, newline=&quot;&quot;, encoding=&quot;utf-8&quot;) as fh:
                writer = csv.writer(
                    fh,
                    dialect=csv.excel if filepath.lower().endswith(&quot;.csv&quot;) else csv.excel_tab,
                    lineterminator=&quot;\n&quot;,
                )
                writer.writerows(self.sheet_span.data)
        except Exception as error:
            print(error)
            return

    def open_csv(self):
        filepath = filedialog.askopenfilename(parent=self, title=&quot;Select a csv file&quot;)
        if not filepath or not filepath.lower().endswith((&quot;.csv&quot;, &quot;.tsv&quot;)):
            return
        try:
            with open(normpath(filepath), &quot;r&quot;) as filehandle:
                filedata = filehandle.read()
            self.sheet.reset()
            self.sheet_span.data = [
                r
                for r in csv.reader(
                    io.StringIO(filedata),
                    dialect=csv.Sniffer().sniff(filedata),
                    skipinitialspace=False,
                )
            ]
        except Exception as error:
            print(error)
            return


app = demo()
app.mainloop()

</code></pre>
<hr />
<h1 id="example-using-and-creating-formatters"><strong>Example Using and Creating Formatters</strong></h1>
<pre><code class="language-python">from tksheet import (
    Sheet,
    formatter,
    float_formatter,
    int_formatter,
    percentage_formatter,
    bool_formatter,
    truthy,
    falsy,
    num2alpha,
)
import tkinter as tk
from datetime import datetime, date
from dateutil import parser, tz
from math import ceil
import re

date_replace = re.compile(&quot;|&quot;.join(re.escape(char) for char in &quot;()[]&lt;&gt;&quot;))


# Custom formatter methods
def round_up(x):
    try:  # might not be a number if empty
        return float(ceil(x))
    except Exception:
        return x


def only_numeric(s):
    return &quot;&quot;.join(n for n in f&quot;{s}&quot; if n.isnumeric() or n == &quot;.&quot;)


def convert_to_local_datetime(dt: str, **kwargs):
    if isinstance(dt, datetime):
        pass
    elif isinstance(dt, date):
        dt = datetime(dt.year, dt.month, dt.day)
    else:
        if isinstance(dt, str):
            dt = date_replace.sub(&quot;&quot;, dt)
        try:
            dt = parser.parse(dt)
        except Exception:
            raise ValueError(f&quot;Could not parse {dt} as a datetime&quot;)
    if dt.tzinfo is None:
        dt.replace(tzinfo=tz.tzlocal())
    dt = dt.astimezone(tz.tzlocal())
    return dt.replace(tzinfo=None)


def datetime_to_string(dt: datetime, **kwargs):
    return dt.strftime(&quot;%d %b, %Y, %H:%M:%S&quot;)


# Custom Formatter with additional kwargs


def custom_datetime_to_str(dt: datetime, **kwargs):
    return dt.strftime(kwargs[&quot;format&quot;])


class demo(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.grid_columnconfigure(0, weight=1)
        self.grid_rowconfigure(0, weight=1)
        self.frame = tk.Frame(self)
        self.frame.grid_columnconfigure(0, weight=1)
        self.frame.grid_rowconfigure(0, weight=1)
        self.sheet = Sheet(self.frame, empty_vertical=0, empty_horizontal=0, data=[[f&quot;{r}&quot;] * 11 for r in range(20)])
        self.sheet.enable_bindings()
        self.frame.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.grid(row=0, column=0, sticky=&quot;nswe&quot;)
        self.sheet.headers(
            [
                &quot;Non-Nullable Float Cell\n1 decimals places&quot;,
                &quot;Float Cell&quot;,
                &quot;Int Cell&quot;,
                &quot;Bool Cell&quot;,
                &quot;Percentage Cell\n0 decimal places&quot;,
                &quot;Custom Datetime Cell&quot;,
                &quot;Custom Datetime Cell\nCustom Format String&quot;,
                &quot;Float Cell that\nrounds up&quot;,
                &quot;Float cell that\n strips non-numeric&quot;,
                &quot;Dropdown Over Nullable\nPercentage Cell&quot;,
                &quot;Percentage Cell\n2 decimal places&quot;,
            ]
        )

        # num2alpha converts column integer to letter

        # Some examples of data formatting
        self.sheet[num2alpha(0)].format(float_formatter(nullable=False))
        self.sheet[num2alpha(1)].format(float_formatter())
        self.sheet[num2alpha(2)].format(int_formatter())
        self.sheet[num2alpha(3)].format(bool_formatter(truthy=truthy | {&quot;nah yeah&quot;}, falsy=falsy | {&quot;yeah nah&quot;}))
        self.sheet[num2alpha(4)].format(percentage_formatter())

        # Custom Formatters
        # Custom using generic formatter interface
        self.sheet[num2alpha(5)].format(
            formatter(
                datatypes=datetime,
                format_function=convert_to_local_datetime,
                to_str_function=datetime_to_string,
                nullable=False,
                invalid_value=&quot;NaT&quot;,
            )
        )

        # Custom format
        self.sheet[num2alpha(6)].format(
            datatypes=datetime,
            format_function=convert_to_local_datetime,
            to_str_function=custom_datetime_to_str,
            nullable=True,
            invalid_value=&quot;NaT&quot;,
            format=&quot;(%Y-%m-%d) %H:%M %p&quot;,
        )

        # Unique cell behaviour using the post_conversion_function
        self.sheet[num2alpha(7)].format(float_formatter(post_format_function=round_up))
        self.sheet[num2alpha(8)].format(float_formatter(), pre_format_function=only_numeric)
        self.sheet[num2alpha(9)].dropdown(values=[&quot;&quot;, &quot;104%&quot;, 0.24, &quot;300%&quot;, &quot;not a number&quot;], set_value=1,)
        self.sheet[num2alpha(9)].format(percentage_formatter(), decimals=0)
        self.sheet[num2alpha(10)].format(percentage_formatter(decimals=5))


app = demo()
app.mainloop()
</code></pre>
<hr />
<h1 id="contributing"><strong>Contributing</strong></h1>
<p>Welcome and thank you for your interest in <code>tksheet</code>!</p>
<h3 id="tksheet-goals"><strong>tksheet Goals</strong></h3>
<ul>
<li>
<p><strong>Adaptable rather than comprehensive</strong>: Prioritizes adaptability over comprehensiveness, providing essential features that can be easily extended or customized based on specific needs. This approach allows for flexibility in integrating tksheet into different projects and workflows.</p>
</li>
<li>
<p><strong>Lightweight and performant</strong>: Aims to provide a lightweight solution for creating spreadsheet-like functionality in tkinter applications, without additional dependencies and with a focus on efficiency and performance.</p>
</li>
</ul>
<h3 id="dependencies"><strong>Dependencies</strong></h3>
<p>tksheet is designed to only use built-in Python libraries (without third-party dependencies). Please ensure that your contributions do not introduce any new dependencies outside of Python's built-in libraries.</p>
<h3 id="license"><strong>License</strong></h3>
<p>tksheet is released under the MIT License. You can find the full text of the license <a href="https://github.com/ragardner/tksheet/blob/master/LICENSE.txt">here</a>.</p>
<p>By contributing to the tksheet project, you agree to license your contributions under the same MIT License. Please make sure to read and understand the terms and conditions of the license before contributing.</p>
<h3 id="contributing-code"><strong>Contributing Code</strong></h3>
<p>To contribute, please follow these steps:</p>
<ol>
<li>Fork the tksheet repository.</li>
<li>If you are working on a new feature, create a new branch for your contribution. Use a descriptive name for the branch that reflects the feature you're working on.</li>
<li>Make your changes in your local branch, following the code style and conventions established in the project.</li>
<li>Test your changes thoroughly to ensure they do not introduce any new bugs or issues.</li>
<li>Submit a pull request to the <code>main</code> branch of the tksheet repository, including a clear title and detailed description of your changes. Pull requests ideally should include a small but comprehensive demonstration of the feature you are adding.</li>
<li>Don't forget to update the documentation!</li>
</ol>
<p><strong><em>Note:</em></strong> If you're submitting a bugfix, it's generally preferred to submit it directly to the relevant branch, rather than creating a separate branch.</p>
<h3 id="asking-questions"><strong>Asking Questions</strong></h3>
<p>Got a question that hasn't been answered in the closed issues or is missing from the documentation? please follow these guidelines:</p>
<ul>
<li>Submit your question as an issue in the <a href="https://github.com/ragardner/tksheet/issues">Issues tab</a>.</li>
<li>Provide a clear and concise description of your question, including any relevant details or examples that can help us understand your query better.</li>
</ul>
<h3 id="issues"><strong>Issues</strong></h3>
<p>Please use the <a href="https://github.com/ragardner/tksheet/issues">Issues tab</a> to report any issues or ask for assistance.</p>
<p>When submitting an issue, please follow these guidelines:</p>
<ul>
<li>Check the existing issues to see if a similar bug or question has already been reported or discussed.</li>
<li>If reporting a bug, provide a minimal example that can reproduce the issue, including any relevant code, error messages, and steps to reproduce.</li>
<li>If asking a question or seeking help, provide a clear and concise description of your question or issue, including any relevant details or examples that can help people understand your query better.</li>
<li>Include any relevant screenshots or gifs that can visually illustrate the issue or your question.</li>
</ul>
<h3 id="enhancements-or-suggestions"><strong>Enhancements or Suggestions</strong></h3>
<p>If you have an idea for a new feature, improvement or change, please follow these guidelines:</p>
<ul>
<li>Submit your suggestion as an issue in the <a href="https://github.com/ragardner/tksheet/issues">Issues tab</a>.</li>
<li>Include a clear and concise description of your idea, including any relevant details, screenshots, or mock-ups that can help contributors understand your suggestion better.</li>
<li>You're also welcome to become a contributor yourself and help implement your idea!</li>
</ul>
<h3 id="contributors-and-special-thanks"><strong>Contributors and Special Thanks</strong></h3>
<p>A special thank you to:
- @CalJaDav for the very helpful ideas/pull requests, guidance in implementing them and helping me become a better developer.
- @demberto for providing pull requests and guidance to modernize and improve the project.
- All <a href="https://github.com/ragardner/tksheet/graphs/contributors">contributors</a>.
- Everyone who has reported an issue and helped me fix it.</p></div>
    </div>
</body>
</html>
